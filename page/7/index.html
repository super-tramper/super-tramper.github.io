<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>IMTE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="IMTE">
<meta property="og:url" content="http://example.com/page/7/index.html">
<meta property="og:site_name" content="IMTE">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="IMTE">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="IMTE" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">IMTE</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Docker部署Django+uwsgi+MongoDB+Nginx" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/29/Docker%E9%83%A8%E7%BD%B2Django+uwsgi+MongoDB+Nginx/" class="article-date">
  <time datetime="2020-03-29T12:50:16.000Z" itemprop="datePublished">2020-03-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/29/Docker%E9%83%A8%E7%BD%B2Django+uwsgi+MongoDB+Nginx/">django项目docker整体部署</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>项目由Django+uwsgi、MongoDB、Nginx三部分组成，现需将其部署到Docker中。</p>
<ul>
<li><p>django 一个pyhton的开源web框架。</p>
</li>
<li><p>uWSGI 一个基于自有的uwsgi协议、WSGI协议和http服务协议的web网关</p>
</li>
<li><p>nginx 常用的代理服务器</p>
<blockquote>
<p>WSGI：一种实现python解析的通用接口标准/协议，是一种通用的接口标准或者接口协议，实现了python web程序与服务器之间交互的通用性。 </p>
<p>利用它，web.py或bottle或者django等等的python web开发框架，就可以轻松地部署在不同的web server上了；</p>
<p><strong>uwsgi</strong>:同WSGI一样是一种通信协议<br>uwsgi协议是一个uWSGI服务器自有的协议，它用于定义传输信息的类型，它与WSGI相比是两样东西。</p>
<p><strong>uWSGI</strong> :一种python web server或称为Server/Gateway<br>uWSGI类似tornadoweb或者flup，是一种python web server，uWSGI是实现了uwsgi和WSGI两种协议的Web服务器，负责响应python 的web请求。<br>因为apache、nginx等，它们自己都没有解析动态语言如php的功能，而是分派给其他模块来做，比如apache就可以说内置了php模块，让人感觉好像apache就支持php一样。<br>uWSGI实现了wsgi协议、uwsgi协议、http等协议。 Nginx中HttpUwsgiModule的作用是与uWSGI服务器进行交换。</p>
</blockquote>
</li>
</ul>
<h3 id="项目流程"><a href="#项目流程" class="headerlink" title="项目流程"></a>项目流程</h3><blockquote>
<p>首先客户端请求服务资源，<br>nginx作为直接对外的服务接口,接收到客户端发送过来的http请求,会解包、分析，<br>如果是静态文件请求就根据nginx配置的静态文件目录，返回请求的资源，<br>如果是动态的请求,nginx就通过配置文件,将请求传递给uWSGI；uWSGI 将接收到的包进行处理，并转发给wsgi，<br>wsgi根据请求调用django工程的某个文件或函数，处理完后django将返回值交给wsgi，<br>wsgi将返回值进行打包，转发给uWSGI，<br>uWSGI接收后转发给nginx,nginx最终将返回值返回给客户端(如浏览器)。<br>*注:不同的组件之间传递信息涉及到数据格式和协议的转换</p>
</blockquote>
<p> <strong>作用:</strong> </p>
<ol>
<li>第一级的nginx并不是必须的，uwsgi完全可以完成整个的和浏览器交互的流程； </li>
<li>在nginx上加上安全性或其他的限制，可以达到保护程序的作用； </li>
<li>uWSGI本身是内网接口，开启多个work和processes可能也不够用，而nginx可以代理多台uWSGI完成uWSGI的负载均衡； </li>
<li>django在debug=False下对静态文件的处理能力不是很好，而用nginx来处理更加高效。</li>
</ol>
<h3 id="项目各部分独立测试"><a href="#项目各部分独立测试" class="headerlink" title="项目各部分独立测试"></a>项目各部分独立测试</h3><p>为避免部署中出现问题，找不到问题在哪个部分，需掌握各部分的运行状况</p>
<h5 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h5><p>在项目目录下执行<code>python manage.py runserver</code>若项目可顺利运行且可通过浏览器访问，则无问题。</p>
<h5 id="uWSGI"><a href="#uWSGI" class="headerlink" title="uWSGI"></a>uWSGI</h5><p>通常通过<code>pip install uwsgi</code>命令来安装，如果希望从源码安装进行模块化构建，可参考<a target="_blank" rel="noopener" href="https://uwsgi-docs-zh.readthedocs.io/zh_CN/latest/Install.html">uwsgi安装文档</a>。</p>
<p>安装完成后新建文件<code>test.py</code>，写入以下内容：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">application</span>(<span class="params">env, start_response</span>):</span></span><br><span class="line">    start_response(<span class="string">&#x27;200 OK&#x27;</span>, [(<span class="string">&#x27;Content-Type&#x27;</span>,<span class="string">&#x27;text/html&#x27;</span>)])</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Hello World&quot;</span></span><br></pre></td></tr></table></figure>

<p>执行<code>uwsgi --http 0.0.0.0:8000 --wsgi-file test.py --processes 4 --threads 3</code></p>
<p>然后<code>ps aux | grep uwsgi</code>或者<code>lsof -i:8000</code>查看进程运行情况，然后浏览器访问<code>ip:8000</code>查看返回结果。</p>
<h5 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h5><p><code>apt-get install nginx</code>安装好Nginx后启动，浏览器访问80端口，检测Nginx是否安装正常。</p>
<p>在终端运行<code>nginx -t</code>可检测配置文件的有效性。</p>
<h3 id="Django-uWSGI"><a href="#Django-uWSGI" class="headerlink" title="Django+uWSGI"></a>Django+uWSGI</h3><p>运行Django项目时，需要对uwsgi配置众多参数，通常在运行uwsgi时指定<code>ini</code>配置文件。</p>
<p>uwsgi.ini配置文件如下所示：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[uwsgi]</span></span><br><span class="line"><span class="comment"># 專案目錄</span></span><br><span class="line"><span class="attr">chdir</span>=/app/django-api</span><br><span class="line"><span class="comment"># 指定專案的application</span></span><br><span class="line"><span class="attr">module</span>=drfx.wsgi</span><br><span class="line"><span class="comment"># 指定sock的檔案路徑</span></span><br><span class="line"><span class="attr">socket</span>=/root/uwsgi.sock</span><br><span class="line"><span class="comment"># 程序個數</span></span><br><span class="line"><span class="attr">workers</span>=<span class="number">5</span></span><br><span class="line"><span class="attr">pidfile</span>=/root/uwsgi.pid</span><br><span class="line"><span class="comment"># 指定IP埠，根據情況選擇http or socket，一般選擇socket</span></span><br><span class="line"><span class="comment"># http为直接作为服务器时使用（通常在部署完这部分测试时使用），socket为通过Nginx代理时使用</span></span><br><span class="line"> <span class="attr">http</span>=<span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8889</span> </span><br><span class="line"><span class="comment">#socket      = 0.0.0.0:8889</span></span><br><span class="line"><span class="comment"># 指定靜態檔案(actually not exist)</span></span><br><span class="line"><span class="attr">static-map</span>=/static=/app/django-api/static</span><br><span class="line"><span class="comment"># 啟用主程序</span></span><br><span class="line"><span class="attr">master</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 自動移除unix Socket和pid檔案當服務停止的時候</span></span><br><span class="line"><span class="attr">vacuum</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 序列化接受的內容，如果可能的話</span></span><br><span class="line"><span class="attr">thunder-lock</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 啟用執行緒</span></span><br><span class="line"><span class="attr">enable-threads</span>=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 設定自中斷時間</span></span><br><span class="line"><span class="comment"># 若出现worker 2 (pid: 8) died, killed by signal 9 :( trying respawn .，则增大该值</span></span><br><span class="line"><span class="attr">harakiri</span>=<span class="number">30</span></span><br><span class="line"><span class="comment"># 設定緩衝</span></span><br><span class="line"><span class="attr">post-buffering</span>=<span class="number">4096</span></span><br><span class="line"><span class="comment"># 設定日誌目錄，运行日志将输出到配置的文件中</span></span><br><span class="line"><span class="comment"># 注意，若希望uwsgi在前台运行，则不用此设置</span></span><br><span class="line"><span class="attr">daemonize</span>=/root/uwsgi.log</span><br></pre></td></tr></table></figure>

<p>Django+uwsgi的Dockerfile如下所示：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> python:<span class="number">3.7</span>-alpine</span><br><span class="line"><span class="keyword">ENV</span> PYTHONUNBUFFERED <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mkdir /app &amp;&amp; apk --update add gcc libc-dev jpeg-dev zlib-dev git libxml2 libxml2-dev libxslt libxslt-dev linux-headers</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> . /app</span></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="bash"> /app/django-api/</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mkdir -p /app/django-api/<span class="built_in">log</span> &amp;&amp; pip install -r requirements.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> ./docker-entrypoint.sh /docker-entrypoint.sh</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> chmod +x /docker-entrypoint.sh</span></span><br><span class="line"><span class="comment"># EXPOSE 8888</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#此命令为docker单独运行Django项目时使用</span></span><br><span class="line"><span class="comment">#CMD python manage.py runserver 0.0.0.0:8888 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> uwsgi --ini /app/django-api/uwsgi.ini</span></span><br></pre></td></tr></table></figure>

<p>此时<code>docker-compose.yml</code>内容如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span>  <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./django-api/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">dapi-dev:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">dapi-dev</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/log/debug.log:/app/log/debug.log</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/uwsgi.ini:/app/django-api/uwsgi.ini</span></span><br><span class="line">     <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8889:8889&quot;</span></span><br></pre></td></tr></table></figure>

<p>执行<code>docker-compose up</code>命令后构建Django容器，容器运行后可通过8889访问容器是否正常运行。</p>
<h3 id="Nginx-1"><a href="#Nginx-1" class="headerlink" title="Nginx"></a>Nginx</h3><p>直接从官方镜像构建容器，仅从宿主机映射配置文件，容器的配置文件放在项目的同级目录<code>.docker</code>下,修改<code>docker-compose.yml</code>内容如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span>  <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./django-api/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">dapi-dev:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">dapi-dev</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/log/debug.log:/app/log/debug.log</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/uwsgi.ini:/app/django-api/uwsgi.ini</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nginx_network</span></span><br><span class="line"></span><br><span class="line"><span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.14.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./.docker/nginx/nginx.conf:/etc/nginx/nginx.conf:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./.docker/nginx/conf.d/:/etc/nginx/conf.d/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/log/nginx/:/var/log/nginx/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/static/:/app/static/</span>  <span class="comment"># 注意此处静态文件路径配置</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nginx_network</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">web</span></span><br><span class="line">      </span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">nginx_network:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure>

<p>修改<code>uwsgi.ini</code>的内容：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http=0.0.0.0:8889 </span></span><br><span class="line"><span class="attr">socket</span>      = <span class="number">0.0</span>.<span class="number">0.0</span>:<span class="number">8889</span></span><br></pre></td></tr></table></figure>

<p><code>docker-compose up</code>重启项目</p>
<p>.docker/nginx/nginx.conf<code>的内容保持不变，</code>.docker/nginx/conf.d/nginx.conf`的内容如下：</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义django api</span></span><br><span class="line"><span class="attribute">upstream</span> djapi &#123;</span><br><span class="line">    <span class="attribute">server</span> web:<span class="number">8889</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">	<span class="attribute">listen</span> <span class="number">80</span> default_server;</span><br><span class="line">	<span class="attribute">listen</span> [::]:<span class="number">80</span> default_server;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">location</span> /static &#123;</span><br><span class="line">		<span class="attribute">alias</span> /app/static;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="attribute">location</span> / &#123;</span><br><span class="line">		<span class="attribute">include</span> /etc/nginx/uwsgi_params;</span><br><span class="line">		<span class="attribute">uwsgi_pass</span> djapi;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>docker-compose up</code>构建容器，执行命令<code>docker container exec -it nginx /bin/bash</code>进入容器shell，执行<code>nginx -t</code>测试配置文件。</p>
<h3 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h3><p>MongoDB依然从官方镜像构建，配置文件放在<code>.docker/mongodb/</code>目录下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># mongodb.conf</span><br><span class="line">dbpath&#x3D;&#x2F;var&#x2F;lib&#x2F;mongodb</span><br><span class="line">logpath&#x3D;&#x2F;var&#x2F;log&#x2F;mongodb&#x2F;mongodb.log</span><br><span class="line">logappend&#x3D;true</span><br><span class="line">bind_ip &#x3D; 0.0.0.0</span><br><span class="line">noauth &#x3D; true</span><br></pre></td></tr></table></figure>

<p>此处将MongoDB的<code>noauth</code>选项设置为<code>true</code>，待容器启动后再添加授权用户</p>
<p><code>docker-compose.yml</code>内容改为如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span>  <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">./django-api/Dockerfile</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nic19801207/dapi-dev:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">dapi-dev</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/log/debug.log:/app/log/debug.log</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/uwsgi8889.ini:/app/django-api/uwsgi8889.ini</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ENV=develop</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mongo_network</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nginx_network</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mongodb</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">mongodb:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mongo:3.6.3</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/etc/mongodb.conf:/etc/mongod.conf.orig:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/lib/mongodb/:/var/lib/mongodb</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/log/mongodb/:/var/log/mongodb</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./hinh/:/app/hinh</span>  <span class="comment"># 用于导入数据或定期备份数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#    command: [--auth]</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mongo_network</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.14.0</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./.docker/nginx/nginx.conf:/etc/nginx/nginx.conf:ro</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./.docker/nginx/conf.d/:/etc/nginx/conf.d/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/var/log/nginx/:/var/log/nginx/</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./django-api/static/:/app/static/</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">nginx_network</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">web</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">nginx_network:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br><span class="line">  <span class="attr">mongo_network:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure>

<p>将Django项目的settings.py中的数据库连接信息改为如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;djongo&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;data&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;HOST&#x27;</span>: <span class="string">&#x27;mongodb&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;PORT&#x27;</span>: <span class="number">27017</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时我导入了项目中原有数据，<code>docker-compose up</code>启动项目，进行测试。</p>
<p>此时整个项目已经可以顺利运行，如果希望给MongoDB加上权限验证，则继续进行剩下的操作。</p>
<h4 id="创建用户"><a href="#创建用户" class="headerlink" title="创建用户"></a>创建用户</h4><p>此时MongoDB无需验证，<code>docker container exec -it proj_mongodb_1 /bin/bash</code>进入容器内部（若开启了端口则可在容器外部进入mongo shell），<code>mongo</code>进入MongoDB shell，创建<code>root</code>用户和项目数据库用户。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">use admin</span><br><span class="line">db.createUser(</span><br><span class="line">    &#123;</span><br><span class="line">        user: &quot;root&quot;, </span><br><span class="line">        pwd: &quot;root&quot;, </span><br><span class="line">        roles:[&quot;root&quot;]</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">use data</span><br><span class="line">db.createUser(</span><br><span class="line">    &#123;</span><br><span class="line">        user: &quot;data_app&quot;,</span><br><span class="line">        pwd: &quot;data_app123456&quot;,</span><br><span class="line">        roles:[</span><br><span class="line">            &#123;</span><br><span class="line">                role: &quot;readWrite&quot;,</span><br><span class="line">                db: &quot;data&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h4 id="以验证方式运行MongoDB"><a href="#以验证方式运行MongoDB" class="headerlink" title="以验证方式运行MongoDB"></a>以验证方式运行MongoDB</h4><p>修改<code>docker-compose.yml</code>文件如下(添加<code>--auth</code>启动项)：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mongodb:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">mongo:3.6.3</span></span><br><span class="line">  <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/etc/mongodb.conf:/etc/mongod.conf.orig:ro</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/lib/mongodb/:/var/lib/mongodb</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">/var/log/mongodb/:/var/log/mongodb</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">./hinh/:/app/hinh</span>  <span class="comment"># 用于导入数据或定期备份数据</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">command:</span> [<span class="string">--auth</span>]</span><br><span class="line">  <span class="attr">networks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">mongo_network</span></span><br></pre></td></tr></table></figure>

<h4 id="修改Django数据库设置"><a href="#修改Django数据库设置" class="headerlink" title="修改Django数据库设置"></a>修改Django数据库设置</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">        <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">            <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;djongo&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&#x27;data&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;HOST&#x27;</span>: <span class="string">&#x27;mongodb&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;PORT&#x27;</span>: <span class="number">27017</span>,</span><br><span class="line">            <span class="string">&#x27;USER&#x27;</span>: <span class="string">&#x27;data_app&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;PASSWORD&#x27;</span>: <span class="string">&#x27;data_app123456&#x27;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="—"><a href="#—" class="headerlink" title="—"></a>—</h3><p>疫情期间在家窝着，从docker文档，到熟悉uwsgi+Django+Nginx部署，到docker化部署，一路花了不少时间，期间犯过很多错误，有低级的有理解错误的。不断地部署，不断地遇到问题，然后一个个地解决，加深理解。最终我一路扛过来，但是我忘了把错误和解决过程记下来，主线倒是记得。期间重点参考了一些博客，以下是这些内容的链接。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://uwsgi-docs-zh.readthedocs.io/zh_CN/latest/tutorials/Django_and_nginx.html">使用uWSGI和nginx来设置Django和你的web服务器</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/c465869935/article/details/53242126">uWSGI+django+nginx的工作原理流程与部署历程</a></li>
<li><a target="_blank" rel="noopener" href="http://pawamoy.github.io/2018/02/01/docker-compose-django-postgres-nginx.html">Docker Compose with NginX, Django, Gunicorn and multiple Postgres databases</a></li>
<li><a target="_blank" rel="noopener" href="https://medium.com/rahasak/enable-mongodb-authentication-with-docker-1b9f7d405a94">Enable mongodb authentication with docker</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/03/29/Docker%E9%83%A8%E7%BD%B2Django+uwsgi+MongoDB+Nginx/" data-id="ckja57ee30002fq137drecwfl" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-docker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/03/19/docker/" class="article-date">
  <time datetime="2020-03-19T08:55:14.000Z" itemprop="datePublished">2020-03-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/03/19/docker/">docker</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Docker学习笔记"><a href="#Docker学习笔记" class="headerlink" title="Docker学习笔记"></a>Docker学习笔记</h2><p>[TOC]</p>
<h3 id="docker与虚拟机的区别"><a href="#docker与虚拟机的区别" class="headerlink" title="docker与虚拟机的区别"></a>docker与虚拟机的区别</h3><p><code>https://www.zhihu.com/question/48174633</code></p>
<p><strong>Docker守护进程</strong>可以直接与<strong>主操作系统</strong>进行通信，为各个<strong>Docker容器</strong>分配资源；它还可以将容器与<strong>主操作系统</strong>隔离，并将各个容器互相隔离。<strong>虚拟机</strong>启动需要数分钟，而<strong>Docker容器</strong>可以在数毫秒内启动。由于没有臃肿的<strong>从操作系统</strong>，Docker可以节省大量的磁盘空间以及其他系统资源。</p>
<p>直观上来讲VM多了一层guest OS，同时Hypervisor会对硬件资源进行虚拟化，docker直接使用硬件资源。云服务提供商通常采用虚拟机技术隔离不同的用户。而<strong>Docker</strong>通常用于隔离不同的应用，例如<strong>前端</strong>，<strong>后端</strong>以及<strong>数据库</strong>。</p>
<h3 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h3><p><code>使用commit制作镜像就如同使用RDB持久化Redis，使用Dockerfile定制镜像类似于AOF持久化Redis；</code></p>
<p>Dockerfile的思想，类似于安装包，将各种依赖按照一定顺序安装并设置参数的操作集成到一个或多个关联的脚本中，做到一键安装的效果，最大限度减少工作量。</p>
<p>通过FROM指定基础镜像，RUN指令执行命令行命令</p>
<p>Dockerfile 中每一个指令都会建立一层，一个 <code>Dockerfile</code> 中 <code>FROM</code> 是必备的指令，并且必须是第一条指令。每一个 <code>RUN</code> 的行为都新建立一层，在其上执行这些命令，执行结束后，<code>commit</code> 这一层的修改，构成新的镜像</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*exec* 格式：`RUN [&quot;可执行文件&quot;, &quot;参数1&quot;, &quot;参数2&quot;]</span><br><span class="line">eg: RUN echo &#x27;&lt;h1&gt;Hello, Docker!&lt;/h1&gt;&#x27; &gt; /usr/share/nginx/html/index.html</span><br></pre></td></tr></table></figure>

<p>故以下的做法会导致镜像臃肿，层数过多</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> debian:stretch</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get install -y gcc libc6-dev make wget</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> wget -O redis.tar.gz <span class="string">&quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot;</span></span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> mkdir -p /usr/src/redis</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> make -C /usr/src/redis</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> make -C /usr/src/redis install</span></span><br></pre></td></tr></table></figure>

<p>应改成如下形式</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> debian:stretch</span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> buildDeps=<span class="string">&#x27;gcc libc6-dev make wget&#x27;</span> \</span></span><br><span class="line"><span class="bash">    &amp;&amp; apt-get update \</span></span><br><span class="line"><span class="bash">    &amp;&amp; apt-get install -y <span class="variable">$buildDeps</span> \</span></span><br><span class="line"><span class="bash">    &amp;&amp; wget -O redis.tar.gz <span class="string">&quot;http://download.redis.io/releases/redis-5.0.3.tar.gz&quot;</span> \</span></span><br><span class="line"><span class="bash">    &amp;&amp; mkdir -p /usr/src/redis \</span></span><br><span class="line"><span class="bash">    &amp;&amp; tar -xzf redis.tar.gz -C /usr/src/redis --strip-components=1 \</span></span><br><span class="line"><span class="bash">    &amp;&amp; make -C /usr/src/redis \</span></span><br><span class="line"><span class="bash">    &amp;&amp; make -C /usr/src/redis install \</span></span><br><span class="line"><span class="bash">    &amp;&amp; rm -rf /var/lib/apt/lists/* \</span></span><br><span class="line"><span class="bash">    &amp;&amp; rm redis.tar.gz \</span></span><br><span class="line"><span class="bash">    &amp;&amp; rm -r /usr/src/redis \</span></span><br><span class="line"><span class="bash">    &amp;&amp; apt-get purge -y --auto-remove <span class="variable">$buildDeps</span></span></span><br></pre></td></tr></table></figure>

<h3 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker build [选项] &lt;上下文路径/URL/-&gt;</span><br><span class="line">docker build -t nginx:v3 .</span><br><span class="line">docker build -t nginx:v3 /root/mynginx/</span><br><span class="line">docker build https://github.com/twang2218/gitlab-ce-zh.git<span class="comment">#:11.1</span></span><br><span class="line">docker build http://server/context.tar.gz</span><br><span class="line">docker build - &lt; Dockerfile</span><br><span class="line">cat Dockerfile | docker build -</span><br><span class="line">docker build - &lt; context.tar.gz</span><br></pre></td></tr></table></figure>

<p>上下文路径详解见  <strong>镜像构建上下文</strong></p>
<h3 id="镜像构建上下文"><a href="#镜像构建上下文" class="headerlink" title="镜像构建上下文"></a>镜像构建上下文</h3><p><code>docker build</code>工作原理：Docker 在运行时分为 Docker 引擎（也就是服务端守护进程）和客户端工具。Docker 的引擎提供了一组 REST API，被称为 <a target="_blank" rel="noopener" href="https://docs.docker.com/develop/sdk/">Docker Remote API</a>，而如 <code>docker</code> 命令这样的客户端工具，则是通过这组 API 与 Docker 引擎交互，从而完成各种功能。因此，虽然表面上我们好像是在本机执行各种 <code>docker</code> 功能，但实际上，一切都是使用的远程调用形式在服务端（Docker 引擎）完成。</p>
<p>当构建的时候，用户会指定构建镜像上下文的路径，<code>docker build</code> 命令得知这个路径后，会将路径下的所有内容打包，然后上传给 Docker 引擎。这样 Docker 引擎收到这个上下文包后，展开就会获得构建镜像所需的一切文件。</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="bash"> ./package.json /app/</span></span><br></pre></td></tr></table></figure>

<p>这并不是要复制执行 <code>docker build</code> 命令所在的目录下的 <code>package.json</code>，也不是复制 <code>Dockerfile</code> 所在目录下的 <code>package.json</code>，而是复制 <strong>上下文（context）</strong> 目录下的 <code>package.json</code>。</p>
<h3 id="Dockerfile指令"><a href="#Dockerfile指令" class="headerlink" title="Dockerfile指令"></a>Dockerfile指令</h3><h4 id="COPY-复制文件"><a href="#COPY-复制文件" class="headerlink" title="COPY 复制文件"></a>COPY 复制文件</h4><p>格式：</p>
<ul>
<li><code>COPY [--chown=:] &lt;源路径&gt;... &lt;目标路径&gt;</code></li>
<li><code>COPY [--chown=:] [&quot;&lt;源路径1&gt;&quot;,... &quot;&lt;目标路径&gt;&quot;]</code></li>
</ul>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="bash"> package.json /usr/src/app/</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;源路径&gt;</code> 可以是多个，甚至可以是通配符，其通配符规则要满足 Go 的 <a target="_blank" rel="noopener" href="https://golang.org/pkg/path/filepath/#Match"><code>filepath.Match</code></a> 规则</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="bash"> hom* /mydir/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> hom?.txt /mydir/</span></span><br></pre></td></tr></table></figure>

<p><code>&lt;目标路径&gt;</code> 可以是容器内的绝对路径，也可以是相对于工作目录的相对路径（工作目录可以用 <code>WORKDIR</code> 指令来指定）。目标路径不需要事先创建，如果目录不存在会在复制文件前先行创建缺失目录。</p>
<p>使用 <code>COPY</code> 指令，源文件的各种元数据都会保留。比如读、写、执行权限、文件变更时间等。这个特性对于镜像定制很有用。特别是构建相关文件都在使用 Git 进行管理的时候。</p>
<p>在使用该指令的时候还可以加上 <code>--chown=:</code> 选项来改变文件的所属用户及所属组。</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COPY</span><span class="bash"> --chown=55:mygroup files* /mydir/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> --chown=bin files* /mydir/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> --chown=1 files* /mydir/</span></span><br><span class="line"><span class="keyword">COPY</span><span class="bash"> --chown=10:11 files* /mydir/</span></span><br></pre></td></tr></table></figure>

<h4 id="ADD-更高级的复制文件"><a href="#ADD-更高级的复制文件" class="headerlink" title="ADD 更高级的复制文件"></a>ADD 更高级的复制文件</h4><p><code>ADD</code>在 <code>COPY</code> 基础上增加了一些功能。比如 <code>&lt;源路径&gt;</code> 可以是一个 <code>URL</code>，这种情况下，Docker 引擎会试图去下载这个链接的文件放到 <code>&lt;目标路径&gt;</code> 去。下载后的文件权限自动设置为 <code>600</code>，如果这并不是想要的权限，那么还需要增加额外的一层 <code>RUN</code> 进行权限调整，另外，如果下载的是个压缩包，需要解压缩，也一样还需要额外的一层 <code>RUN</code> 指令进行解压缩。因此，这个功能其实并不实用，而且不推荐使用。</p>
<p>如果 <code>&lt;源路径&gt;</code> 为一个 <code>tar</code> 压缩文件的话，压缩格式为 <code>gzip</code>, <code>bzip2</code> 以及 <code>xz</code> 的情况下，<code>ADD</code> 指令将会自动解压缩这个压缩文件到 <code>&lt;目标路径&gt;</code> 去。</p>
<p>在 <code>COPY</code> 和 <code>ADD</code> 指令中选择的时候，可以遵循这样的原则，所有的文件复制均使用 <code>COPY</code> 指令，仅在需要自动解压缩的场合使用 <code>ADD</code>。</p>
<p>在使用该指令的时候还可以加上 <code>--chown=:</code> 选项来改变文件的所属用户及所属组。</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ADD</span><span class="bash"> --chown=55:mygroup files* /mydir/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> --chown=bin files* /mydir/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> --chown=1 files* /mydir/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="bash"> --chown=10:11 files* /mydir/</span></span><br></pre></td></tr></table></figure>

<h4 id="CMD-容器启动命令"><a href="#CMD-容器启动命令" class="headerlink" title="CMD 容器启动命令"></a>CMD 容器启动命令</h4><p>Docker 不是虚拟机，容器就是进程，那么在启动容器的时候，需要指定所运行的程序及参数。<code>CMD</code> 指令就是用于指定默认的容器主进程的启动命令的。</p>
<ul>
<li><code>shell</code> 格式：<code>CMD &lt;命令&gt;</code></li>
<li><code>exec</code> 格式：<code>CMD [&quot;可执行文件&quot;, &quot;参数1&quot;, &quot;参数2&quot;...]</code></li>
<li>参数列表格式：<code>CMD [&quot;参数1&quot;, &quot;参数2&quot;...]</code>。在指定了 <code>ENTRYPOINT</code> 指令后，用 <code>CMD</code> 指定具体的参数。</li>
</ul>
<p>Docker 不是虚拟机，容器中的应用都应该以前台执行，而不是像虚拟机、物理机里面那样，用 <code>systemd</code> 去启动后台服务，容器内没有后台服务的概念。</p>
<p>而使用 <code>service nginx start</code> 命令，则是希望 upstart 来以后台守护进程形式启动 <code>nginx</code> 服务。而刚才说了 <code>CMD service nginx start</code> 会被理解为 <code>CMD [ &quot;sh&quot;, &quot;-c&quot;, &quot;service nginx start&quot;]</code>，因此主进程实际上是 <code>sh</code>。那么当 <code>service nginx start</code> 命令结束后，<code>sh</code> 也就结束了，<code>sh</code> 作为主进程退出了，自然就会令容器退出。</p>
<p>正确的做法是直接执行 <code>nginx</code> 可执行文件，并且要求以前台形式运行。比如：</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">&quot;nginx&quot;</span>, <span class="string">&quot;-g&quot;</span>, <span class="string">&quot;daemon off;&quot;</span>]</span></span><br></pre></td></tr></table></figure>

<h4 id="ENTRYPOINT-入口点"><a href="#ENTRYPOINT-入口点" class="headerlink" title="ENTRYPOINT 入口点"></a>ENTRYPOINT 入口点</h4><p><code>ENTRYPOINT</code> 的目的和 <code>CMD</code> 一样，都是在指定容器启动程序及参数。<code>ENTRYPOINT</code> 在运行时也可以替代，不过比 <code>CMD</code> 要略显繁琐，需要通过 <code>docker run</code> 的参数 <code>--entrypoint</code> 来指定。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">FROM ubuntu:18.04</span><br><span class="line">RUN apt-get update \</span><br><span class="line">    &amp;&amp; apt-get install -y curl \</span><br><span class="line">    &amp;&amp; rm -rf /var/lib/apt/lists/*</span><br><span class="line">ENTRYPOINT [ &quot;curl&quot;, &quot;-s&quot;, &quot;https://ip.cn&quot; ]</span><br><span class="line"><span class="meta">$</span><span class="bash">docker run myip -i</span></span><br></pre></td></tr></table></figure>

<p>跟在镜像名后面的是 <code>command</code>，运行时会替换 <code>CMD</code> 的默认值，因此这里的 <code>-i</code> 替换了原来的 <code>CMD</code>。</p>
<h4 id="ENV-设置环境变量"><a href="#ENV-设置环境变量" class="headerlink" title="ENV 设置环境变量"></a>ENV 设置环境变量</h4><p>格式有两种：</p>
<ul>
<li><code>ENV  </code></li>
<li><code>ENV = =...</code></li>
</ul>
<p>这个指令很简单，就是设置环境变量而已，无论是后面的其它指令，如 <code>RUN</code>，还是运行时的应用，都可以直接使用这里定义的环境变量。</p>
<h4 id="ARG-构建参数"><a href="#ARG-构建参数" class="headerlink" title="ARG 构建参数"></a>ARG 构建参数</h4><p>格式：<code>ARG &lt;参数名&gt;[=&lt;默认值&gt;]</code></p>
<p>构建参数和 <code>ENV</code> 的效果一样，都是设置环境变量。所不同的是，<code>ARG</code> 所设置的构建环境的环境变量，在将来容器运行时是不会存在这些环境变量的。但是不要因此就使用 <code>ARG</code> 保存密码之类的信息，因为 <code>docker history</code> 还是可以看到所有值的。</p>
<p><code>Dockerfile</code> 中的 <code>ARG</code> 指令是定义参数名称，以及定义其默认值。该默认值可以在构建命令 <code>docker build</code> 中用 <code>--build-arg &lt;参数名&gt;=&lt;值&gt;</code> 来覆盖。</p>
<p>在 1.13 之前的版本，要求 <code>--build-arg</code> 中的参数名，必须在 <code>Dockerfile</code> 中用 <code>ARG</code> 定义过了，换句话说，就是 <code>--build-arg</code> 指定的参数，必须在 <code>Dockerfile</code> 中使用了。如果对应参数没有被使用，则会报错退出构建。从 1.13 开始，这种严格的限制被放开，不再报错退出，而是显示警告信息，并继续构建。这对于使用 CI 系统，用同样的构建流程构建不同的 <code>Dockerfile</code> 的时候比较有帮助，避免构建命令必须根据每个 Dockerfile 的内容修改。</p>
<h4 id="VOLUME-定义匿名卷"><a href="#VOLUME-定义匿名卷" class="headerlink" title="VOLUME 定义匿名卷"></a>VOLUME 定义匿名卷</h4><p>格式为：</p>
<ul>
<li><code>VOLUME [&quot;&lt;路径1&gt;&quot;, &quot;&lt;路径2&gt;&quot;...]</code></li>
<li><code>VOLUME &lt;路径&gt;</code></li>
</ul>
<p>之前我们说过，容器运行时应该尽量保持容器存储层不发生写操作，对于数据库类需要保存动态数据的应用，其数据库文件应该保存于卷(volume)中，后面的章节我们会进一步介绍 Docker 卷的概念。为了防止运行时用户忘记将动态文件所保存目录挂载为卷，在 <code>Dockerfile</code> 中，我们可以事先指定某些目录挂载为匿名卷，这样在运行时如果用户不指定挂载，其应用也可以正常运行，不会向容器存储层写入大量数据。</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">VOLUME</span><span class="bash"> /data</span></span><br></pre></td></tr></table></figure>

<p>这里的 <code>/data</code> 目录就会在运行时自动挂载为匿名卷，任何向 <code>/data</code> 中写入的信息都不会记录进容器存储层，从而保证了容器存储层的无状态化。当然，运行时可以覆盖这个挂载设置。比如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -v mydata:/data xxxx</span><br></pre></td></tr></table></figure>

<p>在这行命令中，就使用了 <code>mydata</code> 这个命名卷挂载到了 <code>/data</code> 这个位置，替代了 <code>Dockerfile</code> 中定义的匿名卷的挂载配置。</p>
<h4 id="EXPOSE-声明端口"><a href="#EXPOSE-声明端口" class="headerlink" title="EXPOSE 声明端口"></a>EXPOSE 声明端口</h4><p>格式为 <code>EXPOSE &lt;端口1&gt; [&lt;端口2&gt;...]</code>。</p>
<p><code>EXPOSE</code> 指令是声明运行时容器提供服务端口，这只是一个声明，在运行时并不会因为这个声明应用就会开启这个端口的服务。在 Dockerfile 中写入这样的声明有两个好处，一个是帮助镜像使用者理解这个镜像服务的守护端口，以方便配置映射；另一个用处则是在运行时使用随机端口映射时，也就是 <code>docker run -P</code> 时，会自动随机映射 <code>EXPOSE</code> 的端口。</p>
<p>要将 <code>EXPOSE</code> 和在运行时使用 <code>-p &lt;宿主端口&gt;:&lt;容器端口&gt;</code> 区分开来。<code>-p</code>，是映射宿主端口和容器端口，换句话说，就是将容器的对应端口服务公开给外界访问，而 <code>EXPOSE</code> 仅仅是声明容器打算使用什么端口而已，并不会自动在宿主进行端口映射。</p>
<h4 id="WORKDIR-指定工作目录"><a href="#WORKDIR-指定工作目录" class="headerlink" title="WORKDIR 指定工作目录"></a>WORKDIR 指定工作目录</h4><p>格式为 <code>WORKDIR &lt;工作目录路径&gt;</code>。</p>
<p>使用 <code>WORKDIR</code> 指令可以来指定工作目录（或者称为当前目录），以后各层的当前目录就被改为指定的目录，如该目录不存在，<code>WORKDIR</code> 会帮你建立目录。</p>
<p>之前提到一些初学者常犯的错误是把 <code>Dockerfile</code> 等同于 Shell 脚本来书写，这种错误的理解还可能会导致出现下面这样的错误：</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">cd</span> /app</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> <span class="built_in">echo</span> <span class="string">&quot;hello&quot;</span> &gt; world.txt</span></span><br></pre></td></tr></table></figure>

<p>如果将这个 <code>Dockerfile</code> 进行构建镜像运行后，会发现找不到 <code>/app/world.txt</code> 文件，或者其内容不是 <code>hello</code>。原因其实很简单，在 Shell 中，连续两行是同一个进程执行环境，因此前一个命令修改的内存状态，会直接影响后一个命令；而在 <code>Dockerfile</code> 中，这两行 <code>RUN</code> 命令的执行环境根本不同，是两个完全不同的容器。这就是对 <code>Dockerfile</code> 构建分层存储的概念不了解所导致的错误。</p>
<p>之前说过每一个 <code>RUN</code> 都是启动一个容器、执行命令、然后提交存储层文件变更。第一层 <code>RUN cd /app</code> 的执行仅仅是当前进程的工作目录变更，一个内存上的变化而已，其结果不会造成任何文件变更。而到第二层的时候，启动的是一个全新的容器，跟第一层的容器更完全没关系，自然不可能继承前一层构建过程中的内存变化。</p>
<p>因此如果需要改变以后各层的工作目录的位置，那么应该使用 <code>WORKDIR</code> 指令。</p>
<h4 id="USER-指定当前用户"><a href="#USER-指定当前用户" class="headerlink" title="USER 指定当前用户"></a>USER 指定当前用户</h4><p>格式：<code>USER &lt;用户名&gt;[:&lt;用户组&gt;]</code></p>
<p><code>USER</code> 指令和 <code>WORKDIR</code> 相似，都是改变环境状态并影响以后的层。<code>WORKDIR</code> 是改变工作目录，<code>USER</code> 则是改变之后层的执行 <code>RUN</code>, <code>CMD</code> 以及 <code>ENTRYPOINT</code> 这类命令的身份。</p>
<p>当然，和 <code>WORKDIR</code> 一样，<code>USER</code> 只是帮助你切换到指定用户而已，这个用户必须是事先建立好的，否则无法切换。</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">RUN</span><span class="bash"> groupadd -r redis &amp;&amp; useradd -r -g redis redis</span></span><br><span class="line"><span class="keyword">USER</span> redis</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> [ <span class="string">&quot;redis-server&quot;</span> ]</span></span><br></pre></td></tr></table></figure>

<p>如果以 <code>root</code> 执行的脚本，在执行期间希望改变身份，比如希望以某个已经建立好的用户来运行某个服务进程，不要使用 <code>su</code> 或者 <code>sudo</code>，这些都需要比较麻烦的配置，而且在 TTY 缺失的环境下经常出错。建议使用 <a target="_blank" rel="noopener" href="https://github.com/tianon/gosu"><code>gosu</code></a>。</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建立 redis 用户，并使用 gosu 换另一个用户执行命令</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> groupadd -r redis &amp;&amp; useradd -r -g redis redis</span></span><br><span class="line"><span class="comment"># 下载 gosu</span></span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> wget -O /usr/<span class="built_in">local</span>/bin/gosu <span class="string">&quot;https://github.com/tianon/gosu/releases/download/1.7/gosu-amd64&quot;</span> \</span></span><br><span class="line"><span class="bash">    &amp;&amp; chmod +x /usr/<span class="built_in">local</span>/bin/gosu \</span></span><br><span class="line"><span class="bash">    &amp;&amp; gosu nobody <span class="literal">true</span></span></span><br><span class="line"><span class="comment"># 设置 CMD，并以另外的用户执行</span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [ <span class="string">&quot;exec&quot;</span>, <span class="string">&quot;gosu&quot;</span>, <span class="string">&quot;redis&quot;</span>, <span class="string">&quot;redis-server&quot;</span> ]</span></span><br></pre></td></tr></table></figure>

<h4 id="HEALTHCHECK-健康检查"><a href="#HEALTHCHECK-健康检查" class="headerlink" title="HEALTHCHECK 健康检查"></a>HEALTHCHECK 健康检查</h4><p>格式：</p>
<ul>
<li><code>HEALTHCHECK [选项] CMD &lt;命令&gt;</code>：设置检查容器健康状况的命令</li>
<li><code>HEALTHCHECK NONE</code>：如果基础镜像有健康检查指令，使用这行可以屏蔽掉其健康检查指令</li>
</ul>
<p><code>HEALTHCHECK</code> 指令是告诉 Docker 应该如何进行判断容器的状态是否正常，这是 Docker 1.12 引入的新指令。</p>
<p>在没有 <code>HEALTHCHECK</code> 指令前，Docker 引擎只可以通过容器内主进程是否退出来判断容器是否状态异常。很多情况下这没问题，但是如果程序进入死锁状态，或者死循环状态，应用进程并不退出，但是该容器已经无法提供服务了。在 1.12 以前，Docker 不会检测到容器的这种状态，从而不会重新调度，导致可能会有部分容器已经无法提供服务了却还在接受用户请求。</p>
<p>而自 1.12 之后，Docker 提供了 <code>HEALTHCHECK</code> 指令，通过该指令指定一行命令，用这行命令来判断容器主进程的服务状态是否还正常，从而比较真实的反应容器实际状态。</p>
<p>当在一个镜像指定了 <code>HEALTHCHECK</code> 指令后，用其启动容器，初始状态会为 <code>starting</code>，在 <code>HEALTHCHECK</code> 指令检查成功后变为 <code>healthy</code>，如果连续一定次数失败，则会变为 <code>unhealthy</code>。</p>
<p><code>HEALTHCHECK</code> 支持下列选项：</p>
<ul>
<li><code>--interval=&lt;间隔&gt;</code>：两次健康检查的间隔，默认为 30 秒；</li>
<li><code>--timeout=&lt;时长&gt;</code>：健康检查命令运行超时时间，如果超过这个时间，本次健康检查就被视为失败，默认 30 秒；</li>
<li><code>--retries=&lt;次数&gt;</code>：当连续失败指定次数后，则将容器状态视为 <code>unhealthy</code>，默认 3 次。</li>
</ul>
<p>和 <code>CMD</code>, <code>ENTRYPOINT</code> 一样，<code>HEALTHCHECK</code> 只可以出现一次，如果写了多个，只有最后一个生效。</p>
<p>在 <code>HEALTHCHECK [选项] CMD</code> 后面的命令，格式和 <code>ENTRYPOINT</code> 一样，分为 <code>shell</code> 格式，和 <code>exec</code> 格式。命令的返回值决定了该次健康检查的成功与否：<code>0</code>：成功；<code>1</code>：失败；<code>2</code>：保留，不要使用这个值。</p>
<p>假设我们有个镜像是个最简单的 Web 服务，我们希望增加健康检查来判断其 Web 服务是否在正常工作，我们可以用 <code>curl</code> 来帮助判断，其 <code>Dockerfile</code> 的 <code>HEALTHCHECK</code> 可以这么写：</p>
<figure class="highlight docker"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> nginx</span><br><span class="line"><span class="keyword">RUN</span><span class="bash"> apt-get update &amp;&amp; apt-get install -y curl &amp;&amp; rm -rf /var/lib/apt/lists/*</span></span><br><span class="line"><span class="keyword">HEALTHCHECK</span><span class="bash"> --interval=5s --timeout=3s \</span></span><br><span class="line"><span class="bash">  CMD curl -fs http://localhost/ || <span class="built_in">exit</span> 1</span></span><br></pre></td></tr></table></figure>

<p>这里我们设置了每 5 秒检查一次（这里为了试验所以间隔非常短，实际应该相对较长），如果健康检查命令超过 3 秒没响应就视为失败，并且使用 <code>curl -fs http://localhost/ || exit 1</code> 作为健康检查命令。</p>
<p>如果健康检查连续失败超过了重试次数，状态就会变为 <code>(unhealthy)</code>。</p>
<p>为了帮助排障，健康检查命令的输出（包括 <code>stdout</code> 以及 <code>stderr</code>）都会被存储于健康状态里，可以用 <code>docker inspect</code> 来查看。</p>
<p><strong><em>这里的健康检查类似于Keepalived的应用层的健康检查</em></strong></p>
<h4 id="ONBUILD-为他人做嫁衣裳"><a href="#ONBUILD-为他人做嫁衣裳" class="headerlink" title="ONBUILD 为他人做嫁衣裳"></a>ONBUILD 为他人做嫁衣裳</h4><p>格式：<code>ONBUILD &lt;其它指令&gt;</code>。</p>
<p><code>ONBUILD</code> 是一个特殊的指令，它后面跟的是其它指令，比如 <code>RUN</code>, <code>COPY</code> 等，而这些指令，在当前镜像构建时并不会被执行。只有当以当前镜像为基础镜像，去构建下一级镜像的时候才会被执行。</p>
<h3 id="操作容器"><a href="#操作容器" class="headerlink" title="操作容器"></a>操作容器</h3><h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><ul>
<li><p>创建并启动</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -t -i ubuntu:18.04 &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure>

<p>其中，<code>-t</code> 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上， <code>-i</code> 则让容器的标准输入保持打开。</p>
<p>当利用 <code>docker run</code> 来创建容器时，Docker 在后台运行的标准操作包括：</p>
<ul>
<li>检查本地是否存在指定的镜像，不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统，并在只读的镜像层外面挂载一层可读写层</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口到容器中去</li>
<li>从地址池配置一个 ip 地址给容器</li>
<li>执行用户指定的应用程序</li>
<li>执行完毕后容器被终止</li>
</ul>
</li>
<li><p>启动已终止容器</p>
<p>可以利用 <code>docker container start</code> 命令，直接将一个已经终止的容器启动运行。</p>
<p>容器的核心为所执行的应用程序，所需要的资源都是应用程序运行所必需的。除此之外，并没有其它的资源。可以在伪终端中利用 <code>ps</code> 或 <code>top</code> 来查看进程信息。</p>
</li>
</ul>
<h4 id="守护态运行"><a href="#守护态运行" class="headerlink" title="守护态运行"></a>守护态运行</h4><p>更多的时候，需要让 Docker 在后台运行而不是直接把执行命令的结果输出在当前宿主机下。此时，可以通过添加 <code>-d</code> 参数来实现。</p>
<p>此时容器会在后台运行并不会把输出的结果 (STDOUT) 打印到宿主机上面(输出结果可以用 <code>docker logs</code> 查看)。</p>
<p>使用 <code>-d</code> 参数启动后会返回一个唯一的 id，也可以通过 <code>docker container ls</code> 命令来查看容器信息。</p>
<p>要获取容器的输出信息，可以通过 <code>docker container logs</code> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker container logs [container ID or NAMES]</span><br></pre></td></tr></table></figure>

<h4 id="终止容器"><a href="#终止容器" class="headerlink" title="终止容器"></a>终止容器</h4><p><code>docker container stop</code></p>
<p>终止状态的容器可以用 <code>docker container ls -a</code> 命令看到</p>
<p>处于终止状态的容器，可以通过 <code>docker container start</code> 命令来重新启动。</p>
<p>此外，<code>docker container restart</code> 命令会将一个运行态的容器终止，然后再重新启动它。</p>
<h4 id="进入容器"><a href="#进入容器" class="headerlink" title="进入容器"></a>进入容器</h4><h5 id="attach"><a href="#attach" class="headerlink" title="attach"></a>attach</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -dit ubuntu</span><br><span class="line">243c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550</span><br><span class="line"></span><br><span class="line">$ docker container ls</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">243c32535da7        ubuntu:latest       <span class="string">&quot;/bin/bash&quot;</span>         18 seconds ago      Up 17 seconds                           nostalgic_hypatia</span><br><span class="line"></span><br><span class="line">$ docker attach 243c</span><br><span class="line">root@243c32535da7:/<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>如果从这个 stdin 中 exit，会导致容器的停止。</p>
<h5 id="exec"><a href="#exec" class="headerlink" title="exec"></a>exec</h5><p><code>docker exec</code> 后边可以跟多个参数，这里主要说明 <code>-i</code> <code>-t</code> 参数。</p>
<p>只用 <code>-i</code> 参数时，由于没有分配伪终端，界面没有我们熟悉的 Linux 命令提示符，但命令执行结果仍然可以返回。</p>
<p>当 <code>-i</code> <code>-t</code> 参数一起使用时，则可以看到我们熟悉的 Linux 命令提示符。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -dit ubuntu</span><br><span class="line">69d137adef7a8a689cbcb059e94da5489d3cddd240ff675c640c8d96e84fe1f6</span><br><span class="line"></span><br><span class="line">$ docker container ls</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">69d137adef7a        ubuntu:latest       <span class="string">&quot;/bin/bash&quot;</span>         18 seconds ago      Up 17 seconds                           zealous_swirles</span><br><span class="line"></span><br><span class="line">$ docker <span class="built_in">exec</span> -i 69d1 bash</span><br><span class="line">ls</span><br><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">$ docker <span class="built_in">exec</span> -it 69d1 bash</span><br><span class="line">root@69d137adef7a:/<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>如果从这个 stdin 中 exit，不会导致容器的停止。这就是为什么推荐大家使用 <code>docker exec</code> 的原因。</p>
<h4 id="导入和导出"><a href="#导入和导出" class="headerlink" title="导入和导出"></a>导入和导出</h4><p>导出本地某个容器，可以使用 <code>docker export</code> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">export</span> 7691a814370e &gt; ubuntu.tar</span><br></pre></td></tr></table></figure>

<p>使用 <code>docker import</code> 从容器快照文件中再导入为镜像</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ cat ubuntu.tar | docker import - <span class="built_in">test</span>/ubuntu:v1.0</span><br><span class="line">$ docker image ls</span><br><span class="line">REPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE</span><br><span class="line"><span class="built_in">test</span>/ubuntu         v1.0                9d37a6082e97        About a minute ago   171.3 MB</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker import http://example.com/exampleimage.tgz example/imagerepo</span><br></pre></td></tr></table></figure>

<p><em>注：用户既可以使用 <code>docker load</code> 来导入镜像存储文件到本地镜像库，也可以使用 <code>docker import</code> 来导入一个容器快照到本地镜像库。这两者的区别在于容器快照文件将丢弃所有的历史记录和元数据信息（即仅保存容器当时的快照状态），而镜像存储文件将保存完整记录，体积也要大。此外，从容器快照文件导入时可以重新指定标签等元数据信息。（多看几遍，还不懂）</em></p>
<h4 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h4><p><code>docker container rm</code> 删除一个处于终止状态的容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker container rm  trusting_newton</span><br><span class="line">trusting_newton</span><br></pre></td></tr></table></figure>

<p>如果要删除一个运行中的容器，可以添加 <code>-f</code> 参数。Docker 会发送 <code>SIGKILL</code> 信号给容器。</p>
<p><code>docker container ls -a</code> 命令可以查看所有已经创建的包括终止状态的容器，<code>docker container prune</code>可以清理掉所有处于终止状态的容器。</p>
<h3 id="访问仓库"><a href="#访问仓库" class="headerlink" title="访问仓库"></a>访问仓库</h3><p>仓库（<code>Repository</code>）是集中存放镜像的地方。</p>
<p>一个容易混淆的概念是注册服务器（<code>Registry</code>）。实际上注册服务器是管理仓库的具体服务器，每个服务器上可以有多个仓库，而每个仓库下面有多个镜像。从这方面来说，仓库可以被认为是一个具体的项目或目录。例如对于仓库地址 <code>docker.io/ubuntu</code> 来说，<code>docker.io</code> 是注册服务器地址，<code>ubuntu</code> 是仓库名。</p>
<p>大部分时候，并不需要严格区分这两者的概念。</p>
<h3 id="数据管理"><a href="#数据管理" class="headerlink" title="数据管理"></a>数据管理</h3><h4 id="数据卷"><a href="#数据卷" class="headerlink" title="数据卷"></a>数据卷</h4><p><code>数据卷</code> 是一个可供一个或多个容器使用的特殊目录，它绕过 UFS，可以提供很多有用的特性：</p>
<ul>
<li><code>数据卷</code> 可以在容器之间共享和重用</li>
<li>对 <code>数据卷</code> 的修改会立马生效</li>
<li>对 <code>数据卷</code> 的更新，不会影响镜像</li>
<li><code>数据卷</code> 默认会一直存在，即使容器被删除</li>
</ul>
<p>注意：<code>数据卷</code> 的使用，类似于 Linux 下对目录或文件进行 mount，镜像中的被指定为挂载点的目录中的文件会隐藏掉，能显示看的是挂载的 <code>数据卷</code>。</p>
<h5 id="创建一个数据卷"><a href="#创建一个数据卷" class="headerlink" title="创建一个数据卷"></a>创建一个数据卷</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker volume create my-vol</span><br></pre></td></tr></table></figure>

<h5 id="查看所有的-数据卷"><a href="#查看所有的-数据卷" class="headerlink" title="查看所有的 数据卷"></a>查看所有的 <code>数据卷</code></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker volume ls</span><br></pre></td></tr></table></figure>

<h5 id="查看指定-数据卷-的信息"><a href="#查看指定-数据卷-的信息" class="headerlink" title="查看指定 数据卷 的信息"></a>查看指定 <code>数据卷</code> 的信息</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker volume inspect my-vol</span><br></pre></td></tr></table></figure>

<h5 id="启动一个挂载数据卷的容器"><a href="#启动一个挂载数据卷的容器" class="headerlink" title="启动一个挂载数据卷的容器"></a>启动一个挂载数据卷的容器</h5><p>在用 <code>docker run</code> 命令的时候，使用 <code>--mount</code> 标记来将 <code>数据卷</code> 挂载到容器里。在一次 <code>docker run</code> 中可以挂载多个 <code>数据卷</code>。</p>
<p>下面创建一个名为 <code>web</code> 的容器，并加载一个 <code>数据卷</code> 到容器的 <code>/webapp</code> 目录。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -P \</span><br><span class="line">    --name web \</span><br><span class="line">    <span class="comment"># -v my-vol:/wepapp \</span></span><br><span class="line">    --mount <span class="built_in">source</span>=my-vol,target=/webapp \</span><br><span class="line">    training/webapp \</span><br><span class="line">    python app.py</span><br></pre></td></tr></table></figure>

<h5 id="查看数据卷的具体信息"><a href="#查看数据卷的具体信息" class="headerlink" title="查看数据卷的具体信息"></a>查看数据卷的具体信息</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker inspect [container name/id]</span><br></pre></td></tr></table></figure>

<h5 id="删除数据卷"><a href="#删除数据卷" class="headerlink" title="删除数据卷"></a>删除数据卷</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker volume rm my-vol</span><br></pre></td></tr></table></figure>

<p><code>数据卷</code> 是被设计用来持久化数据的，它的生命周期独立于容器，Docker 不会在容器被删除后自动删除 <code>数据卷</code>，并且也不存在垃圾回收这样的机制来处理没有任何容器引用的 <code>数据卷</code>。如果需要在删除容器的同时移除数据卷。可以在删除容器的时候使用 <code>docker rm -v</code> 这个命令。</p>
<p>无主的数据卷可能会占据很多空间，要清理请使用以下命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker volume prune</span><br></pre></td></tr></table></figure>

<h4 id="挂载主机目录"><a href="#挂载主机目录" class="headerlink" title="挂载主机目录"></a>挂载主机目录</h4><p>使用 <code>--mount</code> 标记可以指定挂载一个本地主机的目录到容器中去。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -P \</span><br><span class="line">    --name web \</span><br><span class="line">    <span class="comment"># -v /src/webapp:/opt/webapp \</span></span><br><span class="line">    --mount <span class="built_in">type</span>=<span class="built_in">bind</span>,<span class="built_in">source</span>=/src/webapp,target=/opt/webapp \</span><br><span class="line">    training/webapp \</span><br><span class="line">    python app.py</span><br></pre></td></tr></table></figure>

<p>本地目录的路径必须是绝对路径，以前使用 <code>-v</code> 参数时如果本地目录不存在 Docker 会自动为你创建一个文件夹，现在使用 <code>--mount</code> 参数时如果本地目录不存在，Docker 会报错。</p>
<p>Docker 挂载主机目录的默认权限是 <code>读写</code>，用户也可以通过增加 <code>readonly</code> 指定为 <code>只读</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -P \</span><br><span class="line">    --name web \</span><br><span class="line">    <span class="comment"># -v /src/webapp:/opt/webapp:ro \</span></span><br><span class="line">    --mount <span class="built_in">type</span>=<span class="built_in">bind</span>,<span class="built_in">source</span>=/src/webapp,target=/opt/webapp,<span class="built_in">readonly</span> \</span><br><span class="line">    training/webapp \</span><br><span class="line">    python app.py</span><br></pre></td></tr></table></figure>

<p><code>--mount</code> 标记也可以从主机挂载单个文件到容器中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker run --rm -it \</span><br><span class="line">   <span class="comment"># -v $HOME/.bash_history:/root/.bash_history \</span></span><br><span class="line">   --mount <span class="built_in">type</span>=<span class="built_in">bind</span>,<span class="built_in">source</span>=<span class="variable">$HOME</span>/.bash_history,target=/root/.bash_history \</span><br><span class="line">   ubuntu:18.04 \</span><br><span class="line">   bash</span><br></pre></td></tr></table></figure>

<h3 id="使用网络"><a href="#使用网络" class="headerlink" title="使用网络"></a>使用网络</h3><h4 id="外部访问容器"><a href="#外部访问容器" class="headerlink" title="外部访问容器"></a>外部访问容器</h4><p>容器中可以运行一些网络应用，要让外部也可以访问这些应用，可以通过 <code>-P</code> 或 <code>-p</code> 参数来指定端口映射。</p>
<p>当使用 <code>-P</code> 标记时，Docker 会随机映射一个 <code>49000~49900</code> 的端口到内部容器开放的网络端口。</p>
<p><code>-p</code> 则可以指定要映射的端口，并且，在一个指定端口上只可以绑定一个容器。支持的格式有 <code>ip:hostPort:containerPort | ip::containerPort | hostPort:containerPort</code>。</p>
<h5 id="映射所有接口地址"><a href="#映射所有接口地址" class="headerlink" title="映射所有接口地址"></a>映射所有接口地址</h5><p>使用 <code>hostPort:containerPort</code> 格式本地的 5000 端口映射到容器的 5000 端口，可以执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -p 5000:5000 training/webapp python app.py</span><br></pre></td></tr></table></figure>

<p>此时默认会绑定本地所有接口上的所有地址。</p>
<h5 id="映射到指定地址的指定端口"><a href="#映射到指定地址的指定端口" class="headerlink" title="映射到指定地址的指定端口"></a>映射到指定地址的指定端口</h5><p>可以使用 <code>ip:hostPort:containerPort</code> 格式指定映射使用一个特定地址，比如 localhost 地址 127.0.0.1</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -p 127.0.0.1:5000:5000 training/webapp python app.py</span><br></pre></td></tr></table></figure>

<h5 id="映射到指定地址的任意端口"><a href="#映射到指定地址的任意端口" class="headerlink" title="映射到指定地址的任意端口"></a>映射到指定地址的任意端口</h5><p>使用 <code>ip::containerPort</code> 绑定 localhost 的任意端口到容器的 5000 端口，本地主机会自动分配一个端口。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -p 127.0.0.1::5000 training/webapp python app.py</span><br></pre></td></tr></table></figure>

<p>还可以使用 <code>udp</code> 标记来指定 <code>udp</code> 端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -p 127.0.0.1:5000:5000/udp training/webapp python app.py</span><br></pre></td></tr></table></figure>

<h5 id="查看映射端口配置"><a href="#查看映射端口配置" class="headerlink" title="查看映射端口配置"></a>查看映射端口配置</h5><p>使用 <code>docker port</code> 来查看当前映射的端口配置，也可以查看到绑定的地址</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ docker port nostalgic_morse 5000</span><br><span class="line">127.0.0.1:49155.</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>容器有自己的内部网络和 ip 地址（使用 <code>docker inspect</code> 可以获取所有的变量，Docker 还可以有一个可变的网络配置。）</li>
<li><code>-p</code> 标记可以多次使用来绑定多个端口</li>
</ul>
<p>例如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d \</span><br><span class="line">    -p 5000:5000 \</span><br><span class="line">    -p 3000:80 \</span><br><span class="line">    training/webapp \</span><br><span class="line">    python app.py</span><br></pre></td></tr></table></figure>

<h4 id="容器互联"><a href="#容器互联" class="headerlink" title="容器互联"></a>容器互联</h4><p>容器互联有两种方法：</p>
<ul>
<li>使用<code>--link</code>参数</li>
<li>将容器加入自定义的Docker网络</li>
</ul>
<p>第二种方法为推荐方法</p>
<h5 id="新建网络"><a href="#新建网络" class="headerlink" title="新建网络"></a>新建网络</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker network create -d bridge my-net</span><br></pre></td></tr></table></figure>

<p> 参数指定 Docker 网络类型，有 <code>bridge</code> <code>overlay</code>。其中 <code>overlay</code> 网络类型用于 Swarm mode。</p>
<h5 id="连接容器"><a href="#连接容器" class="headerlink" title="连接容器"></a>连接容器</h5><p>运行一个容器并连接到新建的 <code>my-net</code> 网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it --rm --name busybox1 --network my-net busybox sh</span><br></pre></td></tr></table></figure>

<p>打开新的终端，再运行一个容器并加入到 <code>my-net</code> 网络</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it --rm --name busybox2 --network my-net busybox sh</span><br></pre></td></tr></table></figure>

<h5 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h5><p>多个容器之间互相连接时推荐使用Docker Compose。</p>
<h4 id="配置DNS"><a href="#配置DNS" class="headerlink" title="配置DNS"></a>配置DNS</h4><p>默认情况下Docker容器挂载宿主机的DNS及主机名的相应配置文件，具体情况可以在容器中用<code>mount</code>命令查看，若需单独配置容器的DNS，可在<code>/etc/docker/daemon.json</code>文件中增加以下内容：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;dns&quot;</span> : [</span><br><span class="line">    <span class="string">&quot;114.114.114.114&quot;</span>,</span><br><span class="line">    <span class="string">&quot;8.8.8.8&quot;</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在启动容器时也可在命令行指定DNS和主机名，只需加入参数：<code>-h HOSTNAME</code> 或者 <code>--hostname=HOSTNAME</code>，这些参数会被写入容器内的<code>/etc/hosts</code>和<code>/etc/hosts</code>,但在容器外部看不到；<code>--dns=IP_ADDRESS</code> 添加 DNS 服务器到容器的 <code>/etc/resolv.conf</code> 中，让容器用这个服务器来解析所有不在 <code>/etc/hosts</code> 中的主机名；<code>--dns-search=DOMAIN</code> 设定容器的搜索域，当设定搜索域为 <code>.example.com</code> 时，在搜索一个名为 host 的主机时，DNS 不仅搜索 host，还会搜索 <code>host.example.com</code>。</p>
<p>注意：如果在容器启动时没有指定最后两个参数，Docker 会默认用主机上的 <code>/etc/resolv.conf</code> 来配置容器。</p>
<h3 id="高级网络配置"><a href="#高级网络配置" class="headerlink" title="高级网络配置"></a>高级网络配置</h3><p>当 Docker 启动时，会自动在主机上创建一个 <code>docker0</code> 虚拟网桥，实际上是 Linux 的一个 bridge，可以理解为一个软件交换机。它会在挂载到它的网口之间进行转发。</p>
<p>同时，Docker 随机分配一个本地未占用的私有网段（在 <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc1918">RFC1918</a> 中定义）中的一个地址给 <code>docker0</code> 接口。比如典型的 <code>172.17.42.1</code>，掩码为 <code>255.255.0.0</code>。此后启动的容器内的网口也会自动分配一个同一网段（<code>172.17.0.0/16</code>）的地址。</p>
<p>当创建一个 Docker 容器的时候，同时会创建了一对 <code>veth pair</code> 接口（当数据包发送到一个接口时，另外一个接口也可以收到相同的数据包）。这对接口一端在容器内，即 <code>eth0</code>；另一端在本地并被挂载到 <code>docker0</code> 网桥，名称以 <code>veth</code> 开头（例如 <code>vethAQI2QT</code>）。通过这种方式，主机可以跟容器通信，容器之间也可以相互通信。Docker 就创建了在主机和所有容器之间一个虚拟共享网络。</p>
<h4 id="快速配置"><a href="#快速配置" class="headerlink" title="快速配置"></a>快速配置</h4><p>下面是一个跟 Docker 网络相关的命令列表。</p>
<p>其中有些命令选项只有在 Docker 服务启动的时候才能配置，而且不能马上生效。</p>
<ul>
<li><code>-b BRIDGE</code> 或 <code>--bridge=BRIDGE</code> 指定容器挂载的网桥</li>
<li><code>--bip=CIDR</code> 定制 docker0 的掩码</li>
<li><code>-H SOCKET...</code> 或 <code>--host=SOCKET...</code> Docker 服务端接收命令的通道</li>
<li><code>--icc=true|false</code> 是否支持容器之间进行通信</li>
<li><code>--ip-forward=true|false</code> 请看下文容器之间的通信</li>
<li><code>--iptables=true|false</code> 是否允许 Docker 添加 iptables 规则</li>
<li><code>--mtu=BYTES</code> 容器网络中的 MTU</li>
</ul>
<p>下面2个命令选项既可以在启动服务时指定，也可以在启动容器时指定。在 Docker 服务启动的时候指定则会成为默认值，后面执行 <code>docker run</code> 时可以覆盖设置的默认值。</p>
<ul>
<li><code>--dns=IP_ADDRESS...</code> 使用指定的DNS服务器</li>
<li><code>--dns-search=DOMAIN...</code> 指定DNS搜索域</li>
</ul>
<p>最后这些选项只有在 <code>docker run</code> 执行时使用，因为它是针对容器的特性内容。</p>
<ul>
<li><code>-h HOSTNAME</code> 或 <code>--hostname=HOSTNAME</code> 配置容器主机名</li>
<li><code>--link=CONTAINER_NAME:ALIAS</code> 添加到另一个容器的连接</li>
<li><code>--net=bridge|none|container:NAME_or_ID|host</code> 配置容器的桥接模式</li>
<li><code>-p SPEC</code> 或 <code>--publish=SPEC</code> 映射容器端口到宿主主机</li>
<li><code>-P or --publish-all=true|false</code> 映射容器所有端口到宿主主机</li>
</ul>
<h4 id="容器访问控制"><a href="#容器访问控制" class="headerlink" title="容器访问控制"></a>容器访问控制</h4><p>容器的访问控制，主要通过 Linux 上的 <code>iptables</code> 防火墙来进行管理和实现。<code>iptables</code> 是 Linux 上默认的防火墙软件，在大部分发行版中都自带。</p>
<h5 id="容器访问外部网络"><a href="#容器访问外部网络" class="headerlink" title="容器访问外部网络"></a>容器访问外部网络</h5><p>容器要想访问外部网络，需要本地系统的转发支持。在Linux 系统中，检查转发是否打开。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sysctl</span> net.ipv4.ip_forward</span><br><span class="line">net.ipv4.ip_forward = 1</span><br></pre></td></tr></table></figure>

<p>如果为 0，说明没有开启转发，则需要手动打开。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sysctl</span> -w net.ipv4.ip_forward=1</span><br></pre></td></tr></table></figure>

<p>如果在启动 Docker 服务的时候设定 <code>--ip-forward=true</code>, Docker 就会自动设定系统的 <code>ip_forward</code> 参数为 1。</p>
<h5 id="容器之间访问"><a href="#容器之间访问" class="headerlink" title="容器之间访问"></a>容器之间访问</h5><p>容器之间相互访问，需要两方面的支持。</p>
<ul>
<li>容器的网络拓扑是否已经互联。默认情况下，所有容器都会被连接到 <code>docker0</code> 网桥上。</li>
<li>本地系统的防火墙软件 – <code>iptables</code> 是否允许通过。</li>
</ul>
<h6 id="访问所有端口"><a href="#访问所有端口" class="headerlink" title="访问所有端口"></a>访问所有端口</h6><p>当启动 Docker 服务（即 dockerd）的时候，默认会添加一条转发策略到本地主机 iptables 的 FORWARD 链上。策略为通过（<code>ACCEPT</code>）还是禁止（<code>DROP</code>）取决于配置<code>--icc=true</code>（缺省值）还是 <code>--icc=false</code>。当然，如果手动指定 <code>--iptables=false</code> 则不会添加 <code>iptables</code> 规则。</p>
<p>可见，默认情况下，不同容器之间是允许网络互通的。如果为了安全考虑，可以在 <code>/etc/docker/daemon.json</code> 文件中配置 <code>&#123;&quot;icc&quot;: false&#125;</code> 来禁止它。</p>
<h6 id="访问指定端口"><a href="#访问指定端口" class="headerlink" title="访问指定端口"></a>访问指定端口</h6><p>在通过 <code>-icc=false</code> 关闭网络访问后，还可以通过 <code>--link=CONTAINER_NAME:ALIAS</code> 选项来访问容器的开放端口。</p>
<p>例如，在启动 Docker 服务时，可以同时使用 <code>icc=false --iptables=true</code> 参数来关闭允许相互的网络访问，并让 Docker 可以修改系统中的 <code>iptables</code> 规则。</p>
<p>此时，系统中的 <code>iptables</code> 规则可能是类似</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo iptables -nL</span><br><span class="line">...</span><br><span class="line">Chain FORWARD (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">DROP       all  --  0.0.0.0/0            0.0.0.0/0</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>之后，启动容器（<code>docker run</code>）时使用 <code>--link=CONTAINER_NAME:ALIAS</code> 选项。Docker 会在 <code>iptable</code> 中为 两个容器分别添加一条 <code>ACCEPT</code> 规则，允许相互访问开放的端口（取决于 <code>Dockerfile</code> 中的 <code>EXPOSE</code> 指令）。</p>
<p>当添加了 <code>--link=CONTAINER_NAME:ALIAS</code> 选项后，添加了 <code>iptables</code> 规则。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ sudo iptables -nL</span><br><span class="line">...</span><br><span class="line">Chain FORWARD (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">ACCEPT     tcp  --  172.17.0.2           172.17.0.3           tcp spt:80</span><br><span class="line">ACCEPT     tcp  --  172.17.0.3           172.17.0.2           tcp dpt:80</span><br><span class="line">DROP       all  --  0.0.0.0/0            0.0.0.0/0</span><br></pre></td></tr></table></figure>

<p>注意：<code>--link=CONTAINER_NAME:ALIAS</code> 中的 <code>CONTAINER_NAME</code> 目前必须是 Docker 分配的名字，或使用 <code>--name</code> 参数指定的名字。主机名则不会被识别。</p>
<h4 id="端口映射实现"><a href="#端口映射实现" class="headerlink" title="端口映射实现"></a>端口映射实现</h4><p>默认情况下，容器可以主动访问到外部网络的连接，但是外部网络无法访问到容器。</p>
<h5 id="容器访问外部实现"><a href="#容器访问外部实现" class="headerlink" title="容器访问外部实现"></a>容器访问外部实现</h5><p>容器所有到外部网络的连接，源地址都会被 NAT 成本地系统的 IP 地址。这是使用 <code>iptables</code> 的源地址伪装操作实现的。</p>
<p>查看主机的 NAT 规则。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo iptables -t nat -nL</span><br><span class="line">...</span><br><span class="line">Chain POSTROUTING (policy ACCEPT)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">MASQUERADE  all  --  172.17.0.0/16       !172.17.0.0/16</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>其中，上述规则将所有源地址在 <code>172.17.0.0/16</code> 网段，目标地址为其他网段（外部网络）的流量动态伪装为从系统网卡发出。MASQUERADE 跟传统 SNAT 的好处是它能动态从网卡获取地址。</p>
<h5 id="外部访问容器实现"><a href="#外部访问容器实现" class="headerlink" title="外部访问容器实现"></a>外部访问容器实现</h5><p>容器允许外部访问，可以在 <code>docker run</code> 时候通过 <code>-p</code> 或 <code>-P</code> 参数来启用。</p>
<p>不管用那种办法，其实也是在本地的 <code>iptable</code> 的 nat 表中添加相应的规则。</p>
<p>使用 <code>-P</code> 时：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ iptables -t nat -nL</span><br><span class="line">...</span><br><span class="line">Chain DOCKER (2 references)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">DNAT       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:49153 to:172.17.0.2:80</span><br></pre></td></tr></table></figure>

<p>使用 <code>-p 80:80</code> 时：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ iptables -t nat -nL</span><br><span class="line">Chain DOCKER (2 references)</span><br><span class="line">target     prot opt <span class="built_in">source</span>               destination</span><br><span class="line">DNAT       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:80 to:172.17.0.2:80</span><br></pre></td></tr></table></figure>

<p>注意：</p>
<ul>
<li>这里的规则映射了 <code>0.0.0.0</code>，意味着将接受主机来自所有接口的流量。用户可以通过 <code>-p IP:host_port:container_port</code> 或 <code>-p IP::port</code> 来指定允许访问容器的主机上的 IP、接口等，以制定更严格的规则。</li>
<li>如果希望永久绑定到某个固定的 IP 地址，可以在 Docker 配置文件 <code>/etc/docker/daemon.json</code> 中添加如下内容。</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;ip&quot;</span>: <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="配置docker0网桥"><a href="#配置docker0网桥" class="headerlink" title="配置docker0网桥"></a>配置docker0网桥</h4><p>Docker 服务默认会创建一个 <code>docker0</code> 网桥（其上有一个 <code>docker0</code> 内部接口），它在内核层连通了其他的物理或虚拟网卡，这就将所有容器和本地主机都放到同一个物理网络。</p>
<p>Docker 默认指定了 <code>docker0</code> 接口 的 IP 地址和子网掩码，让主机和容器之间可以通过网桥相互通信，它还给出了 MTU（接口允许接收的最大传输单元），通常是 1500 Bytes，或宿主主机网络路由上支持的默认值。这些值都可以在服务启动的时候进行配置。</p>
<ul>
<li><code>--bip=CIDR</code> IP 地址加掩码格式，例如 192.168.1.5/24</li>
<li><code>--mtu=BYTES</code> 覆盖默认的 Docker mtu 配置</li>
</ul>
<p>也可以在配置文件中配置 DOCKER_OPTS，然后重启服务。</p>
<p>由于目前 Docker 网桥是 Linux 网桥，用户可以使用 <code>brctl show</code> 来查看网桥和端口连接信息。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ sudo brctl show</span><br><span class="line">bridge name     bridge id               STP enabled     interfaces</span><br><span class="line">docker0         8000.3a1d7362b4ee       no              veth65f9</span><br><span class="line">                                             vethdda6</span><br></pre></td></tr></table></figure>

<p>*注：<code>brctl</code> 命令在 Debian、Ubuntu 中可以使用 <code>sudo apt-get install bridge-utils</code> 来安装。</p>
<p>每次创建一个新容器的时候，Docker 从可用的地址段中选择一个空闲的 IP 地址分配给容器的 eth0 端口。使用本地主机上 <code>docker0</code> 接口的 IP 作为所有容器的默认网关。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo docker run -i -t --rm base /bin/bash</span><br><span class="line">$ ip addr show eth0</span><br><span class="line">24: eth0: &lt;BROADCAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether 32:6f:e0:35:57:91 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.3/16 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::306f:e0ff:fe35:5791/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">$ ip route</span><br><span class="line">default via 172.17.42.1 dev eth0</span><br><span class="line">172.17.0.0/16 dev eth0  proto kernel  scope link  src 172.17.0.3</span><br></pre></td></tr></table></figure>

<h4 id="自定义网桥"><a href="#自定义网桥" class="headerlink" title="自定义网桥"></a>自定义网桥</h4><p>除了默认的 <code>docker0</code> 网桥，用户也可以指定网桥来连接各个容器。</p>
<p>在启动 Docker 服务的时候，使用 <code>-b BRIDGE</code>或<code>--bridge=BRIDGE</code> 来指定使用的网桥。</p>
<p>如果服务已经运行，那需要先停止服务，并删除旧的网桥。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo systemctl stop docker</span><br><span class="line">$ sudo ip link <span class="built_in">set</span> dev docker0 down</span><br><span class="line">$ sudo brctl delbr docker0</span><br></pre></td></tr></table></figure>

<p>然后创建一个网桥 <code>bridge0</code>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo brctl addbr bridge0</span><br><span class="line">$ sudo ip addr add 192.168.5.1/24 dev bridge0</span><br><span class="line">$ sudo ip link <span class="built_in">set</span> dev bridge0 up</span><br></pre></td></tr></table></figure>

<p>查看确认网桥创建并启动。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ ip addr show bridge0</span><br><span class="line">4: bridge0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state UP group default</span><br><span class="line">    link/ether 66:38:d0:0d:76:18 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.5.1/24 scope global bridge0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure>

<p>在 Docker 配置文件 <code>/etc/docker/daemon.json</code> 中添加如下内容，即可将 Docker 默认桥接到创建的网桥上。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;bridge&quot;</span>: <span class="string">&quot;bridge0&quot;</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动 Docker 服务。</p>
<h4 id="工具和实例"><a href="#工具和实例" class="headerlink" title="工具和实例"></a>工具和实例</h4><p>在介绍自定义网络拓扑之前，你可能会对一些外部工具和例子感兴趣：</p>
<h5 id="pipework"><a href="#pipework" class="headerlink" title="pipework"></a>pipework</h5><p>Jérôme Petazzoni 编写了一个叫 <a target="_blank" rel="noopener" href="https://github.com/jpetazzo/pipework">pipework</a> 的 shell 脚本，可以帮助用户在比较复杂的场景中完成容器的连接。</p>
<h5 id="playground"><a href="#playground" class="headerlink" title="playground"></a>playground</h5><p>Brandon Rhodes 创建了一个提供完整的 Docker 容器网络拓扑管理的 <a target="_blank" rel="noopener" href="https://github.com/brandon-rhodes/fopnp/tree/m/playground">Python库</a>，包括路由、NAT 防火墙；以及一些提供 <code>HTTP</code> <code>SMTP</code> <code>POP</code> <code>IMAP</code> <code>Telnet</code> <code>SSH</code> <code>FTP</code> 的服务器。</p>
<h4 id="编辑网络配置文件"><a href="#编辑网络配置文件" class="headerlink" title="编辑网络配置文件"></a>编辑网络配置文件</h4><p>Docker 1.2.0 开始支持在运行中的容器里编辑 <code>/etc/hosts</code>, <code>/etc/hostname</code> 和 <code>/etc/resolv.conf</code> 文件。</p>
<p>但是这些修改是临时的，只在运行的容器中保留，容器终止或重启后并不会被保存下来，也不会被 <code>docker commit</code> 提交。</p>
<h4 id="示例：创建一个点到点连接"><a href="#示例：创建一个点到点连接" class="headerlink" title="示例：创建一个点到点连接"></a>示例：创建一个点到点连接</h4><p>默认情况下，Docker 会将所有容器连接到由 <code>docker0</code> 提供的虚拟子网中。</p>
<p>用户有时候需要两个容器之间可以直连通信，而不用通过主机网桥进行桥接。</p>
<p>解决办法很简单：创建一对 <code>peer</code> 接口，分别放到两个容器中，配置成点到点链路类型即可。</p>
<p>首先启动 2 个容器：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -i -t --rm --net=none base /bin/bash</span><br><span class="line">root@1f1f4c1f931a:/<span class="comment">#</span></span><br><span class="line">$ docker run -i -t --rm --net=none base /bin/bash</span><br><span class="line">root@12e343489d2f:/<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>找到进程号，然后创建网络命名空间的跟踪文件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ docker inspect -f <span class="string">&#x27;&#123;&#123;.State.Pid&#125;&#125;&#x27;</span> 1f1f4c1f931a</span><br><span class="line">2989</span><br><span class="line">$ docker inspect -f <span class="string">&#x27;&#123;&#123;.State.Pid&#125;&#125;&#x27;</span> 12e343489d2f</span><br><span class="line">3004</span><br><span class="line">$ sudo mkdir -p /var/run/netns</span><br><span class="line">$ sudo ln -s /proc/2989/ns/net /var/run/netns/2989</span><br><span class="line">$ sudo ln -s /proc/3004/ns/net /var/run/netns/3004</span><br></pre></td></tr></table></figure>

<p>创建一对 <code>peer</code> 接口，然后配置路由</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo ip link add A <span class="built_in">type</span> veth peer name B</span><br><span class="line"></span><br><span class="line">$ sudo ip link <span class="built_in">set</span> A netns 2989</span><br><span class="line">$ sudo ip netns <span class="built_in">exec</span> 2989 ip addr add 10.1.1.1/32 dev A</span><br><span class="line">$ sudo ip netns <span class="built_in">exec</span> 2989 ip link <span class="built_in">set</span> A up</span><br><span class="line">$ sudo ip netns <span class="built_in">exec</span> 2989 ip route add 10.1.1.2/32 dev A</span><br><span class="line"></span><br><span class="line">$ sudo ip link <span class="built_in">set</span> B netns 3004</span><br><span class="line">$ sudo ip netns <span class="built_in">exec</span> 3004 ip addr add 10.1.1.2/32 dev B</span><br><span class="line">$ sudo ip netns <span class="built_in">exec</span> 3004 ip link <span class="built_in">set</span> B up</span><br><span class="line">$ sudo ip netns <span class="built_in">exec</span> 3004 ip route add 10.1.1.1/32 dev B</span><br></pre></td></tr></table></figure>

<p>现在这 2 个容器就可以相互 ping 通，并成功建立连接。点到点链路不需要子网和子网掩码。</p>
<p>此外，也可以不指定 <code>--net=none</code> 来创建点到点链路。这样容器还可以通过原先的网络来通信。</p>
<p>利用类似的办法，可以创建一个只跟主机通信的容器。但是一般情况下，更推荐使用 <code>--icc=false</code> 来关闭容器之间的通信。</p>
<h3 id="Docker-Buildx"><a href="#Docker-Buildx" class="headerlink" title="Docker Buildx"></a>Docker Buildx</h3><h4 id="BuildKit"><a href="#BuildKit" class="headerlink" title="BuildKit"></a>BuildKit</h4><h4 id="使用buildx构建镜像"><a href="#使用buildx构建镜像" class="headerlink" title="使用buildx构建镜像"></a>使用buildx构建镜像</h4><h4 id="使用buildx构建多种系统架构支持的Docker镜像"><a href="#使用buildx构建多种系统架构支持的Docker镜像" class="headerlink" title="使用buildx构建多种系统架构支持的Docker镜像"></a>使用buildx构建多种系统架构支持的Docker镜像</h4><h3 id="Docker-Compose-1"><a href="#Docker-Compose-1" class="headerlink" title="Docker Compose"></a>Docker Compose</h3><p><code>Compose</code>允许用户通过一个单独的 <code>docker-compose.yml</code> 模板文件（YAML 格式）来定义一组相关联的应用容器为一个项目（project）。</p>
<p><code>Compose</code> 中有两个重要的概念：</p>
<ul>
<li>服务 (<code>service</code>)：一个应用的容器，实际上可以包括若干运行相同镜像的容器实例。</li>
<li>项目 (<code>project</code>)：由一组关联的应用容器组成的一个完整业务单元，在 <code>docker-compose.yml</code> 文件中定义。</li>
</ul>
<p><code>Compose</code> 的默认管理对象是项目，通过子命令对项目中的一组容器进行便捷地生命周期管理。</p>
<p><code>Compose</code> 项目由 Python 编写，实现上调用了 Docker 服务提供的 API 来对容器进行管理。因此，只要所操作的平台支持 Docker API，就可以在其上利用 <code>Compose</code> 来进行编排管理。</p>
<h4 id="安装与卸载"><a href="#安装与卸载" class="headerlink" title="安装与卸载"></a>安装与卸载</h4><h5 id="Windows-mac-os"><a href="#Windows-mac-os" class="headerlink" title="Windows/mac os"></a>Windows/mac os</h5><p><code>Docker Desktop for Mac/Windows</code> 自带 <code>docker-compose</code> 二进制文件，安装 Docker 之后可以直接使用。</p>
<p>Linux (x86)</p>
<p>从 <a target="_blank" rel="noopener" href="https://github.com/docker/compose/releases">官方 GitHub Release</a> 处直接下载编译好的二进制文件即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo curl -L https://github.com/docker/compose/releases/download/1.24.1/docker-compose-`uname -s`-`uname -m` &gt; /usr/<span class="built_in">local</span>/bin/docker-compose</span><br><span class="line"></span><br><span class="line">$ sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>

<h5 id="Linux-ARM"><a href="#Linux-ARM" class="headerlink" title="Linux(ARM)"></a>Linux(ARM)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pip install -U docker-compose</span><br></pre></td></tr></table></figure>

<h5 id="bash补全命令"><a href="#bash补全命令" class="headerlink" title="bash补全命令"></a>bash补全命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -L https://raw.githubusercontent.com/docker/compose/1.24.1/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span><br></pre></td></tr></table></figure>

<h5 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h5><p>二进制包方式安装的，删除二进制文件即可。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo rm /usr/<span class="built_in">local</span>/bin/docker-compose</span><br></pre></td></tr></table></figure>

<p>通过 <code>pip</code> 安装的，则执行如下命令即可删除。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo pip uninstall docker-compose</span><br></pre></td></tr></table></figure>

<h4 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h4><p>编写 <code>docker-compose.yml</code> 文件，这个是 Compose 使用的主模板文件。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;redis:alpine&quot;</span></span><br></pre></td></tr></table></figure>

<p>运行 compose 项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose up</span><br></pre></td></tr></table></figure>

<h4 id="Compose命令说明"><a href="#Compose命令说明" class="headerlink" title="Compose命令说明"></a>Compose命令说明</h4><p><code>docker-compose</code> 命令的基本的使用格式是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose [-f=&lt;arg&gt;...] [options] [COMMAND] [ARGS...]</span><br></pre></td></tr></table></figure>

<ul>
<li><code>-f, --file FILE</code> 指定使用的 Compose 模板文件，默认为 <code>docker-compose.yml</code>，可以多次指定。</li>
<li><code>-p, --project-name NAME</code> 指定项目名称，默认将使用所在目录名称作为项目名。</li>
<li><code>--x-networking</code> 使用 Docker 的可拔插网络后端特性</li>
<li><code>--x-network-driver DRIVER</code> 指定网络后端的驱动，默认为 <code>bridge</code></li>
<li><code>--verbose</code> 输出更多调试信息。</li>
<li><code>-v, --version</code> 打印版本并退出。</li>
</ul>
<h5 id="build"><a href="#build" class="headerlink" title="build"></a>build</h5><p>格式为 <code>docker-compose build [options] [SERVICE...]</code>。</p>
<p>构建（重新构建）项目中的服务容器。</p>
<p>服务容器一旦构建后，将会带上一个标记名，例如对于 web 项目中的一个 db 容器，可能是 web_db。</p>
<p>可以随时在项目目录下运行 <code>docker-compose build</code> 来重新构建服务。</p>
<p>选项包括：</p>
<ul>
<li><code>--force-rm</code> 删除构建过程中的临时容器。</li>
<li><code>--no-cache</code> 构建镜像过程中不使用 cache（这将加长构建过程）。</li>
<li><code>--pull</code> 始终尝试通过 pull 来获取更新版本的镜像。</li>
</ul>
<h5 id="config"><a href="#config" class="headerlink" title="config"></a>config</h5><p>验证 Compose 文件格式是否正确，若正确则显示配置，若格式错误显示错误原因。</p>
<h5 id="down"><a href="#down" class="headerlink" title="down"></a>down</h5><p>此命令将会停止 <code>up</code> 命令所启动的容器，并移除网络</p>
<h5 id="exec-1"><a href="#exec-1" class="headerlink" title="exec"></a>exec</h5><p>进入指定的容器。</p>
<h5 id="help"><a href="#help" class="headerlink" title="help"></a>help</h5><p>获得一个命令的帮助。</p>
<h5 id="images"><a href="#images" class="headerlink" title="images"></a>images</h5><p>列出 Compose 文件中包含的镜像。</p>
<h5 id="kill"><a href="#kill" class="headerlink" title="kill"></a>kill</h5><p>格式为 <code>docker-compose kill [options] [SERVICE...]</code>。</p>
<p>通过发送 <code>SIGKILL</code> 信号来强制停止服务容器。</p>
<p>支持通过 <code>-s</code> 参数来指定发送的信号，例如通过如下指令发送 <code>SIGINT</code> 信号。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose <span class="built_in">kill</span> -s SIGINT</span><br></pre></td></tr></table></figure>

<h5 id="logs"><a href="#logs" class="headerlink" title="logs"></a>logs</h5><p>格式为 <code>docker-compose logs [options] [SERVICE...]</code>。</p>
<p>查看服务容器的输出。默认情况下，docker-compose 将对不同的服务输出使用不同的颜色来区分。可以通过 <code>--no-color</code> 来关闭颜色。</p>
<h5 id="pause"><a href="#pause" class="headerlink" title="pause"></a>pause</h5><p>格式为 <code>docker-compose pause [SERVICE...]</code>。</p>
<p>暂停一个服务容器。</p>
<h5 id="port"><a href="#port" class="headerlink" title="port"></a>port</h5><p>格式为 <code>docker-compose port [options] SERVICE PRIVATE_PORT</code>。</p>
<p>打印某个容器端口所映射的公共端口。</p>
<p>选项：</p>
<ul>
<li><code>--protocol=proto</code> 指定端口协议，tcp（默认值）或者 udp。</li>
<li><code>--index=index</code> 如果同一服务存在多个容器，指定命令对象容器的序号（默认为 1）。</li>
</ul>
<h5 id="ps"><a href="#ps" class="headerlink" title="ps"></a>ps</h5><p>格式为 <code>docker-compose ps [options] [SERVICE...]</code>。</p>
<p>列出项目中目前的所有容器。</p>
<p>选项：</p>
<ul>
<li><code>-q</code> 只打印容器的 ID 信息。</li>
</ul>
<h5 id="pull"><a href="#pull" class="headerlink" title="pull"></a>pull</h5><p>格式为 <code>docker-compose pull [options] [SERVICE...]</code>。</p>
<p>拉取服务依赖的镜像。</p>
<p>选项：</p>
<ul>
<li><code>--ignore-pull-failures</code> 忽略拉取镜像过程中的错误。</li>
</ul>
<h5 id="push"><a href="#push" class="headerlink" title="push"></a>push</h5><p>推送服务依赖的镜像到 Docker 镜像仓库。</p>
<h5 id="restart"><a href="#restart" class="headerlink" title="restart"></a>restart</h5><p>格式为 <code>docker-compose restart [options] [SERVICE...]</code>。</p>
<p>重启项目中的服务。</p>
<p>选项：</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> 指定重启前停止容器的超时（默认为 10 秒）。</li>
</ul>
<h5 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h5><p>格式为 <code>docker-compose rm [options] [SERVICE...]</code>。</p>
<p>删除所有（停止状态的）服务容器。推荐先执行 <code>docker-compose stop</code> 命令来停止容器。</p>
<p>选项：</p>
<ul>
<li><code>-f, --force</code> 强制直接删除，包括非停止状态的容器。一般尽量不要使用该选项。</li>
<li><code>-v</code> 删除容器所挂载的数据卷。</li>
</ul>
<h5 id="run"><a href="#run" class="headerlink" title="run"></a>run</h5><p>格式为 <code>docker-compose run [options] [-p PORT...] [-e KEY=VAL...] SERVICE [COMMAND] [ARGS...]</code>。</p>
<p>在指定服务上执行一个命令。</p>
<p>例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose run ubuntu ping docker.com</span><br></pre></td></tr></table></figure>

<p>默认情况下，如果存在关联，则所有关联的服务将会自动被启动，除非这些服务已经在运行中。</p>
<p>该命令类似启动容器后运行指定的命令，相关卷、链接等等都将会按照配置自动创建。</p>
<p>两个不同点：</p>
<ul>
<li>给定命令将会覆盖原有的自动运行命令；</li>
<li>不会自动创建端口，以避免冲突。</li>
</ul>
<p>如果不希望自动启动关联的容器，可以使用 <code>--no-deps</code> 选项，例如</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose run --no-deps web python manage.py shell</span><br></pre></td></tr></table></figure>

<p>将不会启动 web 容器所关联的其它容器。</p>
<p>选项：</p>
<ul>
<li><code>-d</code> 后台运行容器。</li>
<li><code>--name NAME</code> 为容器指定一个名字。</li>
<li><code>--entrypoint CMD</code> 覆盖默认的容器启动指令。</li>
<li><code>-e KEY=VAL</code> 设置环境变量值，可多次使用选项来设置多个环境变量。</li>
<li><code>-u, --user=&quot;&quot;</code> 指定运行容器的用户名或者 uid。</li>
<li><code>--no-deps</code> 不自动启动关联的服务容器。</li>
<li><code>--rm</code> 运行命令后自动删除容器，<code>d</code> 模式下将忽略。</li>
<li><code>-p, --publish=[]</code> 映射容器端口到本地主机。</li>
<li><code>--service-ports</code> 配置服务端口并映射到本地主机。</li>
<li><code>-T</code> 不分配伪 tty，意味着依赖 tty 的指令将无法运行。</li>
</ul>
<h5 id="scale"><a href="#scale" class="headerlink" title="scale"></a>scale</h5><p>格式为 <code>docker-compose scale [options] [SERVICE=NUM...]</code>。</p>
<p>设置指定服务运行的容器个数。</p>
<p>通过 <code>service=num</code> 的参数来设置数量。例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-compose scale web=3 db=2</span><br></pre></td></tr></table></figure>

<p>将启动 3 个容器运行 web 服务，2 个容器运行 db 服务。</p>
<p>一般的，当指定数目多于该服务当前实际运行容器，将新创建并启动容器；反之，将停止容器。</p>
<p>选项：</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> 停止容器时候的超时（默认为 10 秒）。</li>
</ul>
<h5 id="start"><a href="#start" class="headerlink" title="start"></a>start</h5><p>格式为 <code>docker-compose start [SERVICE...]</code>。</p>
<p>启动已经存在的服务容器。</p>
<h5 id="stop"><a href="#stop" class="headerlink" title="stop"></a>stop</h5><p>格式为 <code>docker-compose stop [options] [SERVICE...]</code>。</p>
<p>停止已经处于运行状态的容器，但不删除它。通过 <code>docker-compose start</code> 可以再次启动这些容器。</p>
<p>选项：</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> 停止容器时候的超时（默认为 10 秒）。</li>
</ul>
<h5 id="top"><a href="#top" class="headerlink" title="top"></a>top</h5><p>查看各个服务容器内运行的进程。</p>
<h5 id="unpause"><a href="#unpause" class="headerlink" title="unpause"></a>unpause</h5><p>格式为 <code>docker-compose unpause [SERVICE...]</code>。</p>
<p>恢复处于暂停状态中的服务。</p>
<h5 id="up"><a href="#up" class="headerlink" title="up"></a>up</h5><p>格式为 <code>docker-compose up [options] [SERVICE...]</code>。</p>
<p>该命令十分强大，它将尝试自动完成包括构建镜像，（重新）创建服务，启动服务，并关联服务相关容器的一系列操作。</p>
<p>链接的服务都将会被自动启动，除非已经处于运行状态。</p>
<p>可以说，大部分时候都可以直接通过该命令来启动一个项目。</p>
<p>默认情况，<code>docker-compose up</code> 启动的容器都在前台，控制台将会同时打印所有容器的输出信息，可以很方便进行调试。</p>
<p>当通过 <code>Ctrl-C</code> 停止命令时，所有容器将会停止。</p>
<p>如果使用 <code>docker-compose up -d</code>，将会在后台启动并运行所有的容器。一般推荐生产环境下使用该选项。</p>
<p>默认情况，如果服务容器已经存在，<code>docker-compose up</code> 将会尝试停止容器，然后重新创建（保持使用 <code>volumes-from</code> 挂载的卷），以保证新启动的服务匹配 <code>docker-compose.yml</code> 文件的最新内容。如果用户不希望容器被停止并重新创建，可以使用 <code>docker-compose up --no-recreate</code>。这样将只会启动处于停止状态的容器，而忽略已经运行的服务。如果用户只想重新部署某个服务，可以使用 <code>docker-compose up --no-deps -d </code> 来重新创建服务并后台停止旧服务，启动新服务，并不会影响到其所依赖的服务。</p>
<p>选项：</p>
<ul>
<li><code>-d</code> 在后台运行服务容器。</li>
<li><code>--no-color</code> 不使用颜色来区分不同的服务的控制台输出。</li>
<li><code>--no-deps</code> 不启动服务所链接的容器。</li>
<li><code>--force-recreate</code> 强制重新创建容器，不能与 <code>--no-recreate</code> 同时使用。</li>
<li><code>--no-recreate</code> 如果容器已经存在了，则不重新创建，不能与 <code>--force-recreate</code> 同时使用。</li>
<li><code>--no-build</code> 不自动构建缺失的服务镜像。</li>
<li><code>-t, --timeout TIMEOUT</code> 停止容器时候的超时（默认为 10 秒）。</li>
</ul>
<h5 id="version"><a href="#version" class="headerlink" title="version"></a>version</h5><p>格式为 <code>docker-compose version</code>。</p>
<p>打印版本信息。</p>
<h4 id="Compose-模板文件"><a href="#Compose-模板文件" class="headerlink" title="Compose 模板文件"></a>Compose 模板文件</h4><p>模板文件是使用 <code>Compose</code> 的核心，涉及到的指令关键字也比较多。但大家不用担心，这里面大部分指令跟 <code>docker run</code> 相关参数的含义都是类似的。</p>
<p>默认的模板文件名称为 <code>docker-compose.yml</code>，格式为 YAML 格式。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">webapp:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">examples/web</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;/data&quot;</span></span><br></pre></td></tr></table></figure>

<p>注意每个服务都必须通过 <code>image</code> 指令指定镜像或 <code>build</code> 指令（需要 Dockerfile）等来自动构建生成镜像。</p>
<p>如果使用 <code>build</code> 指令，在 <code>Dockerfile</code> 中设置的选项(例如：<code>CMD</code>, <code>EXPOSE</code>, <code>VOLUME</code>, <code>ENV</code> 等) 将会自动被获取，无需在 <code>docker-compose.yml</code> 中重复设置。</p>
<h5 id="build-1"><a href="#build-1" class="headerlink" title="build"></a><code>build</code></h5><p>指定 <code>Dockerfile</code> 所在文件夹的路径（可以是绝对路径，或者相对 docker-compose.yml 文件的路径）。 <code>Compose</code> 将会利用它自动构建这个镜像，然后使用这个镜像。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">webapp:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">./dir</span></span><br></pre></td></tr></table></figure>

<p>也可以使用 <code>context</code> 指令指定 <code>Dockerfile</code> 所在文件夹的路径，使用 <code>dockerfile</code> 指令指定 <code>Dockerfile</code> 文件名。</p>
<p>使用 <code>arg</code> 指令指定构建镜像时的变量。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">webapp:</span></span><br><span class="line">    <span class="attr">build:</span></span><br><span class="line">      <span class="attr">context:</span> <span class="string">./dir</span></span><br><span class="line">      <span class="attr">dockerfile:</span> <span class="string">Dockerfile-alternate</span></span><br><span class="line">      <span class="attr">args:</span></span><br><span class="line">        <span class="attr">buildno:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>使用 <code>cache_from</code> 指定构建镜像的缓存</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">build:</span></span><br><span class="line">  <span class="attr">context:</span> <span class="string">.</span></span><br><span class="line">  <span class="attr">cache_from:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">alpine:latest</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">corp/web_app:3.14</span></span><br></pre></td></tr></table></figure>

<h5 id="cap-add-cap-drop"><a href="#cap-add-cap-drop" class="headerlink" title="cap_add, cap_drop"></a><code>cap_add, cap_drop</code></h5><p>指定容器的内核能力（capacity）分配。</p>
<p>例如，让容器拥有所有能力可以指定为：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cap_add:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">ALL</span></span><br></pre></td></tr></table></figure>

<p>去掉 NET_ADMIN 能力可以指定为：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cap_drop:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">NET_ADMIN</span></span><br></pre></td></tr></table></figure>

<h5 id="command"><a href="#command" class="headerlink" title="command"></a><code>command</code></h5><p>覆盖容器启动后默认执行的命令。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">command:</span> <span class="string">echo</span> <span class="string">&quot;hello world&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="configs"><a href="#configs" class="headerlink" title="configs"></a><code>configs</code></h5><p>仅用于 <code>Swarm mode</code>，详细内容请查看 <code>Swarm mode</code>一节。（经验证，docker-compose中无法使用）</p>
<h5 id="cgroup-parent"><a href="#cgroup-parent" class="headerlink" title="cgroup_parent"></a><code>cgroup_parent</code></h5><p>指定父 <code>cgroup</code> 组，意味着将继承该组的资源限制。</p>
<p>例如，创建了一个 cgroup 组名称为 <code>cgroups_1</code>。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">cgroup_parent:</span> <span class="string">cgroups_1</span></span><br></pre></td></tr></table></figure>

<h5 id="container-name"><a href="#container-name" class="headerlink" title="container_name"></a><code>container_name</code></h5><p>指定容器名称。默认将会使用 <code>项目名称_服务名称_序号</code> 这样的格式。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">container_name:</span> <span class="string">docker-web-container</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意: 指定容器名称后，该服务将无法进行扩展（scale），因为 Docker 不允许多个容器具有相同的名称。</p>
</blockquote>
<h5 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a><code>deploy</code></h5><p>仅用于 <code>Swarm mode</code>，详细内容请查看 <code>Swarm mode</code> 一节</p>
<h5 id="devices"><a href="#devices" class="headerlink" title="devices"></a><code>devices</code></h5><p>指定设备映射关系。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devices:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">&quot;/dev/ttyUSB1:/dev/ttyUSB0&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="depends-on"><a href="#depends-on" class="headerlink" title="depends_on"></a><code>depends_on</code></h5><p>解决容器的依赖、启动先后的问题。以下例子中会先启动 <code>redis</code> <code>db</code> 再启动 <code>web</code></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">redis</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">redis</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">postgres</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意：<code>web</code> 服务不会等待 <code>redis</code> <code>db</code> 「完全启动」之后才启动。</p>
</blockquote>
<h5 id="dns"><a href="#dns" class="headerlink" title="dns"></a><code>dns</code></h5><p>自定义 <code>DNS</code> 服务器。可以是一个值，也可以是一个列表。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dns:</span> <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dns:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">114.114</span><span class="number">.114</span><span class="number">.114</span></span><br></pre></td></tr></table></figure>

<h5 id="dns-search"><a href="#dns-search" class="headerlink" title="dns_search"></a><code>dns_search</code></h5><p>配置 <code>DNS</code> 搜索域。可以是一个值，也可以是一个列表。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">dns_search:</span> <span class="string">example.com</span></span><br><span class="line"></span><br><span class="line"><span class="attr">dns_search:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">domain1.example.com</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">domain2.example.com</span></span><br></pre></td></tr></table></figure>

<h5 id="tmpfs"><a href="#tmpfs" class="headerlink" title="tmpfs"></a><code>tmpfs</code></h5><p>挂载一个 tmpfs 文件系统到容器。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tmpfs:</span> <span class="string">/run</span></span><br><span class="line"><span class="attr">tmpfs:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">/run</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">/tmp</span></span><br></pre></td></tr></table></figure>

<h5 id="env-file"><a href="#env-file" class="headerlink" title="env_file"></a><code>env_file</code></h5><p>从文件中获取环境变量，可以为单独的文件路径或列表。</p>
<p>如果通过 <code>docker-compose -f FILE</code> 方式来指定 Compose 模板文件，则 <code>env_file</code> 中变量的路径会基于模板文件路径。</p>
<p>如果有变量名称与 <code>environment</code> 指令冲突，则按照惯例，以后者为准。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">env_file: .env</span><br><span class="line"></span><br><span class="line">env_file:</span><br><span class="line">  - ./common.env</span><br><span class="line">  - ./apps/web.env</span><br><span class="line">  - /opt/secrets.env</span><br></pre></td></tr></table></figure>

<p>环境变量文件中每一行必须符合格式，支持 <code>#</code> 开头的注释行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># common.env: Set development environment</span></span><br><span class="line">PROG_ENV=development</span><br></pre></td></tr></table></figure>

<h5 id="environment"><a href="#environment" class="headerlink" title="environment"></a><code>environment</code></h5><p>设置环境变量。你可以使用数组或字典两种格式。</p>
<p>只给定名称的变量会自动获取运行 Compose 主机上对应变量的值，可以用来防止泄露不必要的数据。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">environment:</span></span><br><span class="line">  <span class="attr">RACK_ENV:</span> <span class="string">development</span></span><br><span class="line">  <span class="attr">SESSION_SECRET:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">environment:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">RACK_ENV=development</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">SESSION_SECRET</span></span><br></pre></td></tr></table></figure>

<p>如果变量名称或者值中用到 <code>true|false，yes|no</code> 等表达 <a target="_blank" rel="noopener" href="https://yaml.org/type/bool.html">布尔</a> 含义的词汇，最好放到引号里，避免 YAML 自动解析某些内容为对应的布尔语义。这些特定词汇，包括</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y|Y|yes|Yes|YES|n|N|no|No|NO|<span class="literal">true</span>|True|TRUE|<span class="literal">false</span>|False|FALSE|on|On|ON|off|Off|OFF</span><br></pre></td></tr></table></figure>

<h5 id="expose"><a href="#expose" class="headerlink" title="expose"></a><code>expose</code></h5><p>暴露端口，但不映射到宿主机，只被连接的服务访问。</p>
<p>仅可以指定内部端口为参数</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">expose:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;3000&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;8000&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="external-links"><a href="#external-links" class="headerlink" title="external_links"></a><code>external_links</code></h5><blockquote>
<p>注意：不建议使用该指令。</p>
</blockquote>
<p>链接到 <code>docker-compose.yml</code> 外部的容器，甚至并非 <code>Compose</code> 管理的外部容器。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">external_links:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">redis_1</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">project_db_1:mysql</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">project_db_1:postgresql</span></span><br></pre></td></tr></table></figure>

<h5 id="extra-hosts"><a href="#extra-hosts" class="headerlink" title="extra_hosts"></a><code>extra_hosts</code></h5><p>类似 Docker 中的 <code>--add-host</code> 参数，指定额外的 host 名称映射信息。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">extra_hosts:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;googledns:8.8.8.8&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;dockerhub:52.1.157.61&quot;</span></span><br></pre></td></tr></table></figure>

<p>会在启动后的服务容器中 <code>/etc/hosts</code> 文件中添加如下两条条目。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">8.8.8.8 googledns</span><br><span class="line">52.1.157.61 dockerhub</span><br></pre></td></tr></table></figure>

<h5 id="healthcheck"><a href="#healthcheck" class="headerlink" title="healthcheck"></a><code>healthcheck</code></h5><p>通过命令检查容器是否健康运行。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">healthcheck:</span></span><br><span class="line">  <span class="attr">test:</span> [<span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;curl&quot;</span>, <span class="string">&quot;-f&quot;</span>, <span class="string">&quot;http://localhost&quot;</span>]</span><br><span class="line">  <span class="attr">interval:</span> <span class="string">1m30s</span></span><br><span class="line">  <span class="attr">timeout:</span> <span class="string">10s</span></span><br><span class="line">  <span class="attr">retries:</span> <span class="number">3</span></span><br></pre></td></tr></table></figure>

<h5 id="image"><a href="#image" class="headerlink" title="image"></a><code>image</code></h5><p>指定为镜像名称或镜像 ID。如果镜像在本地不存在，<code>Compose</code> 将会尝试拉取这个镜像。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">image:</span> <span class="string">ubuntu</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">orchardup/postgresql</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">a4bc65fd</span></span><br></pre></td></tr></table></figure>

<h5 id="labels"><a href="#labels" class="headerlink" title="labels"></a><code>labels</code></h5><p>为容器添加 Docker 元数据（metadata）信息。例如可以为容器添加辅助说明信息。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">labels:</span></span><br><span class="line">  <span class="attr">com.startupteam.description:</span> <span class="string">&quot;webapp for a startup team&quot;</span></span><br><span class="line">  <span class="attr">com.startupteam.department:</span> <span class="string">&quot;devops department&quot;</span></span><br><span class="line">  <span class="attr">com.startupteam.release:</span> <span class="string">&quot;rc3 for v1.0&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="links"><a href="#links" class="headerlink" title="links"></a><code>links</code></h5><p>注意：不推荐使用该指令。</p>
<h5 id="logging"><a href="#logging" class="headerlink" title="logging"></a><code>logging</code></h5><p>配置日志选项。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">driver:</span> <span class="string">syslog</span></span><br><span class="line">  <span class="attr">options:</span></span><br><span class="line">    <span class="attr">syslog-address:</span> <span class="string">&quot;tcp://192.168.0.42:123&quot;</span></span><br></pre></td></tr></table></figure>

<p>目前支持三种日志驱动类型。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">driver:</span> <span class="string">&quot;json-file&quot;</span></span><br><span class="line"><span class="attr">driver:</span> <span class="string">&quot;syslog&quot;</span></span><br><span class="line"><span class="attr">driver:</span> <span class="string">&quot;none&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>options</code> 配置日志驱动的相关参数。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">options:</span></span><br><span class="line">  <span class="attr">max-size:</span> <span class="string">&quot;200k&quot;</span></span><br><span class="line">  <span class="attr">max-file:</span> <span class="string">&quot;10&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="network-mode"><a href="#network-mode" class="headerlink" title="network_mode"></a><code>network_mode</code></h5><p>设置网络模式。使用和 <code>docker run</code> 的 <code>--network</code> 参数一样的值。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">network_mode:</span> <span class="string">&quot;bridge&quot;</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">&quot;host&quot;</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">&quot;none&quot;</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">&quot;service:[service name]&quot;</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">&quot;container:[container name/id]&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="networks"><a href="#networks" class="headerlink" title="networks"></a><code>networks</code></h5><p>配置容器连接的网络。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">some-service:</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">some-network</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">other-network</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">some-network:</span></span><br><span class="line">  <span class="attr">other-network:</span></span><br></pre></td></tr></table></figure>

<h5 id="pid"><a href="#pid" class="headerlink" title="pid"></a><code>pid</code></h5><p>跟主机系统共享进程命名空间。打开该选项的容器之间，以及容器和宿主机系统之间可以通过进程 ID 来相互访问和操作。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">pid:</span> <span class="string">&quot;host&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="ports"><a href="#ports" class="headerlink" title="ports"></a><code>ports</code></h5><p>暴露端口信息。</p>
<p>使用宿主端口：容器端口 <code>(HOST:CONTAINER)</code> 格式，或者仅仅指定容器的端口（宿主将会随机选择端口）都可以。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ports:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;3000&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;49100:22&quot;</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">&quot;127.0.0.1:8001:8001&quot;</span></span><br></pre></td></tr></table></figure>

<p><em>注意：当使用 <code>HOST:CONTAINER</code> 格式来映射端口时，如果你使用的容器端口小于 60 并且没放到引号里，可能会得到错误结果，因为 <code>YAML</code> 会自动解析 <code>xx:yy</code> 这种数字格式为 60 进制。为避免出现这种问题，建议数字串都采用引号包括起来的字符串格式。</em></p>
<h5 id="secrets"><a href="#secrets" class="headerlink" title="secrets"></a><code>secrets</code></h5><p>存储敏感数据，例如 <code>mysql</code> 服务密码。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.1&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mysql:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">environment:</span></span><br><span class="line">    <span class="attr">MYSQL_ROOT_PASSWORD_FILE:</span> <span class="string">/run/secrets/db_root_password</span></span><br><span class="line">  <span class="attr">secrets:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">db_root_password</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">my_other_secret</span></span><br><span class="line"></span><br><span class="line"><span class="attr">secrets:</span></span><br><span class="line">  <span class="attr">my_secret:</span></span><br><span class="line">    <span class="attr">file:</span> <span class="string">./my_secret.txt</span></span><br><span class="line">  <span class="attr">my_other_secret:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h5 id="security-opt"><a href="#security-opt" class="headerlink" title="security_opt"></a><code>security_opt</code></h5><p>指定容器模板标签（label）机制的默认属性（用户、角色、类型、级别等）。例如配置标签的用户名和角色名。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">security_opt:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">label:user:USER</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">label:role:ROLE</span></span><br></pre></td></tr></table></figure>

<h5 id="stop-signal"><a href="#stop-signal" class="headerlink" title="stop_signal"></a><code>stop_signal</code></h5><p>设置另一个信号来停止容器。在默认情况下使用的是 SIGTERM 停止容器。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stop_signal:</span> <span class="string">SIGUSR1</span></span><br></pre></td></tr></table></figure>

<h5 id="sysctls"><a href="#sysctls" class="headerlink" title="sysctls"></a><code>sysctls</code></h5><p>配置容器内核参数。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">sysctls:</span></span><br><span class="line">  <span class="attr">net.core.somaxconn:</span> <span class="number">1024</span></span><br><span class="line">  <span class="attr">net.ipv4.tcp_syncookies:</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">sysctls:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">net.core.somaxconn=1024</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">net.ipv4.tcp_syncookies=0</span></span><br></pre></td></tr></table></figure>

<h5 id="ulimits"><a href="#ulimits" class="headerlink" title="ulimits"></a><code>ulimits</code></h5><p>指定容器的 ulimits 限制值。</p>
<p>例如，指定最大进程数为 65535，指定文件句柄数为 20000（软限制，应用可以随时修改，不能超过硬限制） 和 40000（系统硬限制，只能 root 用户提高）。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ulimits:</span></span><br><span class="line">  <span class="attr">nproc:</span> <span class="number">65535</span></span><br><span class="line">  <span class="attr">nofile:</span></span><br><span class="line">    <span class="attr">soft:</span> <span class="number">20000</span></span><br><span class="line">    <span class="attr">hard:</span> <span class="number">40000</span></span><br></pre></td></tr></table></figure>

<h5 id="volumes"><a href="#volumes" class="headerlink" title="volumes"></a><code>volumes</code></h5><p>数据卷所挂载路径设置。可以设置为宿主机路径(<code>HOST:CONTAINER</code>)或者数据卷名称(<code>VOLUME:CONTAINER</code>)，并且可以设置访问模式 （<code>HOST:CONTAINER:ro</code>）。</p>
<p>该指令中路径支持相对路径。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">volumes:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">/var/lib/mysql</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">cache/:/tmp/cache</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">~/configs:/etc/configs/:ro</span></span><br></pre></td></tr></table></figure>

<p>如果路径为数据卷名称，必须在文件中配置数据卷。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">my_src:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_data:/var/lib/mysql</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">mysql_data:</span></span><br></pre></td></tr></table></figure>

<p>如果路径为数据卷名称，必须在文件中配置数据卷。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">my_src:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:8.0</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mysql_data:/var/lib/mysql</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">mysql_data:</span></span><br></pre></td></tr></table></figure>

<h5 id="其他指令"><a href="#其他指令" class="headerlink" title="其他指令"></a>其他指令</h5><p>指定服务容器启动后执行的入口文件。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">entrypoint:</span> <span class="string">/code/entrypoint.sh</span></span><br></pre></td></tr></table></figure>

<p>指定容器中运行应用的用户名。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">user:</span> <span class="string">nginx</span></span><br></pre></td></tr></table></figure>

<p>指定容器中工作目录。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">working_dir:</span> <span class="string">/code</span></span><br></pre></td></tr></table></figure>

<p>指定容器中搜索域名、主机名、mac 地址等。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">domainname:</span> <span class="string">your_website.com</span></span><br><span class="line"><span class="attr">hostname:</span> <span class="string">test</span></span><br><span class="line"><span class="attr">mac_address:</span> <span class="number">08</span><span class="number">-00</span><span class="number">-27</span><span class="number">-00</span><span class="string">-0C-0A</span></span><br></pre></td></tr></table></figure>

<p>允许容器中运行一些特权命令。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">privileged:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>指定容器退出后的重启策略为始终重启。该命令对保持服务始终运行十分有效，在生产环境中推荐配置为 <code>always</code> 或者 <code>unless-stopped</code>。</p>
<p>**这条指令十分有效，困扰了许久的数据库持久化问题，一言难尽  T T  **</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">restart:</span> <span class="string">always</span></span><br></pre></td></tr></table></figure>

<p>以只读模式挂载容器的 root 文件系统，意味着不能对容器内容进行修改。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">read_only:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>打开标准输入，可以接受外部输入。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">stdin_open:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>模拟一个伪终端。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tty:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h5 id="读取变量"><a href="#读取变量" class="headerlink" title="读取变量"></a>读取变量</h5><p>Compose 模板文件支持动态读取主机的系统环境变量和当前目录下的 <code>.env</code> 文件中的变量。</p>
<p>例如，下面的 Compose 文件将从运行它的环境中读取变量 <code>$&#123;MONGO_VERSION&#125;</code> 的值，并写入执行的指令中。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">db:</span></span><br><span class="line">  <span class="attr">image:</span> <span class="string">&quot;mongo:$&#123;MONGO_VERSION&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>如果执行 <code>MONGO_VERSION=3.2 docker-compose up</code> 则会启动一个 <code>mongo:3.2</code> 镜像的容器；如果执行 <code>MONGO_VERSION=2.8 docker-compose up</code> 则会启动一个 <code>mongo:2.8</code> 镜像的容器。</p>
<p>若当前目录存在 <code>.env</code> 文件，执行 <code>docker-compose</code> 命令时将从该文件中读取变量。</p>
<p>在当前目录新建 <code>.env</code> 文件并写入以下内容。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 支持 # 号注释</span></span><br><span class="line">MONGO_VERSION=3.6</span><br></pre></td></tr></table></figure>

<p>执行 <code>docker-compose up</code> 则会启动一个 <code>mongo:3.6</code> 镜像的容器。</p>
<h3 id="Swarm-Mode"><a href="#Swarm-Mode" class="headerlink" title="Swarm Mode"></a>Swarm Mode</h3><p><code>Swarm mode</code> 内置 kv 存储功能，提供了众多的新特性，比如：具有容错能力的去中心化设计、内置服务发现、负载均衡、路由网格、动态伸缩、滚动更新、安全传输等。使得 Docker 原生的 <code>Swarm</code> 集群具备与 Mesos、Kubernetes 竞争的实力。</p>
<h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><p><code>Swarm</code> 是使用 <a target="_blank" rel="noopener" href="https://github.com/docker/swarmkit/"><code>SwarmKit</code></a> 构建的 Docker 引擎内置（原生）的集群管理和编排工具。</p>
<h5 id="节点"><a href="#节点" class="headerlink" title="节点"></a>节点</h5><p>运行 Docker 的主机可以主动初始化一个 <code>Swarm</code> 集群或者加入一个已存在的 <code>Swarm</code> 集群，这样这个运行 Docker 的主机就成为一个 <code>Swarm</code> 集群的节点 (<code>node</code>) 。</p>
<p>节点分为管理 (<code>manager</code>) 节点和工作 (<code>worker</code>) 节点。</p>
<p>管理节点用于 <code>Swarm</code> 集群的管理，<code>docker swarm</code> 命令基本只能在管理节点执行（节点退出集群命令 <code>docker swarm leave</code> 可以在工作节点执行）。一个 <code>Swarm</code> 集群可以有多个管理节点，但只有一个管理节点可以成为 <code>leader</code>，<code>leader</code> 通过 <code>raft</code> 协议实现。</p>
<p>工作节点是任务执行节点，管理节点将服务 (<code>service</code>) 下发至工作节点执行。管理节点默认也作为工作节点。你也可以通过配置让服务只运行在管理节点。</p>
<h5 id="服务和任务"><a href="#服务和任务" class="headerlink" title="服务和任务"></a>服务和任务</h5><p>任务 （<code>Task</code>）是 <code>Swarm</code> 中的最小的调度单位，目前来说就是一个单一的容器。</p>
<p>服务 （<code>Services</code>） 是指一组任务的集合，服务定义了任务的属性。服务有两种模式：</p>
<ul>
<li><code>replicated services</code> 按照一定规则在各个工作节点上运行指定个数的任务。</li>
<li><code>global services</code> 每个工作节点上运行一个任务</li>
</ul>
<p>两种模式通过 <code>docker service create</code> 的 <code>--mode</code> 参数指定。</p>
<h4 id="创建Swarm集群"><a href="#创建Swarm集群" class="headerlink" title="创建Swarm集群"></a>创建Swarm集群</h4><h5 id="创建管理节点"><a href="#创建管理节点" class="headerlink" title="创建管理节点"></a>创建管理节点</h5><p>首先创建一个 Docker 主机作为管理节点。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine create -d virtualbox manager</span><br></pre></td></tr></table></figure>

<p>使用 <code>docker swarm init</code> 在管理节点初始化一个 <code>Swarm</code> 集群。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine ssh manager</span><br><span class="line"></span><br><span class="line">docker@manager:~$ docker swarm init --advertise-addr 192.168.99.100</span><br><span class="line">Swarm initialized: current node (dxn1zf6l61qsb1josjja83ngz) is now a manager.</span><br><span class="line"></span><br><span class="line">To add a worker to this swarm, run the following <span class="built_in">command</span>:</span><br><span class="line"></span><br><span class="line">    docker swarm join \</span><br><span class="line">    --token SWMTKN-1-49nj1cmql0jkz5s954yi3oex3nedyz0fb0xx14ie39trti4wxv-8vxv8rssmk743ojnwacrr2e7c \</span><br><span class="line">    192.168.99.100:2377</span><br><span class="line"></span><br><span class="line">To add a manager to this swarm, run <span class="string">&#x27;docker swarm join-token manager&#x27;</span> and follow the instructions.</span><br></pre></td></tr></table></figure>

<p>如果Docker 主机有多个网卡，拥有多个 IP，必须使用 <code>--advertise-addr</code> 指定 IP。执行 <code>docker swarm init</code> 命令的节点自动成为管理节点。</p>
<h5 id="创建工作节点"><a href="#创建工作节点" class="headerlink" title="创建工作节点"></a>创建工作节点</h5><p>创建两个 Docker 主机作为工作节点，并加入到集群中。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine create -d virtualbox worker1</span><br><span class="line"></span><br><span class="line">$ docker-machine ssh worker1</span><br><span class="line"></span><br><span class="line">docker@worker1:~$ docker swarm join \</span><br><span class="line">    --token SWMTKN-1-49nj1cmql0jkz5s954yi3oex3nedyz0fb0xx14ie39trti4wxv-8vxv8rssmk743ojnwacrr2e7c \</span><br><span class="line">    192.168.99.100:2377</span><br><span class="line"></span><br><span class="line">This node joined a swarm as a worker.</span><br></pre></td></tr></table></figure>

<p>经过上边的两步，我们已经拥有了一个最小的 <code>Swarm</code> 集群，包含一个管理节点和两个工作节点。</p>
<p>在管理节点使用 <code>docker node ls</code> 查看集群。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker node ls</span><br><span class="line">ID                           HOSTNAME  STATUS  AVAILABILITY  MANAGER STATUS</span><br><span class="line">03g1y59jwfg7cf99w4lt0f662    worker2   Ready   Active</span><br><span class="line">9j68exjopxe7wfl6yuxml7a7j    worker1   Ready   Active</span><br><span class="line">dxn1zf6l61qsb1josjja83ngz *  manager   Ready   Active        Leader</span><br></pre></td></tr></table></figure>

<h4 id="部署服务"><a href="#部署服务" class="headerlink" title="部署服务"></a>部署服务</h4><p>使用 <code>docker service</code> 命令来管理 <code>Swarm</code> 集群中的服务，该命令只能在管理节点运行。</p>
<h5 id="新建服务"><a href="#新建服务" class="headerlink" title="新建服务"></a>新建服务</h5><p>在<code>Swarm</code> 集群中运行一个名为 <code>nginx</code> 服务。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker service create --replicas 3 -p 80:80 --name nginx nginx:1.13.7-alpine</span><br></pre></td></tr></table></figure>

<p>现在我们使用浏览器，输入任意节点 IP ，即可看到 nginx 默认页面。</p>
<h5 id="查看服务"><a href="#查看服务" class="headerlink" title="查看服务"></a>查看服务</h5><p>使用 <code>docker service ls</code> 来查看当前 <code>Swarm</code> 集群运行的服务。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker service ls</span><br><span class="line">ID                  NAME                MODE                REPLICAS            IMAGE                 PORTS</span><br><span class="line">kc57xffvhul5        nginx               replicated          3/3                 nginx:1.13.7-alpine   *:80-&gt;80/tcp</span><br></pre></td></tr></table></figure>

<p>使用 <code>docker service ps</code> 来查看某个服务的详情。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker service ps nginx</span><br><span class="line">ID                  NAME                IMAGE                 NODE                DESIRED STATE       CURRENT STATE                ERROR               PORTS</span><br><span class="line">pjfzd39buzlt        nginx.1             nginx:1.13.7-alpine   swarm2              Running             Running about a minute ago</span><br><span class="line">hy9eeivdxlaa        nginx.2             nginx:1.13.7-alpine   swarm1              Running             Running about a minute ago</span><br><span class="line">36wmpiv7gmfo        nginx.3             nginx:1.13.7-alpine   swarm3              Running             Running about a minute ago</span><br></pre></td></tr></table></figure>

<p>使用 <code>docker service logs</code> 来查看某个服务的日志。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ docker service logs nginx</span><br><span class="line">nginx.3.36wmpiv7gmfo@swarm3    | 10.255.0.4 - - [25/Nov/2017:02:10:30 +0000] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 612 <span class="string">&quot;-&quot;</span> <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:58.0) Gecko/20100101 Firefox/58.0&quot;</span> <span class="string">&quot;-&quot;</span></span><br><span class="line">nginx.3.36wmpiv7gmfo@swarm3    | 10.255.0.4 - - [25/Nov/2017:02:10:30 +0000] <span class="string">&quot;GET /favicon.ico HTTP/1.1&quot;</span> 404 169 <span class="string">&quot;-&quot;</span> <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:58.0) Gecko/20100101 Firefox/58.0&quot;</span> <span class="string">&quot;-&quot;</span></span><br><span class="line">nginx.3.36wmpiv7gmfo@swarm3    | 2017/11/25 02:10:30 [error] 5<span class="comment">#5: *1 open() &quot;/usr/share/nginx/html/favicon.ico&quot; failed (2: No such file or directory), client: 10.255.0.4, server: localhost, request: &quot;GET /favicon.ico HTTP/1.1&quot;, host: &quot;192.168.99.102&quot;</span></span><br><span class="line">nginx.1.pjfzd39buzlt@swarm2    | 10.255.0.2 - - [25/Nov/2017:02:10:26 +0000] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 200 612 <span class="string">&quot;-&quot;</span> <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:58.0) Gecko/20100101 Firefox/58.0&quot;</span> <span class="string">&quot;-&quot;</span></span><br><span class="line">nginx.1.pjfzd39buzlt@swarm2    | 10.255.0.2 - - [25/Nov/2017:02:10:27 +0000] <span class="string">&quot;GET /favicon.ico HTTP/1.1&quot;</span> 404 169 <span class="string">&quot;-&quot;</span> <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:58.0) Gecko/20100101 Firefox/58.0&quot;</span> <span class="string">&quot;-&quot;</span></span><br><span class="line">nginx.1.pjfzd39buzlt@swarm2    | 2017/11/25 02:10:27 [error] 5<span class="comment">#5: *1 open() &quot;/usr/share/nginx/html/favicon.ico&quot; failed (2: No such file or directory), client: 10.255.0.2, server: localhost, request: &quot;GET /favicon.ico HTTP/1.1&quot;, host: &quot;192.168.99.101&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="服务伸缩"><a href="#服务伸缩" class="headerlink" title="服务伸缩"></a>服务伸缩</h5><p>使用 <code>docker service scale</code> 对一个服务运行的容器数量进行伸缩。</p>
<p>当业务处于高峰期时，我们需要扩展服务运行的容器数量。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker service scale nginx=5</span><br></pre></td></tr></table></figure>

<p>当业务平稳时，我们需要减少服务运行的容器数量。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker service scale nginx=2</span><br></pre></td></tr></table></figure>

<h5 id="删除服务"><a href="#删除服务" class="headerlink" title="删除服务"></a>删除服务</h5><p>使用 <code>docker service rm</code> 来从 <code>Swarm</code> 集群移除某个服务。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker service rm nginx</span><br></pre></td></tr></table></figure>

<h4 id="使用compose文件"><a href="#使用compose文件" class="headerlink" title="使用compose文件"></a>使用compose文件</h4><p>使用 <code>docker service create</code> 一次只能部署一个服务，使用 <code>docker-compose.yml</code> 可以一次启动多个关联的服务。</p>
<p>以在 <code>Swarm</code> 集群中部署 <code>WordPress</code> 为例进行说明。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">wordpress:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">wordpress</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span><span class="string">:80</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">overlay</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_HOST:</span> <span class="string">db:3306</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">WORDPRESS_DB_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">mode:</span> <span class="string">replicated</span></span><br><span class="line">      <span class="attr">replicas:</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">       <span class="bullet">-</span> <span class="string">overlay</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db-data:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">somewordpress</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">wordpress</span></span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">wordpress</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">placement:</span></span><br><span class="line">        <span class="attr">constraints:</span> [<span class="string">node.role</span> <span class="string">==</span> <span class="string">manager</span>]</span><br><span class="line"></span><br><span class="line">  <span class="attr">visualizer:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">dockersamples/visualizer:stable</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">stop_grace_period:</span> <span class="string">1m30s</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;/var/run/docker.sock:/var/run/docker.sock&quot;</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">placement:</span></span><br><span class="line">        <span class="attr">constraints:</span> [<span class="string">node.role</span> <span class="string">==</span> <span class="string">manager</span>]</span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">db-data:</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">overlay:</span></span><br></pre></td></tr></table></figure>

<p>在 <code>Swarm</code> 集群管理节点新建该文件，其中的 <code>visualizer</code> 服务提供一个可视化页面，我们可以从浏览器中很直观的查看集群中各个服务的运行节点。</p>
<p>在 <code>Swarm</code> 集群中使用 <code>docker-compose.yml</code> 我们用 <code>docker stack</code> 命令，下面我们对该命令进行详细讲解。</p>
<h5 id="部署服务-1"><a href="#部署服务-1" class="headerlink" title="部署服务"></a>部署服务</h5><p>部署服务使用 <code>docker stack deploy</code>，其中 <code>-c</code> 参数指定 compose 文件名。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker stack deploy -c docker-compose.yml wordpress</span><br></pre></td></tr></table></figure>

<h5 id="查看服务-1"><a href="#查看服务-1" class="headerlink" title="查看服务"></a>查看服务</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker stack ls</span><br><span class="line">NAME                SERVICES</span><br><span class="line">wordpress           3</span><br></pre></td></tr></table></figure>

<h5 id="移除服务"><a href="#移除服务" class="headerlink" title="移除服务"></a>移除服务</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker stack down wordpress</span><br><span class="line">Removing service wordpress_db</span><br><span class="line">Removing service wordpress_visualizer</span><br><span class="line">Removing service wordpress_wordpress</span><br><span class="line">Removing network wordpress_overlay</span><br><span class="line">Removing network wordpress_default</span><br></pre></td></tr></table></figure>

<p>该命令不会移除服务所使用的 <code>数据卷</code>，如果你想移除数据卷请使用 <code>docker volume rm</code></p>
<h4 id="管理秘钥"><a href="#管理秘钥" class="headerlink" title="管理秘钥"></a>管理秘钥</h4><h5 id="创建secret"><a href="#创建secret" class="headerlink" title="创建secret"></a>创建secret</h5><p><code> docker secret create</code> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ openssl rand -base64 20 | docker secret create mysql_password -</span><br><span class="line"></span><br><span class="line">$ openssl rand -base64 20 | docker secret create mysql_root_password -</span><br></pre></td></tr></table></figure>

<h5 id="查看secret"><a href="#查看secret" class="headerlink" title="查看secret"></a>查看secret</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker secret ls</span><br><span class="line"></span><br><span class="line">ID                          NAME                  CREATED             UPDATED</span><br><span class="line">l1vinzevzhj4goakjap5ya409   mysql_password        41 seconds ago      41 seconds ago</span><br><span class="line">yvsczlx9votfw3l0nz5rlidig   mysql_root_password   12 seconds ago      12 seconds ago</span><br></pre></td></tr></table></figure>

<h5 id="使用secret"><a href="#使用secret" class="headerlink" title="使用secret"></a>使用secret</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ docker network create -d overlay mysql_private</span><br><span class="line"></span><br><span class="line">$ docker service create \</span><br><span class="line">     --name mysql \</span><br><span class="line">     --replicas 1 \</span><br><span class="line">     --network mysql_private \</span><br><span class="line">     --mount <span class="built_in">type</span>=volume,<span class="built_in">source</span>=mydata,destination=/var/lib/mysql \</span><br><span class="line">     --secret <span class="built_in">source</span>=mysql_root_password,target=mysql_root_password \</span><br><span class="line">     --secret <span class="built_in">source</span>=mysql_password,target=mysql_password \</span><br><span class="line">     -e MYSQL_ROOT_PASSWORD_FILE=<span class="string">&quot;/run/secrets/mysql_root_password&quot;</span> \</span><br><span class="line">     -e MYSQL_PASSWORD_FILE=<span class="string">&quot;/run/secrets/mysql_password&quot;</span> \</span><br><span class="line">     -e MYSQL_USER=<span class="string">&quot;wordpress&quot;</span> \</span><br><span class="line">     -e MYSQL_DATABASE=<span class="string">&quot;wordpress&quot;</span> \</span><br><span class="line">     mysql:latest</span><br></pre></td></tr></table></figure>

<h4 id="管理配置信息"><a href="#管理配置信息" class="headerlink" title="管理配置信息"></a>管理配置信息</h4><p>在 Docker 17.06 以上版本中，Docker 新增了 <code>docker config</code> 子命令来管理集群中的配置信息，以后你无需将配置文件放入镜像或挂载到容器中就可实现对服务的配置。</p>
<blockquote>
<p>注意：<code>config</code> 仅能在 Swarm 集群中使用。</p>
</blockquote>
<h5 id="创建config"><a href="#创建config" class="headerlink" title="创建config"></a>创建config</h5><p>新建 <code>redis.conf</code> 文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">port 6380</span><br></pre></td></tr></table></figure>

<p>此项配置 Redis 监听 <code>6380</code> 端口</p>
<p>我们使用 <code>docker config create</code> 命令创建 <code>config</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker config create redis.conf redis.conf</span><br></pre></td></tr></table></figure>

<h5 id="查看config"><a href="#查看config" class="headerlink" title="查看config"></a>查看config</h5><p>使用 <code>docker config ls</code> 命令来查看 <code>config</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ docker config ls</span><br><span class="line"></span><br><span class="line">ID                          NAME                CREATED             UPDATED</span><br><span class="line">yod8fx8iiqtoo84jgwadp86yk   redis.conf          4 seconds ago       4 seconds ago</span><br></pre></td></tr></table></figure>

<h5 id="使用config"><a href="#使用config" class="headerlink" title="使用config"></a>使用config</h5><h4 id="滚动升级"><a href="#滚动升级" class="headerlink" title="滚动升级"></a>滚动升级</h4><p>在 Swarm mode 中对服务进行滚动升级，使用 <code>docker service update</code> 命令。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker service update \</span><br><span class="line">    --image nginx:1.13.12-alpine \</span><br><span class="line">    nginx</span><br></pre></td></tr></table></figure>

<p>以上命令使用 <code>--image</code> 选项更新了服务的镜像。当然我们也可以使用 <code>docker service update</code> 更新任意的配置。</p>
<p><code>--secret-add</code> 选项可以增加一个密钥</p>
<p><code>--secret-rm</code> 选项可以删除一个密钥</p>
<p>更多选项可以通过 <code>docker service update -h</code> 命令查看。</p>
<h5 id="服务回退"><a href="#服务回退" class="headerlink" title="服务回退"></a>服务回退</h5><p>现在假设我们发现 <code>nginx</code> 服务的镜像升级到 <code>nginx:1.13.12-alpine</code> 出现了一些问题，我们可以使用命令一键回退。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker service rollback nginx</span><br></pre></td></tr></table></figure>

<p>现在使用 <code>docker service ps</code> 命令查看 <code>nginx</code> 服务详情。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ docker service ps nginx</span><br><span class="line">ID                  NAME                IMAGE                  NODE                DESIRED STATE       CURRENT STATE                ERROR               PORTS</span><br><span class="line">rt677gop9d4x        nginx.1             nginx:1.13.7-alpine   VM-20-83-debian     Running             Running about a minute ago</span><br><span class="line">d9pw13v59d00         \_ nginx.1         nginx:1.13.12-alpine  VM-20-83-debian     Shutdown            Shutdown 2 minutes ago</span><br><span class="line">i7ynkbg6ybq5         \_ nginx.1         nginx:1.13.7-alpine   VM-20-83-debian     Shutdown            Shutdown 2 minutes ago</span><br></pre></td></tr></table></figure>

<p>结果的输出详细记录了服务的部署、滚动升级、回退的过程。</p>
<h3 id="Docker-Machine"><a href="#Docker-Machine" class="headerlink" title="Docker Machine"></a>Docker Machine</h3><p>Docker Machine 是 Docker 官方编排（Orchestration）项目之一，负责在多种平台上快速安装 Docker 环境。</p>
<h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><h5 id="Mac-OS-Windows"><a href="#Mac-OS-Windows" class="headerlink" title="Mac OS/Windows"></a>Mac OS/Windows</h5><p><code>Docker Desktop for Mac/Windows</code> 自带 <code>docker-machine</code> 二进制包，安装之后即可使用。</p>
<h5 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h5><p>从 <a target="_blank" rel="noopener" href="https://github.com/docker/machine/releases">官方 GitHub Release</a> 处直接下载编译好的二进制文件即可。</p>
<p>例如，在 Linux 64 位系统上直接下载对应的二进制包。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo curl -L https://github.com/docker/machine/releases/download/v0.16.1/docker-machine-`uname -s`-`uname -m` &gt; /usr/<span class="built_in">local</span>/bin/docker-machine</span><br><span class="line"></span><br><span class="line">$ sudo chmod +x /usr/<span class="built_in">local</span>/bin/docker-machine</span><br></pre></td></tr></table></figure>

<h4 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h4><p>Docker Machine 支持多种后端驱动，包括虚拟机、本地主机和云平台等。</p>
<h5 id="创建本地主机实例"><a href="#创建本地主机实例" class="headerlink" title="创建本地主机实例"></a>创建本地主机实例</h5><h6 id="virtualbox驱动"><a href="#virtualbox驱动" class="headerlink" title="virtualbox驱动"></a>virtualbox驱动</h6><p>使用 <code>virtualbox</code> 类型的驱动，创建一台 Docker 主机，命名为 test。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker-machine create -d virtualbox <span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p>你也可以在创建时加上如下参数，来配置主机或者主机上的 Docker。</p>
<p><code>--engine-opt dns=114.114.114.114</code> 配置 Docker 的默认 DNS</p>
<p><code>--engine-registry-mirror https://dockerhub.azk8s.cn</code> 配置 Docker 的仓库镜像</p>
<p><code>--virtualbox-memory 2048</code> 配置主机内存</p>
<p><code>--virtualbox-cpu-count 2</code> 配置主机 CPU</p>
<p>更多参数请使用 <code>docker-machine create --driver virtualbox --help</code> 命令查看。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/03/19/docker/" data-id="ckja57ef0000gfq130dcy63sx" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-KeepAlived等应用的特点" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/31/KeepAlived%E7%AD%89%E5%BA%94%E7%94%A8%E7%9A%84%E7%89%B9%E7%82%B9/" class="article-date">
  <time datetime="2020-01-31T09:50:04.000Z" itemprop="datePublished">2020-01-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/31/KeepAlived%E7%AD%89%E5%BA%94%E7%94%A8%E7%9A%84%E7%89%B9%E7%82%B9/">KeepAlived等应用的特点</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="KeepAlived、HAProxy、CTDB、MyDNS"><a href="#KeepAlived、HAProxy、CTDB、MyDNS" class="headerlink" title="KeepAlived、HAProxy、CTDB、MyDNS"></a>KeepAlived、HAProxy、CTDB、MyDNS</h1><h2 id="KeepAlived"><a href="#KeepAlived" class="headerlink" title="KeepAlived"></a>KeepAlived</h2><p>在CSDN上看到一篇对KeepAlived的详细介绍:<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_24336773/article/details/82143367">Keepalived原理</a>,贴到这里，再对工作原理进行进一步的举例说明。</p>
<h3 id="KeepAlived的工作原理"><a href="#KeepAlived的工作原理" class="headerlink" title="KeepAlived的工作原理"></a>KeepAlived的工作原理</h3><p><code>KeepAlived</code>实现高可用是通过对服务器运行状态进行检测，以及对故障进行隔离实现的。  </p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">KeepAlived工作在TCP&#x2F;IP模型的第三、四、五层（即网络层、传输层、应用层），在每一层的实现如下：  </span><br><span class="line">网络层：KeepAlived通过ICMP协议向服务器集群中的每一个节点发送一个ICMP数据包(有点类似与Ping的功能)，如果某个节点没有返回响应数据包，那么认为该节点发生了故障，Keepalived将报告这个节点失效，并从服务器集群中剔除故障节点。  </span><br><span class="line">传输层：KeepAlived在传输层里利用了TCP协议的端口连接和扫描技术来判断集群节点的端口是否正常，比如对于常见的WEB服务器80端口。或者SSH服务22端口，Keepalived一旦在传输层探测到这些端口号没有数据响应和数据返回，就认为这些端口发生异常，然后强制将这些端口所对应的节点从服务器集群中剔除掉。  </span><br><span class="line">应用层：KeepAlived的运行方式也更加全面化和复杂化，用户可以通过自定义Keepalived工作方式，例如：可以通过编写程序或者脚本来运行Keepalived，而Keepalived将根据用户的设定参数检测各种程序或者服务是否允许正常，如果Keepalived的检测结果和用户设定的不一致时，KeepAlived将把对应的服务器从服务器集群中剔除。   </span><br></pre></td></tr></table></figure>
<hr>
<p>举一个例子对它的工作原理进行说明：<br>一个集群对外提供<code>web</code>（端口80）服务，通过<code>KeepAlived</code>做高可用：在网络层，通过ICMP回送请求和回答报文检测节点主机的存活状况；在传输层，通过向目标主机的80端口发送<code>TCP</code>连接请求，以判断80端口的服务是否可用；在应用层，通过向指定网址发送<code>HTTP HEAD</code>报文，根据返回报文的<code>HTTP</code>状态码来判断<code>web</code>服务的健康状况。若其中某个主机的某项检测结果出现异常，则可认为该主机的服务出现故障，可进行隔离，从而确保服务的可用性。</p>
<h2 id="HAProxy"><a href="#HAProxy" class="headerlink" title="HAProxy"></a>HAProxy</h2><p>一年前的文档<a target="_blank" rel="noopener" href="https://super-tramper.github.io/2018/12/15/HAProxy/">HAProxy</a>主要介绍它的负载均衡功能，虽然它在工作内容中占了一些分量，不能不熟悉它，但我始终觉得它是高可用应用，可能是因为它名字里的HA（High Availability）。日常工作中并没有很认真地思考过HAProxy、KeepAlived、CTDB、mydns(bind)的相同点和区别，特别是看了<code>KeepAlived</code>原理之后，一下想起了<code>CTDB</code>，我惭愧地无地自容，做事不能这么糊涂，所以现在把这些内容翻出来比较一下。</p>
<p>==，<a target="_blank" rel="noopener" href="http://www.haproxy.org/">HAProxy官网</a>需要梯子才能访问。<br>当 前，HAProxy支持两种主要的代理模式:”tcp”也即4层（大多用于邮件服务器、内部协议通信服务器等），和7层（HTTP）。在4层模式 下，HAProxy仅在客户端和服务器之间转发双向流量。7层模式下，HAProxy会分析协议，并且能通过允许、拒绝、交换、增加、修改或者删除请求 (request)或者回应(response)里指定内容来控制协议，这种操作要基于特定规则；对7层的支持实现了连接拒绝功能，通过对协议内容进行控制，避免了一些非法请求甚至恶意攻击对后端服务器的危害。<br><img src="data:image/png;base64,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" alt="image"><br>在backend的配置中，用户可添加一组真实的服务器，并指定轮询的规则，同时可指定对后端服务器健康检测的手段，健康检测的时间间隔可在defaults里设置。它同时实现了负载均衡和高可用，它的负载均衡性能可与硬件负载均衡器媲美，所以更突出的是其负载均衡功能。<br>另外，在<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_24336773/article/details/82143367">Keepalived原理</a>中看到这一段  </p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">由于Keeplalived可以实现对集群节点的状态检测，而IPVS可以实现负载均衡功能，因此,Keepalived借助于第三方模块IPVS就可以很方便地搭建一套负载均衡系统。在Keepalived当中IPVS模块是可配置的，如果需要负载均衡功能，可以在编译Keepalived时开打负载均衡功能，也可以通过编译参数关闭。</span><br></pre></td></tr></table></figure>
<hr>
<p>高可用和负载均衡似乎是一对形影不离的好基友。</p>
<h2 id="CTDB"><a href="#CTDB" class="headerlink" title="CTDB"></a>CTDB</h2><p>关于CTDB的介绍，<a target="_blank" rel="noopener" href="https://ctdb.samba.org/">CTDB官网</a>已经说得很明白了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CTDB is a cluster implementation of the TDB database used by Samba and other projects to store temporary data.</span><br></pre></td></tr></table></figure>
<p>CTDB是一种TDB数据库集群的实现方式，TDB数据库用于Samba或者其他需要存储临时数据的项目中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Is CTDB a HA solution?</span><br><span class="line">Yes and no.</span><br><span class="line">CTDB alone is not a HA solution, but when you combine CTDB with a clustered filesystem it becomes one.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>CTDB的高可用功能同其它高可用方案区别的特征就是它能用于文件存储，在客户端同服务端进行文件传输的过程中，若提供服务的主节点宕机，备用节点能接管虚拟IP，继续接收，客户端不用重传此前已上传的内容，也就是能实现断点续传。</p>
<p>刚入职瑞驰的时候跟CTDB战斗了好久，当时要是能到<a target="_blank" rel="noopener" href="https://ctdb.samba.org/">官网</a>耐心看看，能少走好多弯路。伍豪同志说的没错，要到敌人的后方去，把握大局和重点。</p>
<h2 id="MyDNS"><a href="#MyDNS" class="headerlink" title="MyDNS"></a>MyDNS</h2><ul>
<li><a target="_blank" rel="noopener" href="http://mydns.bboy.net/">官网链接</a></li>
<li>域名解析时根据设置的策略选择后端主机<br>MyDNS的最新版本是2006年1月发布的<code>1.1.0</code>，当时就是靠着官网编译出了飞腾版本的包 ^-^ </li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/01/31/KeepAlived%E7%AD%89%E5%BA%94%E7%94%A8%E7%9A%84%E7%89%B9%E7%82%B9/" data-id="ckja57eex000ffq13a8u88xiw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-面试" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/01/31/%E9%9D%A2%E8%AF%95/" class="article-date">
  <time datetime="2020-01-31T09:48:31.000Z" itemprop="datePublished">2020-01-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2020/01/31/%E9%9D%A2%E8%AF%95/">面试</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="面试"><a href="#面试" class="headerlink" title="面试"></a>面试</h1><p>一周内收到五个面试邀请，分别是外包、绿盟和三家其他公司。</p>
<p>仔细一想，从2019年8月开始，基本没碰过代码，Linux也没碰，工作中的两柄利器都上了锈，还没磨，就开始面试。这段时间我专注于夯实基础，以期达到一个从业者应有的知识水平，学了很多基础性东西，也不是非常全面，例如编译原理，还要找时间学习一下，还有虚拟化，也需要了解。  </p>
<p>毫无准备地开始面试，肯定是有点虚的。我首先去了外包，两个面试官面我，其中一个的态度让我不太舒服，可能是行业内混入了太多半路出家的人（包括我），让这个行业不太好混，需要尽力分辨人才的优劣。我对此毫无意见，只是一些科班出身的人毫无缘由的仇视态度让我不爽，因为他们本来就菜，只想靠行业红利混个温饱，一出来工作发现竞争这么激烈，于是就主动站上了鄙视链，呵呵。  </p>
<h3 id="外包岗"><a href="#外包岗" class="headerlink" title="外包岗"></a>外包岗</h3><p>外包岗位面试的内容，更倾向于对Python语言掌握程度的考察，例如，分片的魔法方法，实现迭代器的魔法方法，很基础。但是，我答得乱七八糟。回来一翻以前的笔记，我的天，太不应该了。然后赶紧复习一下，还有装饰器，这个几乎是Python面试都会问到的（可能看我太菜，他们没问这个）。语言这个工具还是要熟练掌握的。<br>外包工作的内容是针对通信协议编写测试脚本，后期还要学习ruby再进行开发。怎么说呢，我的主观目的不是求财，起码现在不是。  </p>
<h3 id="WPF开发"><a href="#WPF开发" class="headerlink" title="WPF开发"></a>WPF开发</h3><p>第二个面试岗位是WPF开发岗，我简历上有一个这种项目。面试的时候首先是上机做几个WPF的小东西，45分钟时间，我卡在了最简单的一个上面，内容是根据鼠标的移近移出和点击改变按钮的颜色。还说什么呢？只怪自己太轻浮，把当时做的项目拿出来看一眼就能搞出来，我啥都忘了，还好没忘记怎么打开visual studio ==b<br>我以为我挂了，结果过了两天，hr小姐姐给我发消息，问我上机的时候有没有上网搜索，他们上机是可以百度的，我话冇。她叫我去跟项目负责人谈一谈，说是还有戏。好吧，WPF开发这么缺人吗，我不想长期干这个，就给推了。  </p>
<h3 id="绿盟"><a href="#绿盟" class="headerlink" title="绿盟"></a>绿盟</h3><p>绿盟很早就收了我的简历，并且通过了初审，但是过了差不多一周才叫我去面试（腾讯也收了，并且给我打了好几个电话确认我是否可以面试，到现在也没下文）。可能大厂都是这种效率，或者二线城市的hr都是这种效率，在深圳的时候，基本是收简历当天就敲定面试时间，不用等太久。<br>绿盟的面试约在周五下午五点，我没有十分意外，某为的hr约在晚上九点面试可能并不是段子。<br>等面试的时候，我坐在那里翻绿盟的期刊，看了一篇市场人员写的文章，里面还有很多安全方面的内容，很不错，回来之后在绿盟的官网上也找到了这个期刊。<a target="_blank" rel="noopener" href="https://www.nsfocus.com.cn/html/7/20/">绿盟期刊</a><br>绿盟的面试官是一位技术经理，下午五点过两分出现，看上去一脸疲惫，首先我自我介绍一下，说了做过的项目。<br>重点来了，面试官问了很多架构方面的东西，我一下就懵了，架构这玩意也不是我搭的呀，有些没有答上来。然后问了一些Linux操作的问题，两个答得不好，其它都没问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.查看进程占用cpu和内存的情况；  </span><br><span class="line">我答了top，虽然没错，但不是他想要的答案，就说不知道，回来一查，还有ps命令，以前用的最多，用来查看进程的运行情况，但是一直也没注意过各项输出结果的表示内容。  </span><br><span class="line">2.查看文件夹或文件占用多少磁盘空间的命令；  </span><br><span class="line">当时想了一下没想起来，回来之后想起来是du，还能怎么说呢？用得太少，丢了这么久又没复习。  </span><br></pre></td></tr></table></figure>
<p>回来仔细一想，面试官问的架构方面的问题，其实也不深，答不上来很不应该。<br>我简历上写了我精通haproxy、KeepAlived等应用，简直是作死，面试官就特地问了这些东西，毫无意外，全忘了。又是恶补。<br>然后面试官问了我的职业发展规划，我表达了对绿盟的敬仰，并请面试官对职业规划作了一些建议，他对我的规划作了肯定，用“这就是我能说的全部”作为结尾，我可以确定他还有个“但是”没说出来。  </p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>不同的岗位、公司需要不同的技术栈、不同的软实力，不同面试官提问的侧重点也不同。从不同岗位的面试情况，可以摸清自己的不足之处。跟不同面试官交流的过程中，也对自己的思维、意识有拓展作用。去年曾经抱着这种心态去深信服面了一下，结果因为基础太差，连最后向面试官提问的机会都不要，直接跑了。现在我可以应付当时的面试题了，深信服和绿盟都是我心仪的厂，两次机会就这样错过了，惋惜。</p>
<p>这三次面试分别考察了语言基础、编码能力、宏观的结构问题，再加上算法，应该包括了面试的主要考察范围，于是后面两家就推了。打算先加强自己，再找准目标出击。<br>结果我猫着学习的时候，Boss上有人找到我，找我要了电话，然后电话面试了一通，真是逃都逃不掉。对方是个高校的教授，听声音还挺年轻，正好他的项目方向我很感兴趣，于是聊了40分钟。<br>我说了一下我的项目，他顺带着问了超融合和虚拟化，对方水平之高，令我等膜拜不已，这是我面过知识面最广的面试官。他问的我应该答上来的都答上来了，我还向他请教了一下最近几年国家大力扶持人工智能、网络安全、区块链的用意，教授解答得中规中矩。我也不太好意思说我的偏见，显得无知，不能被市场的乱象带偏。如果他能接受我的报价，就算是敲定了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/01/31/%E9%9D%A2%E8%AF%95/" data-id="ckja57eee0009fq135dw4bh6s" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-HTTP请求模块优化" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/14/HTTP%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97%E4%BC%98%E5%8C%96/" class="article-date">
  <time datetime="2019-08-14T15:18:08.000Z" itemprop="datePublished">2019-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/14/HTTP%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97%E4%BC%98%E5%8C%96/">HTTP请求模块优化</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>上个C#请求模块只有简单的请求以及解析响应，在项目的不断进行及优化中，加入了HTTPS以及上传下载文件等功能，可设置请求超时时间，加入请求头Header。</p>
<p>模块从配置文件中读取根服务器地址，拼接请求路径自动生成request对象。模块只会对返回200状态码和401状态码的响应作出反应：当收到200状态码的响应时解析响应并将响应内容返回给调用者；收到401响应时强迫客户端弹出异地登录提醒，用户关闭该弹窗时关闭主界面并弹出登录界面；收到其它响应时一律向调用者返回null。以下为优化后的模块代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*┏┓　　　┏┓</span><br><span class="line">┏┛┻━━━┛┻┓</span><br><span class="line">┃　　　　　　　┃    ***** </span><br><span class="line">┃　　　━　　　┃    ***** </span><br><span class="line">┃　┳┛　┗┳　┃    ***** </span><br><span class="line">┃　　　　　　　┃</span><br><span class="line">┃　　　┻　　　┃</span><br><span class="line">┃　　　　　　　┃</span><br><span class="line">┗━┓　　　┏━┛</span><br><span class="line">    ┃　　　┃  神兽保佑</span><br><span class="line">    ┃　　　┃  代码无BUG！</span><br><span class="line">    ┃　　　┗━━━┓</span><br><span class="line">    ┃　　　　　　　┣┓</span><br><span class="line">    ┃　　　　　　　┏┛</span><br><span class="line">    ┗┓┓┏━┳┓┏┛</span><br><span class="line">      ┃┫┫　┃┫┫</span><br><span class="line">      ┗┻┛　┗┻┛    *&#x2F;</span><br><span class="line">using System;</span><br><span class="line">using System.Collections.Generic;</span><br><span class="line">using System.Linq;</span><br><span class="line">using System.Text;</span><br><span class="line">using System.Threading.Tasks;</span><br><span class="line">using System.Configuration;</span><br><span class="line">using RestSharp;</span><br><span class="line">using log4net;</span><br><span class="line">using Newtonsoft.Json;</span><br><span class="line">using System.IO;</span><br><span class="line">using System.Windows;</span><br><span class="line">using DesktopClient.pop_upWindow;</span><br><span class="line">using System.Security.Cryptography.X509Certificates;</span><br><span class="line">using System.Net;</span><br><span class="line"></span><br><span class="line">namespace DesktopClient.tools</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 进行http请求的类</span><br><span class="line">    &#x2F;&#x2F; 初始化时可根据需要传递参数，除uri外其它参数都可选</span><br><span class="line">    &#x2F;&#x2F; 初始化针对缺省参数的默认情形：get请求(Method.GET)，不携带token(false)，无参数（object)</span><br><span class="line">    </span><br><span class="line">    class RequestAPI</span><br><span class="line">    &#123;</span><br><span class="line">        public static string token &#123; get; set; &#125;</span><br><span class="line">        public static int id &#123; get; set; &#125;</span><br><span class="line">        public static string username &#123; get; set; &#125;</span><br><span class="line">        public static string serverAddress &#x3D; ConfigurationManager.AppSettings[&quot;address&quot;];</span><br><span class="line">        </span><br><span class="line">        RestClient client &#x3D; new RestClient(serverAddress);</span><br><span class="line">        RestRequest request &#x3D; new RestRequest();</span><br><span class="line"></span><br><span class="line">        private static readonly ILog log &#x3D; LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);</span><br><span class="line">        public RestRequest RequstBody</span><br><span class="line">        &#123;</span><br><span class="line">            get &#123; return request; &#125;</span><br><span class="line">            set &#123; request &#x3D; value; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        public RequestAPI(string uri): this(uri, &quot;get&quot;, false) &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, string requstMethod): this(uri, requstMethod, false) &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, Boolean needToken): this(uri, &quot;get&quot;, needToken) &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, string requestMethod, Boolean needToken): this(uri, requestMethod, needToken, 5000) &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, string requestMethod, Boolean needToken, int timeOut)</span><br><span class="line">        &#123;</span><br><span class="line">            request.Resource &#x3D; uri;</span><br><span class="line">            if (requestMethod &#x3D;&#x3D; &quot;get&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.GET;</span><br><span class="line">            &#125;</span><br><span class="line">            else if (requestMethod &#x3D;&#x3D; &quot;post&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.POST;</span><br><span class="line">            &#125;</span><br><span class="line">            else if (requestMethod &#x3D;&#x3D; &quot;delete&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.DELETE;</span><br><span class="line">            &#125;</span><br><span class="line">            else if (requestMethod &#x3D;&#x3D; &quot;put&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.PUT;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                throw new Exception(&quot;request method not defined&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            request.AddHeader(&quot;Accept&quot;, &quot;application&#x2F;json&quot;);</span><br><span class="line">            if (needToken)</span><br><span class="line">                request.AddHeader(&quot;Authorization&quot;, token);</span><br><span class="line">            request.Timeout &#x3D; timeOut;&#x2F;&#x2F;单位是毫秒，注意</span><br><span class="line">            ServicePointManager.ServerCertificateValidationCallback &#x3D; new System.Net.Security.RemoteCertificateValidationCallback(RemoteCertificateValidationCallback);</span><br><span class="line">            X509Certificate2 certificates &#x3D; new X509Certificate2();</span><br><span class="line">            certificates.Import(&quot;ca.crt&quot;);</span><br><span class="line">            client.ClientCertificates &#x3D; new X509CertificateCollection();</span><br><span class="line">            client.ClientCertificates.Add(certificates);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public static bool RemoteCertificateValidationCallback(object sender, X509Certificate certificate, X509Chain chain, System.Net.Security.SslPolicyErrors errors)</span><br><span class="line">        &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void SetTimeOut(int timeOut)</span><br><span class="line">        &#123;</span><br><span class="line">            request.Timeout &#x3D; timeOut;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, Boolean needToken, Dictionary&lt;string,string&gt; param) : this(uri, &quot;get&quot;, needToken)</span><br><span class="line">        &#123;</span><br><span class="line">            foreach (var item in param)</span><br><span class="line">            &#123;</span><br><span class="line">                request.AddParameter(item.Key, item.Value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, string requestMethod, Boolean needToken, object json): this(uri, requestMethod, needToken)</span><br><span class="line">        &#123;</span><br><span class="line">            request.AddJsonBody(json);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line">        public void UpLoadFile(string path, string sn)&#x2F;&#x2F;文件上传</span><br><span class="line">        &#123;</span><br><span class="line">            request.AddParameter(&quot;sn&quot;, sn);</span><br><span class="line">            request.AddFile(&quot;file&quot;, path, null);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void AddFile(string fileName, string filePath)</span><br><span class="line">        &#123;</span><br><span class="line">            request.AddFile(fileName, filePath);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public void DownloadFile(string path)</span><br><span class="line">        &#123;</span><br><span class="line">            byte[] file &#x3D; client.DownloadData(request);</span><br><span class="line">            File.WriteAllBytes(path, file);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public string GetHtml()</span><br><span class="line">        &#123;</span><br><span class="line">            IRestResponse response &#x3D; client.Execute(request);</span><br><span class="line">            return response.Content;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public RequestResponse Response()</span><br><span class="line">        &#123;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                log.Info(&quot;请求资源： &quot; + request.Resource.ToString());</span><br><span class="line">                IRestResponse response &#x3D; client.Execute(request);</span><br><span class="line">                ResponseStatus responseStatus &#x3D; response.ResponseStatus;</span><br><span class="line">                var code &#x3D; response.StatusCode;</span><br><span class="line">                if (response.StatusCode &#x3D;&#x3D; System.Net.HttpStatusCode.OK)</span><br><span class="line">                &#123;</span><br><span class="line">                    log.Info(response.Content);</span><br><span class="line">                    RequestResponse rb &#x3D; JsonConvert.DeserializeObject&lt;RequestResponse&gt;(response.Content);</span><br><span class="line">                    </span><br><span class="line">                    return rb;</span><br><span class="line">                &#125;</span><br><span class="line">                else if (response.StatusCode &#x3D;&#x3D; System.Net.HttpStatusCode.Unauthorized)</span><br><span class="line">                &#123;</span><br><span class="line">                    log.Info(response.Content);</span><br><span class="line">                    App.Current.Dispatcher.Invoke(new Action(() &#x3D;&gt;</span><br><span class="line">                    &#123;</span><br><span class="line">                        RequestResponse rb &#x3D; JsonConvert.DeserializeObject&lt;RequestResponse&gt;(response.Content);</span><br><span class="line">                        Window mainwindow &#x3D; App.Current.MainWindow;</span><br><span class="line">                        log.Info(response);</span><br><span class="line">                        StandardMsgBox window &#x3D; new StandardMsgBox();</span><br><span class="line">                        Window loginWindow &#x3D; new LoginWindow(false);</span><br><span class="line">                        window.TitleInfo &#x3D; &quot;提示&quot;;</span><br><span class="line">                        window.Content &#x3D; rb.msg;</span><br><span class="line">                        window.tipText.FontSize &#x3D; 16;</span><br><span class="line">                        window.Owner &#x3D; mainwindow;</span><br><span class="line">                        window.WindowStartupLocation &#x3D; WindowStartupLocation.CenterOwner;</span><br><span class="line">                        window.ShowDialog();</span><br><span class="line">                        mainwindow.Close();</span><br><span class="line">                        loginWindow.Show();</span><br><span class="line">                        token &#x3D; null;</span><br><span class="line">                    &#125;));</span><br><span class="line">                &#125;</span><br><span class="line">                else</span><br><span class="line">                &#123;</span><br><span class="line">                    log.Error(&quot;Request for resource &quot; + request.Resource.ToString() + &quot;(&quot; + request.Method + &quot;)&quot; + &quot;failed: &quot; + responseStatus.ToString() + response.Content);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            catch (Exception e)</span><br><span class="line">            &#123;</span><br><span class="line">                log.Error(&quot;Failed request: &quot; + e);</span><br><span class="line">            &#125;</span><br><span class="line">            return null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public class RequestResponse</span><br><span class="line">    &#123;</span><br><span class="line">        public int status &#123; get; set; &#125;</span><br><span class="line">        public string msg &#123; get; set; &#125;</span><br><span class="line">        public object data &#123; get; set; &#125; &#x3D; null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/08/14/HTTP%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97%E4%BC%98%E5%8C%96/" data-id="ckja57ee50004fq13efjm2ght" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C#</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-用docker构建静态文件服务器" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/08/07/%E7%94%A8docker%E6%9E%84%E5%BB%BA%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/" class="article-date">
  <time datetime="2019-08-07T06:05:13.000Z" itemprop="datePublished">2019-08-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/08/07/%E7%94%A8docker%E6%9E%84%E5%BB%BA%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/">用docker构建静态文件服务器</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>去年曾用VPS搭建了一个静态文件转发服务，上面放的是我搜集来的文档和一些自己的总结。今年年初我的VPS被封，无奈销毁了服务器，最近刚从GCP平台重建了VPS，就想重新搭建之前的服务，为了防止服务器被封，部署的环境毁于一旦需要再重新搭建，我使用了docker。  </p>
<p>这次先把环境和文件放上去，然后再制作dockerfile，一键部署指日可待。</p>
<p>按照<a target="_blank" rel="noopener" href="https://yeasy.gitbooks.io/docker_practice/">docker文档</a>从零开始部署，这里记录搭建的过程和踩过的一些坑。<br>学习使用docker之前建议读一下文档，理解它的组成和特性。</p>
<h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>我的系统是Debian，首先做好准备工作，参考<a target="_blank" rel="noopener" href="https://yeasy.gitbooks.io/docker_practice/install/debian.html">文档</a>，这里不过多说明。</p>
<h3 id="构建自己的镜像"><a href="#构建自己的镜像" class="headerlink" title="构建自己的镜像"></a>构建自己的镜像</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --name webserver -d -p 80:80 nginx</span><br></pre></td></tr></table></figure>

<p>这条命令会用 nginx 镜像启动一个容器，命名为 webserver，并且映射了 80 端口，这样我们可以用浏览器去访问这个 nginx 服务器。</p>
<p>我运行这条命令后出现了如下内容：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># docker run --name webserver -d -p 80:80 nginx   </span><br><span class="line">Unable to find image &#39;nginx:latest&#39; locally   </span><br><span class="line">latest: Pulling from library&#x2F;nginx   </span><br><span class="line">f5d23c7fed46: Pull complete    </span><br><span class="line">918b255d86e5: Pull complete   </span><br><span class="line">8c0120a6f561: Pull complete   </span><br><span class="line">Digest:   sha256:eb3320e2f9ca409b7c0aa71aea3cf7ce7d018f03a372564dbdb023646958770b  </span><br><span class="line">Status: Downloaded newer image for nginx:latest  </span><br><span class="line">af28e1e0d003fef00b0470407d89f97cf4f2985de626e5c185c5ded41e86b5a8  </span><br><span class="line">docker: Error response from daemon: driver failed programming external connectivity on endpoint webserver   (141637172fa381423065069f8f64a62b6c605a0853d3db829320494043ec865d): Error starting userland proxy: listen tcp 0.0.0.0:80: bind: address already in use.</span><br></pre></td></tr></table></figure>

<p>果然，本地已经有Nginx在监听80端口，干掉它，然后启动容器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># docker container start webserver</span><br></pre></td></tr></table></figure>

<p>查看端口：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># netstat -nlp | grep 80</span><br><span class="line">tcp6       0      0 :::80                   :::*                    LISTEN      1838&#x2F;docker-proxy </span><br></pre></td></tr></table></figure>

<p>OK</p>
<p>浏览器访问<code>ip:port</code>，出现如下画面。  </p>
<p><img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4RDiRXhpZgAATU0AKgAAAAgABAE7AAIAAAAIAAAISodpAAQAAAABAAAIUpydAAEAAAAQAAAQyuocAAcAAAgMAAAAPgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFdpdG5lc3MAAAWQAwACAAAAFAAAEKCQBAACAAAAFAAAELSSkQACAAAAAzc0AACSkgACAAAAAzc0AADqHAAHAAAIDAAACJQAAAAAHOoAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAyMDE5OjA4OjA3IDE0OjM3OjQyADIwMTk6MDg6MDcgMTQ6Mzc6NDIAAABXAGkAdABuAGUAcwBzAAAA/+ELGmh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iLz48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+PHhtcDpDcmVhdGVEYXRlPjIwMTktMDgtMDdUMTQ6Mzc6NDIuNzQzPC94bXA6Q3JlYXRlRGF0ZT48L3JkZjpEZXNjcmlwdGlvbj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+PGRjOmNyZWF0b3I+PHJkZjpTZXEgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOmxpPldpdG5lc3M8L3JkZjpsaT48L3JkZjpTZXE+DQoJCQk8L2RjOmNyZWF0b3I+PC9yZGY6RGVzY3JpcHRpb24+PC9yZGY6UkRGPjwveDp4bXBtZXRhPg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8P3hwYWNrZXQgZW5kPSd3Jz8+/9sAQwAHBQUGBQQHBgUGCAcHCAoRCwoJCQoVDxAMERgVGhkYFRgXGx4nIRsdJR0XGCIuIiUoKSssKxogLzMvKjInKisq/9sAQwEHCAgKCQoUCwsUKhwYHCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq/8AAEQgBAQIqAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+kaKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACivF3/aDNr8VP+EM1Lwx9mI1EWJvP7Q3YBbar7PLHByDjPfrXcfE74gQ/Dbwgdblsvt7tOkEVt53lb2bJPzbWxgAnp2pXXKp9H/X6js+Zx6o7CivOfhL8XIfilDqeNK/suewaPMX2nzt6vnDZ2LjlSMVheP8A4/jwX4+fwvZeGjq06CIGQX3k/O4BCbfLb1HOe9U01JR6sSd032PY6KahZo1LqFYgZUHOD6Zp1IAormviH4ju/CXw+1fXdNjhlurKESRpOpKE7gOQCD39RXJfA/4m6z8S9L1a5122sbd7KaOOMWcbqCGUk53O3p7ULVtLoD0tfqepUUUUAFFFFABRRRQAUUUUAFFFFABRRUV3P9lsp7jbu8qNn25xnAzik2krsaTbsiWivJPhX8dP+Fm+KLjR/wDhHf7M8m0a5877d527Dqu3Hlr/AH85z2r1uqcWkm+pN7hRRRSGFFFFABRRRQAUUUUAFFeM+Ov+F3f8LDn/AOEJ/wCRc3Q+X/x5dNq+Z/rPn+9u/pXsw6DPWhaxuD0lYKKKKACiiigAorzn4t/Fg/C2DS5P7E/tUag0q/8AH15Pl7Av+w2c7vbpXQfDzxgfHngey8RGw/s/7WZALfzvN27XZPvbVznbnpQtU2ug3pa/U6aiiigQUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQB8i/tIaVJ4f8AjBba5aLs+3QRXKv/ANNYztP6Kh/Gtr9pfxQNdg8JaXYN5i3VsNRKLzuMgCx/+z/nXV/tUaD9t8DabrUaZk0678tz6RyDH/oSr+deL/DZLvx78XvCtrfjzI9PSFMAcCG3XcAfrt/WppLntTfSX4b/AOX3DqPl/eLrH8dv8/vOp/Z/nuvB3xxvfDWp/u5biKazkXsZIzvB/JWx9ao+F4v+Fg/tUNdsPMt11SW7Jzx5cJOz/wBBQfjVr47RXfgb47xeI9K/dyXUUd5GT03gGNx+O3n/AHq3f2UNC83Vte8QSqT5MSWkTnuWO5/x+VfzrSlLmcZv7Kf33/zIqLlUor7TX5f5HU/G74u614f8Q2ng3wUVi1W6CeddFQzIZDhEQHgE9SSOARj1rnvHHhf4nfDbwv8A8JcnxJ1DU5YXjF1avvMce4gZUOzKw3ED7q9c1xn7Q2kNp3xtlvNVjmOn6gkEweLAZo1VUcKTxuG0/mK6u1+FXwLu9OS9j+IVwkbpu2TapaxyD2KNEGB9sVlC7hzdb/0jSVlPl6WOov8Ax6/xE/ZZ13VruNIr6GI212sf3fMVkO4egIIOO2awv2Y9VtdD8CeMNV1B9lrZOk8rAdFWNif5Ve/szwlpv7NXjNPAV9qF/prTNuuL7bl5B5QO3Cr8uMdRnOa5b4K6Vda58EviHp2noXuZ41ESDq7CNiF/HGPxqpOzqSj/ACpkWv7NP+Z/kR2njn4p/GvxVdWPhHUTollEpk2wTGBIEzhd8qguzH298ACvQfAOh/Frwd44srXxjrb6x4emilM9ws5uVjZUJXc8iiReR16HpXnf7NXjXQ/Cet61YeI72LTv7QSIwz3LBIw0ZfKsx4XO/vxxXv8Ac/EHwrruoDwvout2upajqVvMsf2GVZkjAjYlmdTgfTOfbvVS9yN4a6ffp+n/AAQ+KTUtNTwi/wDiV8QPi/8AECXw/wDD/UW0jTwXMJikMJES8ebJIoLjORwvTIGCeahv/GHxT+CHiqytfFernXLK4XzNk1w1wk6ZwwWRwHVh+XI4IrJ+Amt2PgT4uXcHiudNM32stk8ly2xIpQ6nDE8AfIRk8dK1v2mPGGieKNb0Ox8O39vqZso5WlmtHEiZcrhQy5BPy9vUUvhUHDW+/wCP/AK+JyUtLHbftC+Mr+L4f+GNZ8KaxfafFqMvmiSzuHhZ0aPcA20jPXpXnUniD406z8MbbVLObU4NBsIWaTUYrsLPcAMS0jOX81gOnHGBW78btKudE+BXgDTb5WW5t1VJVbqreTyv4dPwrvfCX/Jor/8AYEvP/alTJcqqtdH+goe9Kmn1X6nmvgv4pfFvxd4ZuPDfhWA6pqUJ3vqsjxiWGI8BSXIXcSDhjk9fTNM+FvxJ8c6F8XLbwz4t1G+vI7q7NndWt/KZWhkPAZWJJGDjocEH6Gtb9kr/AJC/if8A64W//oT1zupf8ngD/sPRf+y1pF/voL+bf70jOX8KT7bfdc9I+NXxc1zSPFVp4I8DOkOqXBjWe6KhmRpCAka5yASCCSR3GKwPHXhv4m/DDw4niyL4kahqjRyot1bS7zHHuOAQrsysN2B90da4r496P/Z3x0ubnWknGm6i0E++HAZogqo+0kEbhtb9K6+D4VfAu409bxPiHcLGyb9kmqWqSAehjMQYH2xms4XcObrf+kbSsp8vS39M9n+FHjpviF4AtdZuI0ivFdoLpI/uiRepHsQQcds4p3xW0TXtf+H93Z+FdT/sy+DLIZ/tEkOY1yWXcgJ5HGOhrM+Cmm+FNN8F3aeBL2/vtLfUJD599t3O4VFJXCr8uAMZGetd3qoLaPeBQSTA4AHf5TTxFuVtdr/qTR3Sfe36Hw58K/DXinxT4ouLLwRrX9jX8do0sk/2uW33Rh1BXdGCTyVOOnFe4eMfHXif4M/CvSND1HUY9V8WXjTE30kz3Cxxhyd+ZACxAZVAIxweoHPmv7N+v6T4d+JV3Pr2o22nQzabJEkt1KI03+ZG2Cx4HCnr6V0H7TTwa83h7xNolwl/pLpNZi6gO6PzEfoD0OfmwRwdpqqrtGKXXf73/wAAIK7bfT+v8yO18PfHDUvCI8cQ+LLrymgN2ln/AGhIsjx43bhEF8vkcgZ6du1ejfAT4vX3j2C70bxGUfVrKMTJcIoX7RFnBJUcBgSOmAcjiregfFzwZbfBmzubjW7FLm20tYZNPadfPMix7Sgj+8ckdcYxzXlX7K2kXU/j7UtWVGFpa2Bhd+xd3Uqv5Kx/CrSXtJQ6Jf5/8Aht+zjJ7/8ADH1fXyR8TfHHjDSf2gb+z0PWdVeOG9tvs+mR3kohlOyM+X5YYDDE4I75NfW9fHvjv/k7Yf8AYZsf5Q1nBXrRX9bouWlNv+uozxz4i+NXhXVbbWfFWo6lpX2pybeOC5Q2+Rzt8uNivAPRhk+/Ne3TfGB7L9n208c3EEb6jcRCCOHGEe53FCcf3cqzY9Biue/av/5EXRP+wkf/AEU1cXrmnz3n7Gvh64gUslnqDyy4HRTNMmfzZfzqb/upeTS+8tL34vun+v8AkQeDbb4zfFVrrXdK8XXFjBDLs3zXslvC79SqxxqQcAjqMc9aT4S+K/GFz8frLR/EHibU75FuLqO4ge9keB2WOTohO3G4ZAwMYHAruP2efiB4W0n4YHTNZ1yw0y7tLqVmjvLhYi6t8wZdxG7uOMnivNPhJdQ337T0F3auJIJ76+ljcD7ytHKQfyNbwSVVRW1n+Ri23TlJ7/8ADnQfGfxd4k0v47pp+meIdVs7L/Rf9Gt72SOPnGflDAc966z9qDxFrfh+18NnQdYv9MMz3AlNldPD5mBHjO0jOMnr61538dv+TiE/7c/6V2X7W3/Hp4W/37r+UVcy/hR/xM2j/Hkv7q/JnIX2t/GzV/hzZ6zDLqVroFjahje294EmnVesrtv81/r0x+Jr0n9n3x5q/j7w7reg+Jr24uJ7NFEd6khjm8uQMMb1wdwK5DdefatvRf8Ak08f9i5L/wCi2rzv9kr/AJC/if8A64W//oT1t/y8nDp/w/8AkZa+yhU6/wDDf5mY/i7xp8GPjEtn4s1vVdZ0Zmx/pd3JMs1sx4kUMSA647dwR0NS3vjXxf8AGX4wDTPA+tanpGjRnar2lxJAFgU/NM4UjJOeAfUD1qT9onxZB408Y6b4M8N2aX15YzlHnjXLtM/HkqfQcbvcD+7Vf9n/AMVx+AfHuoeEfE9pHZT38wg8+RQHinUkCNm/unPHbOPWppe/a/S9vP8Ar9fNFVfdvbra/l/X9dTpf2otPXT/AAP4Wt0nnnFvcPEJLiUySSfux8zOeSeOp9a9H+BEIg+CXh5QCN0Uj8+8rn+tU/jd4V0TxhoOm6fr3i6w8MCO5M8Ut6U/fYUqVAaROm4Hgmuo+HWm6fo3w+0nTNH1e31q0tIjEl9bMpSYhjkjazDrkYyelEL2nfq0/wABSTvDsk/zOmooooGFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAY/izwxYeMvC95oOrmVbS8UK7QsA64YMCpIIzkDsa5HwF8EfDPw78QSaxo11qdzdPA0AF5LGyqpIJICovPy+vrXo1FC0d0D1VmcR8RPhRoHxMNi2vT31u9jvEb2UiISGxkHcjZHyitDwF4B0j4deH5NI0KS5lhknad5Lp1aRmIA6qqjGFHaunooWl0getrmJ4o8H6D400sWHiXTor6BTuTcSrRn1VgQVP0NeaH9lzwGbzzvtOtCPOfIF0mz6Z8vd+tezUUrJO47u1jjx8L/DUHw9vPBunQT2GlXgPm+RMWk3Egltz7uflHbFJ8PPhlo3w0s7220K5vrhL2RZJDeSIxBUEDG1F9feuxop9W+5NlZLseceLfgR4H8X38t/dWM1hezHdLPp8vllz6lSCuffGT3qTwP8EfCHgLVU1TSo7251CMMsdzeXG5kDDBAVQq9D3Feh0UR93Yb97c4Hxt8F/B3jy8a+1Wyltr9hh7yyk8uR/94EFWPuQTVPwj8BPA/g/UotQtrW51G8hbdFNqEok8s9iFUKuR2JGRXpVFEfd2B+9uch8Q/hro/wAStOs7PXbm+t47SUyxmzkRSSRjncrcVZ07wJpmmfDk+C4J7ttONrJa+a7qZtj7snIXbn5jj5a6ailZWa7jvqn2OF+Hfwk0H4Z3F9NoN3qNw18iJIL2SNgApJGNqL/ePrVKf4H+G5/iQPGz3uqjUvta3flCWPyd64wMeXuxx/e/GvR6Kf2lLqibJpruYfirwZoHjbTRY+JtNjvYkO6MklXjPqrAgj8Dz3rzX/hlzwH9s877TrXl5z5H2pNn0z5e79a9mopWSdyrmP4Y8K6P4N0RNJ8O2n2SzRi+zzGclj1JLEnJxWxRRVN33JSS2PJ/EH7N/gTX9Wlvwuoaa8zl5I7GdVjZick7XVsfQYFdfpvw58N6f4DTwe9l9t0dQ37q7bexLMWJzxg5OQRjHaupopWtHl6FXbd+p44/7MHgFtQ+0LJq6RZz9lW6Xy/pkpu/8er07w54Z0fwlo8el+HrGOytEOdiZJY92Zjyx9ya1aKd2lYVtbhXm+rfA3w1rPxE/wCEzur7VU1H7TFdeVHNGId0YUKMGMnHyDPzetekUUlo+ZbhurHJfEL4caR8SdJtdP124vbeK1n89Gs3RWLbSuDuVuMGqkug6N8N/gzf6YlrLq+k6ZZXEr2946lp1JZ2VmCgc5Izj0ruKR0WRGSRQysMFWGQRSfwtLqNPVN9D4xi1b4IR3v9oHw/4rdwNw01p4jbbvTfu8zH4/hXQfs6+FrvXPihP4uSwNnpVl5zRFVIjEkgKiND32qx+mB619IyeBPCMt19pl8LaK8+c+a2nRFs/XbmtyKKOGJY4UWONRhUQYAHoBVxfK7/ANakSV1Y868WfA/w34x8ZjxNqd7qsV6PL/d28sax/JjHBjJ7c81pfET4WaJ8TI7BNeur+3FgZDF9ikRd2/bnO5G/ujpiu1oqLK1i7tPm67HPWvgvTrT4e/8ACHRzXR0/7E1l5rOvnbGUgnO3G7n0x7Vz/gn4N6H4Ag1ZPD+qausmqQiGSaWWJnhxuwyYjADfMeoPavQaKb1bb6iWiS7Hm/gr4GeFfA3iQ67YT6lf32xlR9QlSQRlurDai/MRkZOepo8cfAzwr488RDW9Rm1GxvSipI9hKiCXb0ZtyN8wGBkY4Ar0iijt5B38zgfGfwh0bx5pGj2HiDVNXk/slGWK4jliEk24KCZCYyCflHQDvXQ+DPCNh4G8K22gaTLcTWtsXKPcsrOdzFjkqAOp9K3aKd3r5h0S7BRRRSAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigDjE8dXdtrfiO31rTtPsbDQYVmlvBqRYyBwWjG1olAJA5y3BIA3dat+AvEU3inw+uqzappF8JwreTpik/YyVDGKR/Mbc4yMnCf7ozXIHW9KvPFXxMtrTU7OedtNjAiiuEZiY4JFfgHPykgH0Jwa7zwV/yIOgf9g23/8ARa0oap38vxv/AJCe6Xr+Fv8AMv8A9saZ/ZZ1L+0bT7AOt156+UOdv38468devFRSeIdFh1qPR5tXsI9TlGY7JrlBM4xnIjzuPAJ6dq86XTblfiRL4KEEjaPJfDxIZG+4secmEEHr9pAfHTBNU767tYvhr4i8MXs0Z8W3d5eNBYMwN1PM8zNbyov3mAXyyHHChOo2nDWqT/r+r3Xy8x9bf11/S33nrS39mzXIW7gJtDi5AkH7k7Q3z/3flIPPY5qWCeK5t457aVJoZVDxyRsGV1IyCCOCCO9eZPq1noF/46s9cu44L++VZ7W3PMt2n2NELRIMs43I4O0HG05rrfDAQ/DHSBKzJH/ZEO5kBLKPJGSAOSam+kn2S/G/+Qfaiu9/0/zL9l4m0HU9Tm03Ttb067voN3m2sF3G8se04bcgORg8HI4NP03xDous3Fxb6Rq9hfzWxxPHa3KStEckfMFJK8g9fSvHTfavP4Vk8J+FtU0HxVZw6FJFBdaLCUubQqAoWQLIygyJkAAoxbOBwTWjOZdejj/4R/xjoF7qthpV3BZado1g1vcLvh2hH3XDmMKypwyrhgoODinJ2vbov8/8gjq0u/8AwP8AM9RsvEOi6lqVxp+navYXd7bZ8+2guUeSLBwdyg5XB4571m+LfGum+D5dIXVJ7WFNSvBbF7m6WERJsZmk+bqAQoPT7459eK8MNbajqHhW1Txf4fEujn91pFhprwXiDyWRopFa4dkAz8wZByozg103xFmjsl8N6jdusNlY65DLdXEhwkCGORNzt0VdzqMnjmqas16pfiEdb37P77Mdp/xA0uTWNZj1PV9JtdOt7i3isLp7lUW5EkCy8OW2ufmONvb86231lovE0mmzQwR2sdh9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ooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Z" alt="avatar"></p>
<p>说明Nginx成功启动。</p>
<h3 id="配置文件转发"><a href="#配置文件转发" class="headerlink" title="配置文件转发"></a>配置文件转发</h3><p>上次配置Nginx时，我修改了配置文件，新增一个server，这次我想偷个懒，使用默认配置，把这个欢迎页面(<code>/usr/share/nginx/html/index.html</code>)换成文档的入口<code>index.html</code>。</p>
<p>把文件上传到服务器，在主机中用命令拷贝文件到容器，具体过程如下(记住首先修改原index.html的文件名或直接删除)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># docker ps</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES</span><br><span class="line">af28e1e0d003        nginx               &quot;nginx -g &#39;daemon of…&quot;   4 hours ago         Up 3 hours          0.0.0.0:80-&gt;80&#x2F;tcp   webserver  </span><br><span class="line"># docker cp &#x2F;root&#x2F;documents&#x2F;* af2:&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html&#x2F;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>进入容器查看文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># docker container exec -it webserver &#x2F;bin&#x2F;bash</span><br><span class="line"># ls &#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html</span><br><span class="line"> 0							 &#39;03&#39;$&#39;\351\253\230\347\272\247&#39;   06Redis			   &#39;09&#39;$&#39;\346\225\260\346\215\256\347\273\223\346\236\204&#39;   11shell	 14DjangoRESTframework</span><br><span class="line">&#39;01&#39;$&#39;\345\237\272\347\241\200&#39;				 &#39;04&#39;$&#39;\345\211\215\347\253\257&#39;  &#39;07&#39;$&#39;\347\210\254\350\231\253&#39;   10shell.zip						     12tornado	 index.md</span><br><span class="line">&#39;02&#39;$&#39;\351\235\242\345\220\221\345\257\271\350\261\241&#39;   05Django			   08Flask			   &#39;10&#39;$&#39;\346\225\260\346\215\256\346\214\226\346\216\230&#39;   13celery</span><br></pre></td></tr></table></figure>

<p>中文乱码 ==   </p>
<p>接着来  </p>
<p>输入locale查看下语言情况</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># locale</span><br><span class="line">LANG&#x3D;</span><br><span class="line">LANGUAGE&#x3D;</span><br><span class="line">LC_CTYPE&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_NUMERIC&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_TIME&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_COLLATE&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_MONETARY&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_MESSAGES&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_PAPER&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_NAME&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_ADDRESS&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_TELEPHONE&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_MEASUREMENT&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_IDENTIFICATION&#x3D;&quot;POSIX&quot;</span><br><span class="line">LC_ALL&#x3D;</span><br></pre></td></tr></table></figure>
<p>在容器中/etc/bash.bashrc里面末尾写入，然后source /etc/bash.bashrc。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LC_ALL&#x3D;&quot;C.UTF-8&quot;</span><br></pre></td></tr></table></figure>

<p>退出容器，重新进入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># exit</span><br><span class="line"># docker container exec -it webserver &#x2F;bin&#x2F;bash</span><br><span class="line"># locale</span><br><span class="line">LANG&#x3D;</span><br><span class="line">LANGUAGE&#x3D;</span><br><span class="line">LC_CTYPE&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_NUMERIC&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_TIME&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_COLLATE&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_MONETARY&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_MESSAGES&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_PAPER&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_NAME&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_ADDRESS&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_TELEPHONE&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_MEASUREMENT&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_IDENTIFICATION&#x3D;&quot;C.UTF-8&quot;</span><br><span class="line">LC_ALL&#x3D;C.UTF-8</span><br></pre></td></tr></table></figure>

<p>完成！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/08/07/%E7%94%A8docker%E6%9E%84%E5%BB%BA%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E6%9C%8D%E5%8A%A1%E5%99%A8/" data-id="ckja57eej000efq1336wt4t1k" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-C-开发桌面程序技能" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/07/27/C-%E5%BC%80%E5%8F%91%E6%A1%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F%E6%8A%80%E8%83%BD/" class="article-date">
  <time datetime="2019-07-27T10:33:26.000Z" itemprop="datePublished">2019-07-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/07/27/C-%E5%BC%80%E5%8F%91%E6%A1%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F%E6%8A%80%E8%83%BD/">C# 开发桌面程序技能</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>WPF快速入门系列</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111583">WPF布局概览</a>  </li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111584">依赖属性</a>  </li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111585">WPF事件机制</a>  </li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111586">WPF绑定</a>  </li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111587">WPF命令</a></li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111588">资源和样式</a>  </li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111589">WPF模板</a>  </li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111590">MVVM快速入门</a>  </li>
<li><a target="_blank" rel="noopener" href="https://www.kancloud.cn/wizardforcel/learning-hard-csharp/111591">WPF任务管理工具实现</a>  </li>
</ul>
<p>开发项目过程中这些博客给了我很大帮助</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.lindexi.com/post/dotnet-%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83%E7%9A%84-500-%E7%AF%87%E6%96%87%E7%AB%A0%E5%90%88%E9%9B%86.html">dotnet-从入门到放弃的-500-篇文章合集</a>   </li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/liyuqian199695/article/details/53790604">网络流、网络数据的编解码</a>  </li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/lordwish/article/details/52667150">WPF简单导航框架</a>  </li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/07/27/C-%E5%BC%80%E5%8F%91%E6%A1%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F%E6%8A%80%E8%83%BD/" data-id="ckja57edx0000fq13fvhde61x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C#</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-C-Http请求模块" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/28/C-Http%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97/" class="article-date">
  <time datetime="2019-05-28T13:39:38.000Z" itemprop="datePublished">2019-05-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/05/28/C-Http%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97/">C# Http请求模块</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>根据工作中用到的的请求响应格式，用第三方api RestSharp封装了一个HTTP请求模块。</p>
<p>RestSharp的api请参考<a target="_blank" rel="noopener" href="https://github.com/restsharp/RestSharp%E3%80%82">https://github.com/restsharp/RestSharp。</a></p>
<p>工作中常用的响应格式为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;status&quot;: 0,</span><br><span class="line">	&quot;msg&quot;: OK</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>status</code> 表示响应状态，0表示请求成功， <code>msg</code>表示响应的附加说明。</p>
<p>具体代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;*┏┓　　　┏┓</span><br><span class="line">┏┛┻━━━┛┻┓</span><br><span class="line">┃　　　　　　　┃    ***** </span><br><span class="line">┃　　　━　　　┃    ***** </span><br><span class="line">┃　┳┛　┗┳　┃    ***** </span><br><span class="line">┃　　　　　　　┃</span><br><span class="line">┃　　　┻　　　┃</span><br><span class="line">┃　　　　　　　┃</span><br><span class="line">┗━┓　　　┏━┛</span><br><span class="line">    ┃　　　┃  神兽保佑</span><br><span class="line">    ┃　　　┃  代码无BUG！</span><br><span class="line">    ┃　　　┗━━━┓</span><br><span class="line">    ┃　　　　　　　┣┓</span><br><span class="line">    ┃　　　　　　　┏┛</span><br><span class="line">    ┗┓┓┏━┳┓┏┛</span><br><span class="line">      ┃┫┫　┃┫┫</span><br><span class="line">      ┗┻┛　┗┻┛    *&#x2F;</span><br><span class="line">using System;  </span><br><span class="line">using System.Collections.Generic;  </span><br><span class="line">using System.Linq;  </span><br><span class="line">using System.Text;  </span><br><span class="line">using System.Threading.Tasks;  </span><br><span class="line">using System.Configuration;  </span><br><span class="line">using RestSharp;  </span><br><span class="line">using log4net;  </span><br><span class="line">using Newtonsoft.Json;  </span><br><span class="line"></span><br><span class="line">namespace DesktopClient.tools</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 进行http请求的类</span><br><span class="line">    &#x2F;&#x2F; 初始化时可根据需要传递参数，除uri外其它参数都可选</span><br><span class="line">    &#x2F;&#x2F; 初始化针对缺省参数的默认情形：get请求(Method.GET)，携带token(true)，无参数（object)</span><br><span class="line">    class RequestAPI</span><br><span class="line">    &#123;</span><br><span class="line">        public static string token &#123; get; set; &#125;</span><br><span class="line">        public static int id &#123; get; set; &#125;</span><br><span class="line">        static string serverAddress &#x3D; ConfigurationManager.AppSettings[&quot;address&quot;];</span><br><span class="line">        RestClient client &#x3D; new RestClient(serverAddress);</span><br><span class="line">        RestRequest request &#x3D; new RestRequest();</span><br><span class="line">        private static readonly ILog log &#x3D; LogManager.GetLogger(System.Reflection.MethodBase.GetCurrentMethod().DeclaringType);</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri): this(uri, &quot;get&quot;, false) &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, string requstMethod): this(uri, requstMethod, false) &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, Boolean needToken): this(uri, &quot;get&quot;, needToken) &#123; &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, string requestMethod, Boolean needToken)</span><br><span class="line">        &#123;</span><br><span class="line">            request.Resource &#x3D; uri;</span><br><span class="line">            if (requestMethod &#x3D;&#x3D; &quot;get&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.GET;</span><br><span class="line">            &#125;</span><br><span class="line">            else if (requestMethod &#x3D;&#x3D; &quot;post&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.POST;</span><br><span class="line">            &#125;</span><br><span class="line">            else if (requestMethod &#x3D;&#x3D; &quot;delete&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.DELETE;</span><br><span class="line">            &#125;</span><br><span class="line">            else if (requestMethod &#x3D;&#x3D; &quot;put&quot;)</span><br><span class="line">            &#123;</span><br><span class="line">                request.Method &#x3D; Method.PUT;</span><br><span class="line">            &#125;</span><br><span class="line">            else</span><br><span class="line">            &#123;</span><br><span class="line">                throw new Exception(&quot;request method not defined&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">            request.AddHeader(&quot;Accept&quot;, &quot;application&#x2F;json&quot;);</span><br><span class="line">            if (needToken)</span><br><span class="line">                request.AddHeader(&quot;Authorization&quot;, token);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public RequestAPI(string uri, string requestMethod, Boolean needToken, object json): this(uri, requestMethod, needToken)</span><br><span class="line">        &#123;</span><br><span class="line">            request.AddJsonBody(json);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public RequestResponse Response()</span><br><span class="line">        &#123;</span><br><span class="line">            try</span><br><span class="line">            &#123;</span><br><span class="line">                IRestResponse response &#x3D; client.Execute(request);</span><br><span class="line">                ResponseStatus responseStatus &#x3D; response.ResponseStatus;</span><br><span class="line">                var code &#x3D; response.StatusCode;</span><br><span class="line">                if (response.StatusCode !&#x3D; System.Net.HttpStatusCode.OK)</span><br><span class="line">                &#123;</span><br><span class="line">                    log.Error(&quot;Request for resource &quot; + request.Resource.ToString() + &quot;(&quot; + request.Method + &quot;)&quot; + &quot;failed: &quot; + responseStatus.ToString() + response.Content);</span><br><span class="line">                    throw new Exception(&quot;failed request&quot;);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                log.Info(response.Content);</span><br><span class="line">                RequestResponse rb &#x3D; JsonConvert.DeserializeObject&lt;RequestResponse&gt;(response.Content);</span><br><span class="line">                return rb;</span><br><span class="line">            &#125;</span><br><span class="line">            catch (Exception e)</span><br><span class="line">            &#123;</span><br><span class="line">                log.Error(&quot;Failed request: &quot; + e);</span><br><span class="line">                throw e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public class RequestResponse </span><br><span class="line">    &#123;</span><br><span class="line">        public int status &#123; get; set; &#125;</span><br><span class="line">        public string msg &#123; get; set; &#125;</span><br><span class="line">        public object data &#123; get; set; &#125; &#x3D; null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/05/28/C-Http%E8%AF%B7%E6%B1%82%E6%A8%A1%E5%9D%97/" data-id="ckja57ee20001fq13803x81x4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C#</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-网络层" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/05/%E7%BD%91%E7%BB%9C%E5%B1%82/" class="article-date">
  <time datetime="2019-03-05T14:38:38.000Z" itemprop="datePublished">2019-03-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/05/%E7%BD%91%E7%BB%9C%E5%B1%82/">网络层</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>简单网络中的报文传输过程：主机A向网络中的主机B发送一个报文，A中的网络层取得来自A运输层的报文段，将每个报文段封装成一个数据报，然后将数据报向相邻路由器R1发送。在主机B侧，网络层接收来自相邻路由器R2的数据报，提取出运输层报文段，并向上交付给B的运输层。其中路由器的作用是将数据报从入链路转发到出链路。</p>
<h3 id="转发和路由选择"><a href="#转发和路由选择" class="headerlink" title="转发和路由选择"></a>转发和路由选择</h3><p><code>转发</code>：当一个分组到达路由器的一条输入链路时，路由器必须将该分组移动到适当的输出链路。<br><code>路由选择</code>：当分组从发送方流向接收方时，网络层必须决定这些分组所采用的路由或路径。计算这些路径的算法被称为路由选择算法。转发是一个路由器本地操作，路由选择是网络范围的过程。<br><code>转发表</code>：每台路由器都具有一张转发表，路由器通过检查到达分组首部字段的值来转发分组，然后使用该值在路由器的转发表中索引查询。分组首部中的值可能是该分组的目的地址或该分组所属连接的指示，这取决于网络层协议。路由器接收的路由选择协议报文被用于配置其转发表。</p>
<h3 id="网络服务模型"><a href="#网络服务模型" class="headerlink" title="网络服务模型"></a>网络服务模型</h3><p>网络服务模型定义了分组在发送与接收端系统之间的端到端运输特性。网络层能提供的特定服务如下：</p>
<ul>
<li>1.确保交付：该服务确保分组将最终到达其目的地。</li>
<li>2.具有时延上界的确保交付：该服务不仅确保分组交付，而且在特定的主机到主机时延上界内交付。</li>
<li>3.有序分组交付：该服务确保分组以它们发送的顺序到达目的地。</li>
<li>4.确保最小带宽：这种网络层服务模仿在发送和接收主机之间的一条特定比特率的传输链路的行为，只要分组以低于特定比特率的速率传输比特，则分组不会丢失，且每个分组会在预定的主机到主机时延内到达。</li>
<li>5.确保最大时延抖动：确保位于发送方的两个相继分组之间的时间量等于（或在允许误差范围内）在目的地接收到它们之间的时间量。</li>
<li>6.安全性服务：使用仅由源和目的主机所知晓的一个秘密会话秘钥，在源主机中的网络层能够加密向目的主机发送的所有数据报负载。</li>
</ul>
<p>因特网的网络层提供了单一的尽力而为服务。ATM网络体系结构则提供了多重服务模型，以下为两个ATM服务模型实例：</p>
<ul>
<li>恒定比特率（CBR）ATM网络服务：使用CBR服务模型的ATM信元流跨越网络时传递时，信元的端到端时延、信元端到端时延中的可变性（时延抖动）及丢失或推迟交付信元的比率都确保在特定值以下。第一次建立CBR连接时，发送主机及ATM网络都认可了这些值。</li>
<li>可用比特率（ABR）ATM网络服务：ABR服务下的信元也许会丢失，但信元不能被重排序，它的最新信元传输速率（MCR）是可以保证的。ATM ABR服务能够为发送方提供反馈信息，以便发送方在MCR和一个允许的峰值信元速率之间调整其速率。</li>
</ul>
<h2 id="虚电路和数据报网络"><a href="#虚电路和数据报网络" class="headerlink" title="虚电路和数据报网络"></a>虚电路和数据报网络</h2><p>网络层连接/无连接和运输层面向连接/无连接的区别：</p>
<ul>
<li>网络层中，是网络层向运输层提供的主机到主机的服务；运输层中，是运输层向应用层提供的进程到进程的服务。</li>
<li>仅在网络层提供连接服务的计算机网络称为<code>虚电路（VC）网络</code>；仅在网络层提供无连接服务的计算机网络称为<code>数据报网络</code>。没有哪种网络体系结构能同时提供这两种服务。</li>
<li>运输层面向连接服务在位于网络边缘的端系统中实现，网络层连接服务除了在端系统中，也在位于网络核心的路由器中实现。</li>
</ul>
<h3 id="虚电路网络"><a href="#虚电路网络" class="headerlink" title="虚电路网络"></a>虚电路网络</h3><p>因特网是数据报网络，许多其它网络体系结构却是虚电路网络，在网络层使用连接。</p>
<p>虚电路的组成如下：</p>
<ul>
<li>源和目的主机之间的路径；</li>
<li>VC号，沿着该路径的每段链路的一个号码；</li>
<li>沿着该路径的每台路由器中的转发表项</li>
</ul>
<p>属于一条虚电路的分组将在它的首部携带一个VC号，一条虚电路在每条链路上可能具有不同的VC号，每台中间路由器必须使用一个新的VC号替代每个传输分组的VC号，新的VC号从转发表获得。</p>
<p>虚电路中有3个阶段：</p>
<ul>
<li>1.虚电路建立：发送运输层与网络层联系，指定接收方地址，等待网络建立虚电路。网络层决定发送方与接收方之间的路径。网络层在沿着路径的每台路由器的转发表中增加一个表项，在建立过程中，网络层还可以预留该虚电路路径上的资源。</li>
<li>2.数据传送</li>
<li>3.虚电路拆除：当发送方或接收方通知网络层它希望终止该虚电路时启动这个阶段。网络层将通知网络另一侧的端系统结束呼叫，并更新路径上每台路由器中的转发表以表明该虚电路已不存在了。</li>
</ul>
<p>网络层虚电路建立与运输层连接建立的区别：运输层的连接仅涉及两个端系统，网络中的路由器对此毫不知情；虚电路中，两个端系统之间路径上的路由器都要参与虚电路的建立，且每台路由器都完全知道经过它的所有虚电路。</p>
<h3 id="数据报网络"><a href="#数据报网络" class="headerlink" title="数据报网络"></a>数据报网络</h3><p>在数据报网络中，每当一个端系统要发送分组，它就为该分组加上目的端系统的地址，然后将分组推进网络中。</p>
<p>在传输分组的过程中，路径上所有路由器都使用分组的目的地址来转发该分组。</p>
<p>每台路由器都有一个将目的地址映射到链路接口的转发表，路由器用分组的目的地址齐纳追与该表中的表项进行匹配；如果存在一个匹配项，则路由器向与该匹配项相联系的链路转发分组。当有多个匹配时，路由器使用最长前缀匹配规则。</p>
<h2 id="路由器工作原理"><a href="#路由器工作原理" class="headerlink" title="路由器工作原理"></a>路由器工作原理</h2><p>路由器的组成部分：</p>
<ul>
<li>输入端口：执行将一条输入的五连链路与路由器相连接的功能、与位于入链路远端的数据链路层交互的数据链路层功能、完成查找功能（通过查询转发表决定路由器的输出端口）。</li>
<li>交换结构：将路由器的输入端口与输出端口相连接，它是网络路由器中的网路。</li>
<li>输出端口：存储从交换结构接收的分组，并通过执行必要的链路层和物理层功能在输入链路上传输这些分组。</li>
<li>路由选择处理器：执行路由选择协议，维护路由选择表以及连接的链路状态信息，并为路由器计算转发表。执行网络管理功能。</li>
</ul>
<p>路由器的输入端口、输出端口和交换结构共同实现转发功能，该功能被称为路由转发平面，在纳秒时间尺度运行，通常由硬件来实现；路由器的控制功能以毫秒或秒的时间尺度运行，路由控制平面通常用软件实现并在路由选择处理器上执行。</p>
<h3 id="输入端口"><a href="#输入端口" class="headerlink" title="输入端口"></a>输入端口</h3><p>输入端口的线路端接功能与链路层实现了用于各个输入链路的物理层和链路层。路由器使用转发表来查找输出端口，使得到达的分组将能经过交换结构转发到该输出端口。转发表是由路由选择处理器计算和更新的，但转发表的一份影子副本通常会被存放在每个输入端口。</p>
<p>输入端口中必须采取的动作：</p>
<ul>
<li>查找输出端口；</li>
<li>出现物理层和链路层处理；</li>
<li>检测分组的版本号、检验和以及寿命字段，并且重写后两个字段；</li>
<li>更新用于网络管理的计数器</li>
</ul>
<h3 id="交换结构"><a href="#交换结构" class="headerlink" title="交换结构"></a>交换结构</h3><p>交换结构位于一台路由器的核心部位。交换可以用多种方式完成：</p>
<ul>
<li>1.经内存交换，经过共享系统总线一次仅能执行一个内存读/写，故不能同时转发两个分组。</li>
<li>2.经总线交换，输入端口经一根共享总线将分组直接传送到输出端口，一次只有一个分组能跨越总线，不需要路由选择处理器的干预。适用于运行在小型局域网和企业网中的路由器。</li>
<li>3.经互联网络交换，能够并行转发多个分组，若两个不同输入端口的分组具有相同的输出端口，则一个分组必须在输入端等待，某时刻给定总线仅有一个分组能发送。</li>
</ul>
<h3 id="输出端口"><a href="#输出端口" class="headerlink" title="输出端口"></a>输出端口</h3><p>输出端口处理取出存放在输出端口内存中的分组并将其发送到输出链路上，执行所需的链路层和物理层传输功能。</p>
<h3 id="排队"><a href="#排队" class="headerlink" title="排队"></a>排队</h3><p>在输入端口和输出端口都会出现排队，排队的程度和位置取决于流量负载、交换结构的相对速率和线路速率。随着队列的增长，路由器的缓存空间被耗尽，当无内存空间可用时将会出现丢包。</p>
<p>基于相对少量的TCP流量，缓存长度的经验计算方法时，缓存数量（B）应当等于平均往返时延（RTT）乘以链路的容量（C）。当有大量的TCP流（N）流过一条链路时，缓存所需要的数量是B=RTT*C/N^-2。</p>
<p>分组调度程序：在输出端口上排队的分组中选择一个来发送，如先来先服务（FCFS）调度和加权公平排队（WFQ），在提供服务质量保证发面起着关键作用。</p>
<p>主动队列管理（AQM）：分组丢弃与标记策略。<br>随机早期检测（RED）：它是一种AQM算法，为输出队列维护着一个加权平均值。如果平均队列小于最小阈值minth，当一个分组到达时，该分组被接纳进队列；如果队列满或平均队列长度大于最大阈值maxth，则当一个分组到达时，该分组被标记湖丢弃；如果一个分组到达，发现平均队列长度在[minth, maxth]之间时，则该分组以某种概率被标记或丢弃。</p>
<p>线路前部（HOL）阻塞：在一个输入队列中排队的分组必须等待通过交换结构方法送，因为它被位于线路前部的另一个分组所阻塞。</p>
<h3 id="路由选择控制平面"><a href="#路由选择控制平面" class="headerlink" title="路由选择控制平面"></a>路由选择控制平面</h3><p>网络范围的路由选择控制平面是分布式的，不同部分执行在不同的路由器上并且通过彼此发送控制报文进行交互。</p>
<h2 id="网际协议：因特网中的转发与编址"><a href="#网际协议：因特网中的转发与编址" class="headerlink" title="网际协议：因特网中的转发与编址"></a>网际协议：因特网中的转发与编址</h2><p>因特网控制报文协议（ICMP）：因特网的网络层差错和信息报告的协议。</p>
<h3 id="数据报格式"><a href="#数据报格式" class="headerlink" title="数据报格式"></a>数据报格式</h3><p>IPv4数据报中的关键字段如下：</p>
<ul>
<li><code>版本（号）</code>：这4比特规定了数据报的IP协议版本，通过查看版本号，路由器能够确定如何解释IP数据报的剩余部分。</li>
<li><code>首部长度</code>：IPv4数据报可包含一些可变数量的选项，故需要用这4比特来确定IP数据报中数据部分实际从哪里开始，大多数IP数据报不包含选项，具有20字节的首部。</li>
<li><code>服务类型</code>：服务类型（TOS）包含在IPv4首部中，以便使不同类型的IP数据报（例如实时数据报和非实时流量）能够互相区别开来。</li>
<li><code>数据报长度</code>：这是IP数据报的总长度，以字节计，字段长度为16比特，故IP数据报的理论最大长度为65535字节。</li>
<li><code>标识、标志、片偏移</code>：这三个字段与IP分片有关，新版本的IPv6不允许在路由器上对分组分片。</li>
<li><code>寿命（TTL）</code>：用来确保数据不会永远在网络中循环。每当数据报由一台路由器处理时，该字段的值减1，若TTL减为0，则该数据报必须丢弃。</li>
<li><code>协议</code>：指示了IP数据报的数据部分应该交给哪个特定的运输层协议。协议是将网络层与运输层丙丁到一起的粘合剂，而端口号是将运输层和应用层绑定到一起的粘合剂。</li>
<li><code>首部检验和</code>：用于帮助路由器检测收到的IP数据报中的比特错误。计算方法：将首部中的每2个字节当作一个数，用反码运算对这些数求和，该和的反码存放在检验和字段中。路由器对每个收到的IP数据报计算其首部检验和，若计算结果与字段值不一致，则丢弃该数据报。</li>
<li><code>源和目的IP地址</code>。</li>
<li><code>选项</code>：IP首部的扩展字段。</li>
<li><code>数据（有效载荷</code>）。</li>
</ul>
<h4 id="IP数据报分片"><a href="#IP数据报分片" class="headerlink" title="IP数据报分片"></a>IP数据报分片</h4><p><code>最大传送单元（MTU）</code>：一个链路层帧能承载的最大数据量。由于链路层协议的MTU严格地限制着IP数据报的长度，故将IP数据报中的数据分片成两个或更多个较小的IP数据报，用单独的链路层帧封装这些较小的IP数据报，然后向输出链路上发送这些帧。</p>
<p>分片发生在路由器中，发送主机为初始数据报设置源和目的地址和标识号。当路由器对其进行分片时，每个新数据报具有初始数据报的源地址、目的地址和标识号。最后一个片的标志比特被设为0，其它片的比特被设为1，偏移字段指定该片应该放在初始IP数据报的哪个位置。</p>
<h3 id="IPv4编址"><a href="#IPv4编址" class="headerlink" title="IPv4编址"></a>IPv4编址</h3><p>一台路由器有多个接口，每个接口和多个主机接口的网络形成一个子网，每个子网具有一个子网掩码，形如223.1.1.0/24，子网内的主机接口具有223.1.1.xxx形式的IP地址。注意：路由器接口之间也能形成子网。<br><code>接口</code>：主机与物理链路之间的边界。<br><code>无类别域间路由选择（CIDR）</code>：因特网的地址分配策略。<br>CIDR子网寻址：32比特的IP地址被划分为两部分，具有点分十进制数形式a.b.c.d/x，其中x指示了地址第一部分中的比特数。  地址的x最高比特构成了IP地址的网络部分，经常被称为该地址的前缀，组织内部的设备的IP地址将共享相同的前缀。<br><code>分类编址</code>：在CIDR被采用之前的编址方案，具有8、16或24比特子网地址的子网被称为A、B和C类网络。</p>
<p><code>获取一块地址</code>：从ISP获取一组地址；ISP从ICANN获取一块地址。<br><code>获取主机地址</code>：主机地址可以手工配置，也可以通过<code>动态主机配置协议（DHCP）</code>来获取。管理员通过配置DHCP，给定主机每次与网络连接时能得到一个相同的IP地址，或者给主机分配一个临时的IP地址。</p>
<p>DHCP协议的4个步骤：</p>
<ul>
<li><code>DHCP服务器发现</code>：一台新到的主机发现一个要与其交互的DHCP服务器，通过DHCP发现报文来完成。客户在UDP分组中向端口67发送该发现报文。DHCP发现报文的IP数据报中包含广播目的地址255.255.255.255并且使用本机源地址0.0.0.0。</li>
<li><code>DHCP服务器提供</code>：DHCP服务器用DHCP提供报文向DHCP发现报文作出响应。每台服务器提供的报文包含有收到的发现报文的事务ID、向客户推荐的IP地址、网络掩码以及IP地址租用期</li>
<li><code>DHCP请求</code>：新到达的客户从一个或多个服务器提供中选择一个，并向选中的服务器提供用一个DHCP请求报文进行响应，回显配置参数。</li>
<li><code>DHCP ACK</code>：服务器用DHCP ACK报文对DHCP请求报文进行响应，证实所要求的参数。</li>
</ul>
<h4 id="网络地址转换"><a href="#网络地址转换" class="headerlink" title="网络地址转换"></a>网络地址转换</h4><p><code>具有专用地址的地域</code>：其地址基金对该网络中的设备有意义的网络。<br><code>网络地址转换（NAT）</code>：NAT使能的路由器提供向SOHO内的设备提供IP地址空间，该地址仅在给定的网络中有意义，且同一网络中的设备能使用该地址收发分组。所有离开家庭路由器的报文都拥有一个源IP地址，且所有进入家庭的报文都拥有同一个目的地址。NAT使能路由器对外界隐藏了家庭网络的细节。</p>
<p>路由器通过保持一张NAT转换表来识别报文应该转发分组到哪个内部主机。NAT转换表中包含了端口号及其IP地址。</p>
<h4 id="UPnP"><a href="#UPnP" class="headerlink" title="UPnP"></a>UPnP</h4><p>NAT穿越越来越多地由通用即插即用（UPnP）提供，UPnP是一种允许主机发现并配置邻近NAT的协议。<br>UPnP允许外部主机使用TCP或UDP向NAT化的主机发起通信会话。</p>
<h3 id="因特网控制报文协议（ICMP）"><a href="#因特网控制报文协议（ICMP）" class="headerlink" title="因特网控制报文协议（ICMP）"></a>因特网控制报文协议（ICMP）</h3><p>ICMP被主机和路由器用来彼此沟通网络层的信息。<br>ICMP报文承载于IP分组之中，ICMP报文有一个类型字段和一个编码字段，并且包含引起该ICMP报文首次生成的IP数据报的首部和前8字节内容。</p>
<h2 id="路由选择算法"><a href="#路由选择算法" class="headerlink" title="路由选择算法"></a>路由选择算法</h2><p>此部分内容较为复杂，不适合摘要，建议阅读文档。</p>
<blockquote>
<p>还有链路层、计算机网络安全和网络管理等内容没有摘要，这项工作需要大量的时间，这部分先到此为止。</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/05/%E7%BD%91%E7%BB%9C%E5%B1%82/" data-id="ckja57eee0008fq1339dievx9" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-运输层" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/03/02/%E8%BF%90%E8%BE%93%E5%B1%82/" class="article-date">
  <time datetime="2019-03-02T10:25:33.000Z" itemprop="datePublished">2019-03-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/03/02/%E8%BF%90%E8%BE%93%E5%B1%82/">运输层</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="运输层"><a href="#运输层" class="headerlink" title="运输层"></a>运输层</h1><p><code>运输层</code>位于<code>应用层</code>和<code>网络层</code>之间，为运行在不同主机上的应用进程提供直接的通信服务起着至关重要的作用。</p>
<h2 id="概述和运输层服务"><a href="#概述和运输层服务" class="headerlink" title="概述和运输层服务"></a>概述和运输层服务</h2><p>运输层协议为运行在不同主机上的应用进程之间提供了逻辑通信，即不同主机上的进程能彼此发送报文而无需考虑承载这些报文的物理基础的细节。  </p>
<p>端系统实现运输层协议，而非路由器。在发送端，运输层将从应用程序进程接收到的把稳转换成运输层分组（即运输层报文段）并向目的地发送；在接收端，网络层从数据报中提取出运输层报文，并将该报文段上交给运输层，运输层从数据报中提取运输层报文段，并将该报文段向上交给运输层。运输层处理接收到的报文段，使该报文段中的数据为接收应用进程使用。</p>
<p>网络应用程序可以使用多种的运输层协议，因特网中有<code>TCP</code>和<code>UDP</code>，每种协议都能为调用的应用程序提供一组不同的运输层服务。</p>
<h3 id="运输层和网络层的关系"><a href="#运输层和网络层的关系" class="headerlink" title="运输层和网络层的关系"></a>运输层和网络层的关系</h3><p>在协议栈中，运输层位于网络层之上。网络层提供了主机之间的逻辑通信，而运输层协议为运行在不同主机上的进程之间提供了逻辑通信。</p>
<p>计算机网络可以安排多种运输层协议，每种协议为应用程序提供不同的服务模型。运输层协议将来自应用进程的报文移动到网络边缘，但对有关这些报文在网络核心中如何移动不做任何规定。中间路由器既不处理也不识别运输层加在运输层报文中的任何信息。</p>
<p>运输协议能够提供的服务常常受制于底层网络协议的服务模型。如果网络层协议无法为主机之间发送的报文提供时延和带宽保证的话，运输层也就无法为进程之间发送的应用层报文提供时延或带宽保证。</p>
<p>底层网络协议不能在网络层提供相应的服务，运输层协议也能提供某些服务。例如，网络层协议会使分组丢失、篡改和冗余，运输协议也能为应用程序提供可靠的数据传输服务；即使网络层不能保证运输层报文段的机密性，运输协议也能使用加密来确保应用程序报文不被入侵者读取。</p>
<h3 id="因特网运输层概述"><a href="#因特网运输层概述" class="headerlink" title="因特网运输层概述"></a>因特网运输层概述</h3><p>因特网网络层协议即<code>网际协议（IP）</code>，它的服务模型是提供<code>尽力而为交付服务（best-effort delivery service）</code>。它尽最大的努力在通信的主机之间交付报文段，但不做任何确保，即<code>不确保交付、报文段的顺序、报文段的完整性</code>，故被称为不可靠服务。</p>
<p>UDP和TCP最基本的责任是，将两个端系统间IP的交付服务扩展为运行在端系统上的两个进程之间的交付服务。将主机间交付扩展到进程间交付被称为<code>运输层的多路复用与多路分解</code>。</p>
<p>TCP和UDP可以通过在其报文段首部中包括差错检测字段提供完整性检查。进程到进程的<code>数据交付</code>和<code>差错检查</code>是两种最低限度的运输层服务，也是UDP所能提供的仅有的两种服务。UDP流量不可调节，应用程序可以根据其需要以其愿意的任何速率发送数据。</p>
<p>TCP为应用程序提供了可靠数据传输，通过使用流量控制、序号、确认和定时器，TCP能确保按序地、正确地将数据从发送进程交付给接收进程。TCP还提供拥塞控制，它防止任何一条TCP连接用过多流量来淹没通信主机间的链路和交换设备。</p>
<h2 id="多路复用与多路分解"><a href="#多路复用与多路分解" class="headerlink" title="多路复用与多路分解"></a>多路复用与多路分解</h2><p><code>多路分解</code>：将运输层报文段中的数据交付到正确的套接字中的工作。<br><code>多路复用</code>：在源主机从不同套接字中收集数据块，并为每个数据块封装上首部信息从而生成报文段，然后将报文段传递到网络层的工作。</p>
<p>运输层多路复用要求：</p>
<blockquote>
<ol>
<li>套接字有唯一的标识符；  </li>
<li>每个报文段都有特殊字段来指示该报文段所要交付到的套接字，这些特殊字段是<code>源端口号</code>和<code>目的端口号</code>字段。</li>
</ol>
</blockquote>
<p>在主机上的每个套接字能够分配一个端口号，当报文段到达主机时，运输层检查报文段中的目的端口号，并将其定向到相应的套接字。然后报文段中的数据通过套接字进入其所连接的进程。</p>
<h3 id="无连接的多路复用与多路分解"><a href="#无连接的多路复用与多路分解" class="headerlink" title="无连接的多路复用与多路分解"></a>无连接的多路复用与多路分解</h3><p>一个UDP套接字是由一个二元组来全面标识的，该二元组包含一个目的IP地址和一个目的端口号。</p>
<h3 id="面向连接的多路复用与多路分解"><a href="#面向连接的多路复用与多路分解" class="headerlink" title="面向连接的多路复用与多路分解"></a>面向连接的多路复用与多路分解</h3><p>TCP套接字是由一个四元组（源IP地址，源端口号，目的IP地址，目的端口号）来标识的，两个具有不同IP地址或端口号的到达TCP报文将被定向到两个不同的套接字，除非TCP报文携带了初始创建连接的请求。</p>
<h3 id="web服务与TCP"><a href="#web服务与TCP" class="headerlink" title="web服务与TCP"></a>web服务与TCP</h3><p>当客户向web服务器发送报文段时，所有的报文段（包括初始连接建立报文段和承载HTTP请求的报文段）的目的端口都是80。</p>
<p>如果客户与服务器使用持续HTTP，则在整条连接持续期间，客户与服务器之间经由同一个服务器套接字交换HTTP报文。如果客户与服务器使用非持续HTTP，则对每一对请求/响应都创建一个新的TCP连接并在随后关闭。</p>
<h2 id="无连接运输：UDP"><a href="#无连接运输：UDP" class="headerlink" title="无连接运输：UDP"></a>无连接运输：UDP</h2><p>UDP只做了运输协议能够做的最少工作：复用/分解功能、少量的差错检测。</p>
<p>UDP的优点：</p>
<blockquote>
<p>1.关于何时、发送什么数据的应用层控制更为精细。<br>2.无需建立连接，不会引入建立连接的时延。<br>3.无连接状态。TCP需要在端系统中维护连接状态。这个状态包括接收和发送缓存、拥塞控制参数以及序号和确认号的参数。<br>4.分组首部开销小。每个TCP报文段都有20字节的首部开销，而UDP仅有8字节的开销。</p>
</blockquote>
<p>UDP的应用：RIP路由选择表的更新、承载网络管理数据（SNMP）、流式音频应用。</p>
<h3 id="UDP报文段结构"><a href="#UDP报文段结构" class="headerlink" title="UDP报文段结构"></a>UDP报文段结构</h3><p>UDP首部有四个字段，每个字段由两个字节组成。</p>
<blockquote>
<p>1.源端口号；<br>2.目的端口号；<br>3.长度字段：指示了在UDP报文段中的字节数（首部加数据）；<br>4.检验和：用来检查在该报文段中是否出现了差错。</p>
</blockquote>
<h3 id="UDP检验和"><a href="#UDP检验和" class="headerlink" title="UDP检验和"></a>UDP检验和</h3><p>UDP检验和提供了差错检测功能，检验和用于确定当UDP报文段从源到达目的地移动时，其中的比特是否发生了改变。</p>
<p>发送方的UDP对报文段中的所有16比特字的和进行反码运算，求和时遇到的任何溢出都被回卷。得到的结果被放在UDP报文段中的检验和字段。</p>
<p>在接收方，全部的16比特字（包括检验和）加在一起，如果该分组没有引入差错，则在接收方处该和将是1111111111111111。</p>
<p>UDP检验和的必要性：由于不能保证源和目的之间的所有链路都提供差错检测，也无法确保在传输时路由器内存中不引入差错，无法确保逐链路的可靠性，又无法确保内存中的差错检测，UDP就必须在端到端基础上在运输层提供差错检测。</p>
<p>虽然UDP提供差错检测，但它不提供差错恢复，当报文中出现差错时，UDP丢弃受损的报文或向应用程序交付报文段并给出警告。</p>
<h2 id="可靠数据传输"><a href="#可靠数据传输" class="headerlink" title="可靠数据传输"></a>可靠数据传输</h2><p><code>可靠数据传输协议</code>的服务抽象是：数据可以通过一条可靠的信道进行传输。<br>即：</p>
<blockquote>
<p>1.传输数据比特不会受到损坏或丢失；<br>2.所有数据都是按照其发送顺序进行交付。</p>
</blockquote>
<h3 id="构造可靠数据传输协议"><a href="#构造可靠数据传输协议" class="headerlink" title="构造可靠数据传输协议"></a>构造可靠数据传输协议</h3><p><code>自动重传请求（ARQ）协议</code>：接收方向发送方发送控制报文，使得接收方可以让发送方知道哪些内容被正确接收，哪些内容接收有误并因此需要重复。</p>
<p>ARQ协议中的功能：</p>
<blockquote>
<p>1.差错检测；<br>2.接收方反馈：肯定确认（ACK）和否定确认（NAK）；<br>3.重传</p>
</blockquote>
<p>考虑受损ACK和NAK的情况，当发送方收到含糊不清的ACK和NAK分组时，只需重传当前的数据分组即可。另一个解决办法是在数据分组中添加一新字段，将发送数据分组的序号放在该字段，接收方只需检测序号即可确定收到的分组是否一次重传。  </p>
<p>基于时间的重传机制，引入<code>倒计数定时器</code>：在一个给定的时间量过期后，可中断发送方。<br>发送方需要做到：</p>
<blockquote>
<p>1.每次发送一个分组时，便启动一个定时器；<br>2.响应定时器中断（采取适当的动作）；<br>3.终止定时器。</p>
</blockquote>
<p>通过使用检验和、序号、定时器、肯定和否定确认分组技术，可实现可靠数据传输。</p>
<h3 id="流水线可靠数据传输服务"><a href="#流水线可靠数据传输服务" class="headerlink" title="流水线可靠数据传输服务"></a>流水线可靠数据传输服务</h3><p>停等协议：在发送方确信接收方已正确接收当前分组之前，发送方将不会发送一块新数据。停等协议的方法送分利用率非常低，为了解决这一问题，引入了以下技术。<br><code>流水线</code>：不使用停等方式运行，允许发送方发送多个分组而无需等待确认。<br>流水线技术对可靠数据传输协议可带来如下影响：  </p>
<blockquote>
<p>1.必须增加序号范围<br>2.协议的发送方和接收方两端也必须缓存多个分组。<br>3.所需序号范围和对缓冲的要求取决于数据传输协议如何处理丢失、损坏及延时过大的分组。解决流水线的差错恢复有两种基本方法是：<code>回退N步（GBN）</code>、<code>选择重传（SR）</code>。</p>
</blockquote>
<h3 id="回退N步"><a href="#回退N步" class="headerlink" title="回退N步"></a>回退N步</h3><p><code>回退N步（GBN）协议</code>：允许发送方发送多个分组而不需等待确认，但它也受限于在流水线中未确认的分组数不能超过某个最大允许数。<br>回退N步协议保持一个在序号范围内长度为N的窗口，是出于流量控制，对发送方施加限制。<br>GBN发送方必须响应三种类型的事件：  </p>
<blockquote>
<p>1.上层的调用，响应上层调用时，发送方首先检测发送窗口是否已满：若窗口未满，则产生一个分组并将其发送；若窗口未满发送方只需将数据返回给上层，隐式地指示上层窗口已满。<br>2.收到一个ACK：对分组的确认采用累积确认的方式，表明接收方已正确收到序号为n的以前包括n在内的所有分组。<br>3.超时事件：如果出现超时，发送方重传所有已发送但还未被确认过的分组，如果收到一个ACK，但仍有已发送但未被确认的分组，则定时器被重新启动。如果没有已发送但未被确认的分组，该定时器被终止。  </p>
</blockquote>
<p>GBN接收方的动作：如果一个序号为n的分组被正确接收到，<code>并且按序</code>，则接收方为分组n发送一个ACK，并将该分组中的数据部分交付到上层。在其它所有情况下，丢弃该分组，并为最近按序接收的分组重新发送ACK。  </p>
<p>在GBN中，发送方必须维护窗口的上下边界及nextseqnum在该窗口中的位置，但接收方需要维护的唯一信息就是下一个按序接收的分组的序号。</p>
<h3 id="选择重传"><a href="#选择重传" class="headerlink" title="选择重传"></a>选择重传</h3><p>随着信道差错率的增加，流水线可能会被这些不必要重传的分组所充斥，选择重传（SR）协议通过让对方仅重传那些它怀疑在接收方出错的分组而避免了不必要的重传。</p>
<p>SR发送方的事件与动作：</p>
<blockquote>
<p>1.从上层收到数据：从上层收到数据后，SR发送方检查下一个可用于该分组的序号，若序号位于发送方的窗口内，则将数据打包发送，否则同GBN。<br>2.超时：每个分组必须拥有自己的逻辑定时器，超时发生后只能发送一个分组。<br>3.收到ACK：若ACK对应分组的序号在窗口内，则SR发送方将那个被确认的分组标记为已接收，过序号为send_base，则移动窗口到具有最小序号的未确认分组处。窗口移动了且有序号落在窗口内的未发送分组，则发送这些分组。  </p>
</blockquote>
<p>SR接收方的事件与动作：</p>
<blockquote>
<p>1.序号在[rcv_base, rcv_base+N-1]内的分组被正确接收：收到的分组落在接收方的窗口内，一个选择ACK被回送给发送方。若该分组以前没有收到过，则缓存该分组。如果该分组的序号等于接收窗口的基序号（rcv_base），则该分组以及以前缓存的序号连续的分组交付给上层。然后，接收窗口按向前移动分组的编号向上交付这些分组。<br>2.序号在[rcv_base-N, rcv_base-1]内的分组被正确收到：必须产生一个ACK，即使该分组时接收方以前已确认过的分组。<br>3.其它情况：忽略该分组。  </p>
</blockquote>
<p>应用SR协议时，窗口长度必须小于或等于序号空间大小的一半。</p>
<h2 id="面向连接的运输：TCP"><a href="#面向连接的运输：TCP" class="headerlink" title="面向连接的运输：TCP"></a>面向连接的运输：TCP</h2><p>TCP实现可靠数据传输，依赖于差错检测、重传、累积确认、定时器以及用于序号和确认号的首部字段。  </p>
<h3 id="TCP连接"><a href="#TCP连接" class="headerlink" title="TCP连接"></a>TCP连接</h3><p>TCP的连接状态会完全保留在两个端系统中。中间的网络元素不会维持TCP连接状态。中间路由器对TCP连接完全视而不见，它们看到的是数据报，而不是连接。</p>
<p>TCP连接提供的是全双工服务，应用层数据可在从进程B流向进程A的同时，也从进程A流向进程B。</p>
<p><code>最大报文长度（MSS）</code>：TCP可从缓存中取出并放入报文段中的数据量受限于MSS（报文段里应用层数据的最大长度，不包括TCP首部），MSS通常根据最初确定的由本地发送主机发送的最大链路层帧长度（即<code>最大传输单元MTU</code>）来设置。MSS的值要保证一个TCP报文段加上TCP/IP首部长度将适合单个链路层帧，以太网和PPP链路层协议都具有1500字节的MTU，MSS的典型值为1460字节。</p>
<p>TCP数据传输过程：TCP为每块客户数据配上一个TCP首部，从而形成多个TCP报文段，这些报文段被下传给网络层，网络层将其分别封装在网络层IP数据报中。然后这些IP数据报被发送到网络中。当TCP在另一端接收到一个报文段后，该报文段的数据就被放入该TCP连接的接收缓存中，应用程序从此缓存中读取数据流。</p>
<p>TCP的连接组成包括：发送方和接收方两台主机上的缓存、变量和与进程连接的套接字。</p>
<h3 id="TCP报文段结构"><a href="#TCP报文段结构" class="headerlink" title="TCP报文段结构"></a>TCP报文段结构</h3><p>TCP报文段由首部字段和一个数据字段组成。数据字段包含一块应用数据。</p>
<p>首部一般是20字节，其结构为：</p>
<blockquote>
<p>1.<code>源端口号</code>和<code>目的端口号</code>：用于多路复用/分解来自或送到上层应用的数据；<br>2.<code>检验和字段</code>；<br>3.32比特的<code>序号字段</code>和32比特的<code>确认号字段</code>：被TCP发送方和接收方用来实现可靠数据传输服务；<br>4.16比特的<code>接收窗口字段</code>：用于流量控制，指示接收方愿意接受的字节数量；<br>5.4比特的<code>首部长度字段</code>：指示了以32比特的字节为单位的TCP首部长度；<br>6.可选与变长的<code>选项字段</code>：用于发送方与接收方协商最大报文段（MSS）时，或在告诉网络环境下用作窗口调节因子时使用；<br>7.6比特的<code>标志字段</code>：ACK比特用于指示确认字段中的值是有效的，RST、SYN和FIN比特用于连接建立和拆除。当PSH比特被设置的时候，指示接收方应立即将数据交给上层，URG比特用来指示报文段里存在着被发送端的上层实体置为“紧急”的数据，紧急数据存在并给出指向紧急数据尾的指针的时候，TCP必须通知接收端的上层实体。</p>
</blockquote>
<h4 id="序号和确认号"><a href="#序号和确认号" class="headerlink" title="序号和确认号"></a>序号和确认号</h4><p>这是TCP报文段首部中两个最重要的字段。</p>
<p>报文段的序号是该报文段首字节的字节流编号，一条TCP连接的双方均可随机地选择初始编号。</p>
<p>累积确认：TCP只确认该流中至第一个丢失字节为止的字节。</p>
<h3 id="往返时间的估计与超时"><a href="#往返时间的估计与超时" class="headerlink" title="往返时间的估计与超时"></a>往返时间的估计与超时</h3><p>大多数TCP的实现仅在某个时刻做一次SampleRTT(样本往返时间）测量，且绝不为已被重传的报文段就算SampleRTT。<br>一旦获得一个新SampleRTT时，TCP就会根据下列公式来更新EstimatedRTT:  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EstimatedRTT&#x3D;(1-a)*EstimatedRTT+a*SampleRTT</span><br></pre></td></tr></table></figure>

<p>[RFC 6298]中给出的a的参考值为0.125，这种平均被称为指数加权移动平均（EWMA）。  </p>
<p>RTT偏差DevRTT，用于估算SampleRTT一般会偏离EstimatedRTT的程度：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DevRTT&#x3D;(1-b)*DevRTT+b|DevRTT-EstimatedRTT|</span><br></pre></td></tr></table></figure>

<p>b的推荐值为0.25，如果SampleRTT的值波动较小，DevRTT的值就会变小，vise verse。</p>
<p>TCP重传超时间隔TimeoutInterval:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TimeoutInterval&#x3D;EstimatedRTT+4*DevRTT</span><br></pre></td></tr></table></figure>

<p>推荐的初始TimeoutInterval值为1秒，当出现超时后，TimeoutInterval的值将加倍。</p>
<h3 id="可靠数据传输-1"><a href="#可靠数据传输-1" class="headerlink" title="可靠数据传输"></a>可靠数据传输</h3><p>TCP的可靠数据传输服务确保一个进程从其接收缓存中读出的数据流是无损坏、无间隔、非冗余和按序的数据流。</p>
<p>TCP只用超时来恢复报文段的丢失，TCP与发送和重传有关的主要事件：</p>
<blockquote>
<p>1.从应用程序接收数据：TCP从应用程序接收数据，将数据封装在一个报文段中，并把该报文段交给IP，TCP启动定时器，定时器的过期间隔是TimeoutInterval。<br>2.超时：TCP通过重传引起超时的报文段来响应超时事件。然后重启定时器。<br>3.接收方确认报文段（ACK）的到达：TCP将ACK的值y与它的变量SendBase进行比较，如果y大于SendBase，则该ACK是在确认一个或多个先前未被确认的报文段，发送方更新它的SendBase变量；若当前有未被确认的报文段，TCP还要重启定时器。</p>
</blockquote>
<p>超时时间间隔加倍：每次TCP重传时都将下一次的超时间隔设为先前的两倍，每当定时器在收到上层应用的数据或收到ACK时，TimeoutInterval由最近的EstimatedRTT和DevRTT值推算得到。</p>
<p>快速重传：一旦收到3个冗余ACK，TCP就在该报文段的定时器过期之前重传丢失的报文段。</p>
<h3 id="流量控制"><a href="#流量控制" class="headerlink" title="流量控制"></a>流量控制</h3><p>流量控制将发送方的速率与接收方应用程序的读取速率相匹配，意在消除发送方使接收方缓存溢出的可能性。</p>
<p>TCP通过让发送方维护一个称为接收窗口的变量来提供流量控制。  </p>
<p>下式必须成立：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LastByteRcvd-LastByteRead&lt;&#x3D;RcvBuffer</span><br></pre></td></tr></table></figure>

<p>接收窗口rwnd根据可用空间的数量来设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rwnd&#x3D;RcvBuffer-[LastByteRead-LastByteRcvd]</span><br></pre></td></tr></table></figure>

<p>发送方在连接的整个生命周期内必须保证：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LastByteSent-LastByteAcked&lt;&#x3D;rwnd</span><br></pre></td></tr></table></figure>

<p>当接收方的接收窗口为0时，发送方继续发送只有一个字节数据的报文段。这些报文段将会被接收方确认，当缓存开始清空，确认报文里将包含一个非0的rwnd值。</p>
<h3 id="TCP连接管理"><a href="#TCP连接管理" class="headerlink" title="TCP连接管理"></a>TCP连接管理</h3><p>三次握手：</p>
<blockquote>
<p>1.客户端TCP首先向服务端的TCP发送一个特殊的报文段，该报文中不包含应用层数据，但是在报文段首部的标志位（SYN比特）被置为1。客户随机选择一个初始序号（client_isn），并将此编号防止在起始的TCP SYN报文段的序号字段中；<br>2.包含TCP SYN报文段的IP数据报到达服务器主机，服务器从该数据报中提取出TCP SYN报文段，为该TCP连接分配TCP缓存和变量，并向客户TCP发送允许连接的报文段（SYNACK报文段）。该报文段中SYN比特被置为1，首部的确认号字段被置为client_isn+1。服务器选择自己的初始序号（server_isn），并将其防止到TCP报文段首部的序号字段中；<br>3.客户收到SYNACK报文段后，为该连接分配缓存和变量，客户主机性服务器发送另外一个报文段，这最后一个报文段对服务器的允许连接的报文段进行了确认，SYN比特被置为0，确认报文可以在报文段负载中携带客户到服务器的数据。</p>
</blockquote>
<p>建立连接后的每一个报文段中，SYN比特都将被置为0.</p>
<p>四次挥手：</p>
<blockquote>
<p>1.客户TCP向服务器进程发送一个特殊的TCP报文段，首部中的FIN比特标志位被置为1；<br>2.服务器收到该报文，向发送方回送一个确认报文段；<br>3.服务器发送它自己的终止报文段，其FIN比特被置为1；<br>4.客户对这个服务器的终止报文段进行确认。</p>
</blockquote>
<p>若服务器收到一个SYN请求，但端口号或源IP地址与该主机上进行中的套接字不匹配，则服务器向该主机发送一个特殊重置报文段。该报文段将RST标志位置为1。</p>
<h2 id="拥塞控制原理"><a href="#拥塞控制原理" class="headerlink" title="拥塞控制原理"></a>拥塞控制原理</h2><p>拥塞控制的必要性：若链路上的路由器具有无穷大缓存的路由器，当分组的到达速率接近链路容量时，分组经历巨大的排队时延；若链路上的路由器具有有限缓存，发送方发送速率过大引起路由器缓存溢出，发送方必须执行重传以补偿因缓存溢出而丢失的分组，当一个分组沿一条路径被丢弃时，每个上游路由器用于转发该分组到丢弃该分组而使用的传输容量被浪费。</p>
<h3 id="拥塞控制方法"><a href="#拥塞控制方法" class="headerlink" title="拥塞控制方法"></a>拥塞控制方法</h3><p><code>端到端拥塞控制</code>： 在此方法中，网络层没有为运输层拥塞控制提供显式支持，TCP使用增加的往返时延值作为网络拥塞程度增加的指示。</p>
<p><code>网络辅助的拥塞控制</code>：网络层构件向发送方提供关于网络中拥塞状态的显式反馈信息。在此方法中，网络层可用两种方法发送反馈信息：采用阻塞分组的形式、路由器标记或更新从发送方流向接收方分组中的某个字段来指示拥塞的产生。</p>
<h4 id="例子：ATM-ABR拥塞控制"><a href="#例子：ATM-ABR拥塞控制" class="headerlink" title="例子：ATM ABR拥塞控制"></a>例子：ATM ABR拥塞控制</h4><p><code>ATM</code>:异步传递方式网络<br><code>ABR</code>:可用比特率</p>
<p>对于ATM ABR服务，数据信源从源经过一系列中间交换机传输到目的地。在数据信源中夹杂着资源管理信元（RM信元），这些RM信元可被用来在主机和交换机之间传递与拥塞相关的信息。当一个RM信元到达目的地时，它将被调转方向并向发送方发送。交换机也有可能自己产生一个RM信元，并将该RM信元直接发送给源。</p>
<p>ABR提供三种机制用于从交换机向接收方发送与拥塞相关的信令信息：</p>
<blockquote>
<p><code>EFCI比特</code>：每个数据信元都包含1比特的显示转发拥塞指示（EFCI）比特，某拥塞网络的交换机可把一个数据信元中的EFCI比特置为1来向目的主机发送网络已经拥塞的信令。当RM信元到达目的地时，如果多数近来收到的数据信元的拥塞指示比特（CI比特）都被置为1，则目的地就会将RM信元的拥塞指示比特置为1，并将该RM信元发送回接收方。使用数据信元中的EFCI比特和RM信元中的CI比特，发送方因而能够在网络交换机拥塞时得到通知。<br><code>CI和NI比特</code>：RM信元的夹杂比率是一个可调参数，默认值是每32个数据信元中有一个RM信元。这些RM信元中有一个拥塞指示（CI）比特和无增长（NI）比特，这两个比特可被一台拥塞的交换机设置。交换机可在轻微拥塞时将经过的RM信元的NI比特置为1，在严重拥塞时，把CI比特置为1，目的主机收到RM信元时，把该RM信元发回给发送方而保持NI和CI比特不变。<br><code>ER的设置</code>：每一个RM信元还包含一个两字节的显式速率（ER）字段。拥塞的交换机也许会降低经过RM信元中ER字段所包含的值，ER字段将被设置为在源至目的地的路径上的所有交换机中的最小可支持速率。</p>
</blockquote>
<h2 id="TCP拥塞控制"><a href="#TCP拥塞控制" class="headerlink" title="TCP拥塞控制"></a>TCP拥塞控制</h2><p>TCP必须使用端到端拥塞控制而不是使用网络辅助的拥塞控制，因为IP层不向端系统提供显式的网络拥塞反馈。</p>
<p>TCP所使用的原则：</p>
<ul>
<li>一个丢失的报文段意味着拥塞，因此当丢失报文段时应降低TCP发送方的速率。一个超时事件或四个确认被解释为跟随报文段的丢包事件的隐含的指示，对此，TCP发送方应减小它的拥塞窗口长度以减小其发送速率。</li>
<li>一个确认报文段指示该网络正在向接收方交付发送方的报文段。因此，当对先前未确认报文段的确认到达时，能够增加发送方的速率。</li>
<li>带宽探测：TCP在ACK到达时增加其速率，当出现丢包时减小其速率。TCP发送方增加它的传输速率，从丢包时的速率后退，进而再次开始探测，看看拥塞开始速率是否发生了变化。</li>
</ul>
<p>TCP拥塞控制算法包括三个主要部分：<code>慢启动</code>、<code>拥塞避免</code>、<code>快速恢复</code>。</p>
<h3 id="慢启动"><a href="#慢启动" class="headerlink" title="慢启动"></a>慢启动</h3><p>TCP发送方希望迅速找到可用带宽的数量，在慢启动状态，cwnd的值以1个MSS开始并且每当传输的报文段首次被确认就增加一个MSS。</p>
<p>结束慢启动的三种方式：</p>
<ul>
<li>1.如果存在一个由超时指示的丢包事件，TCP发送方将cwnd设置为1MSS并重新开始慢启动过程。它还将第二个状态变量的值ssthresh（慢启动阈值）设置为cwnd/2。</li>
<li>2.当检测到拥塞时sstresh设为cwnd的一半，当达到或超过ssthresh的值时，结束慢启动并且TCP转移到<code>拥塞避免</code>模式。</li>
<li>3.当检测到3个冗余ACK，TCP执行一次快速重传并进入<code>快速恢复</code>状态。</li>
</ul>
<h3 id="拥塞避免"><a href="#拥塞避免" class="headerlink" title="拥塞避免"></a>拥塞避免</h3><p>TCP发送方无论何时到达一个新的确认，就将cwnd增加一个<code>MSS(MSS/cwnd)</code>字节。当丢包事件出现时,ssthresh的值被更新为cwnd的一半，当出现超时时，cwnd的值被设置为1MSS。</p>
<h3 id="快速恢复"><a href="#快速恢复" class="headerlink" title="快速恢复"></a>快速恢复</h3><p>在快速恢复中，对于引起TCP进入快速恢复状态的缺失报文段，对收到的每个冗余的ACK，cwnd的值增加一个MSS。最终，当对丢失报文段的一个ACK到达时，TCP在降低cwnd后进入拥塞避免状态。如果出现超时事件，快速恢复执行如同在慢启动和拥塞避免中的相同动作后，迁移到慢启动状态。</p>
<p>快速恢复是TCP推荐的而非必须的构建。</p>
<blockquote>
<p>四天时间摘要复习完运输层这一章，详细了解了运输层的运行机制，其中TCP拥塞控制这部分还需要反复琢磨。  </p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/03/02/%E8%BF%90%E8%BE%93%E5%B1%82/" data-id="ckja57eeh000cfq130wuu90uu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/6/">&amp;laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/8/">下一页 &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/celery/" rel="tag">celery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/" rel="tag">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E5%85%A8/" rel="tag">安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">杂谈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" rel="tag">编译原理</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 16.67px;">C#</a> <a href="/tags/celery/" style="font-size: 10px;">celery</a> <a href="/tags/docker/" style="font-size: 16.67px;">docker</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/python/" style="font-size: 13.33px;">python</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/tool/" style="font-size: 13.33px;">tool</a> <a href="/tags/web/" style="font-size: 16.67px;">web</a> <a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 10px;">安全</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 10px;">杂谈</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">算法</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 10px;">编译原理</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 16.67px;">网络</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/24/LeetCode-435-%E6%97%A0%E9%87%8D%E5%8F%A0%E5%8C%BA%E9%97%B4/">LeetCode-435. 无重叠区间</a>
          </li>
        
          <li>
            <a href="/2021/01/23/LeetCode-1319-%E8%BF%9E%E9%80%9A%E7%BD%91%E7%BB%9C%E7%9A%84%E6%93%8D%E4%BD%9C%E6%AC%A1%E6%95%B0/">LeetCode-1319. 连通网络的操作次数</a>
          </li>
        
          <li>
            <a href="/2021/01/22/LeetCode-989-%E6%95%B0%E7%BB%84%E5%BD%A2%E5%BC%8F%E7%9A%84%E6%95%B4%E6%95%B0%E5%8A%A0%E6%B3%95/">LeetCode-989. 数组形式的整数加法</a>
          </li>
        
          <li>
            <a href="/2021/01/21/LeetCode-1489-%E6%89%BE%E5%88%B0%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91%E9%87%8C%E7%9A%84%E5%85%B3%E9%94%AE%E8%BE%B9%E5%92%8C%E4%BC%AA%E5%85%B3%E9%94%AE%E8%BE%B9/">LeetCode-1489. 找到最小生成树里的关键边和伪关键边</a>
          </li>
        
          <li>
            <a href="/2021/01/20/LeetCode-628-%E4%B8%89%E4%B8%AA%E6%95%B0%E7%9A%84%E6%9C%80%E5%A4%A7%E4%B9%98%E7%A7%AF/">LeetCode-628. 三个数的最大乘积</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 IMTE<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>