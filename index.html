<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>IMTE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="IMTE">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="IMTE">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="IMTE">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="IMTE" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">IMTE</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-å­¦ä¹ æ•´ç†-Goè¯­è¨€å®æˆ˜/å­¦ä¹ æ•´ç†-Goè¯­è¨€å®æˆ˜" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/22/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/" class="article-date">
  <time datetime="2021-03-22T12:32:10.000Z" itemprop="datePublished">2021-03-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/22/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/">å­¦ä¹ æ•´ç†-Goè¯­è¨€å®æˆ˜</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>è¯»äº†ä¸¤éã€ŠGoè¯­è¨€å®æˆ˜ã€‹ï¼Œç¬¬äºŒéæ—¶æ•´ç†å‡ºä¸€ä»½<a target="_blank" rel="noopener" href="https://gitee.com/wanshousi/wanshousi/blob/master/2021/03/22/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/go.pdf">æ€ç»´å¯¼å›¾</a>ï¼ŒåŒ…å«äº†å…¶ä¸­å¾ˆå¤šæ¦‚å¿µæ€§çš„ä¸œè¥¿ã€‚  </p>
<p>Goè¯­è¨€çš„åŸºæœ¬ç±»å‹ä»¥åŠä¹¦ä¸­å¯¹ä¸€äº›æ ‡å‡†åº“ï¼ˆä¾‹å¦‚logåº“ã€JSONåº“ï¼‰çš„ç”¨æ³•ã€è‡ªè¡Œå°è£…ç”¨äºå¹¶å‘çš„åŒ…ï¼ˆrunnerã€poolã€workerï¼‰ä¸åœ¨æ€ç»´å¯¼å›¾æ‰€åˆ—ä¸¾çš„èŒƒå›´å†…ï¼Œæ¨èé˜…è¯»åŸä¹¦åŠå…¶æºç ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/22/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/" data-id="ckmkl7zp80000ou136yok19lg" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/go/" rel="tag">go</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-ä»å®¹å™¨æ„å»ºé•œåƒå¹¶æ¨é€åˆ°DockerHub" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/14/%E4%BB%8E%E5%AE%B9%E5%99%A8%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F%E5%B9%B6%E6%8E%A8%E9%80%81%E5%88%B0DockerHub/" class="article-date">
  <time datetime="2021-03-14T09:14:39.000Z" itemprop="datePublished">2021-03-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/14/%E4%BB%8E%E5%AE%B9%E5%99%A8%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F%E5%B9%B6%E6%8E%A8%E9%80%81%E5%88%B0DockerHub/">ä»å®¹å™¨æ„å»ºé•œåƒå¹¶æ¨é€åˆ°DockerHub</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å¤‡å¿˜ï¼šè®°å½•æ„å»ºé•œåƒåŠæé€çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ä¸­é€”çŠ¯çš„é”™è¯¯ã€‚</p>
<h3 id="æ„å»ºé•œåƒ"><a href="#æ„å»ºé•œåƒ" class="headerlink" title="æ„å»ºé•œåƒ"></a>æ„å»ºé•œåƒ</h3><h4 id="ä»dockerfileæ„å»º"><a href="#ä»dockerfileæ„å»º" class="headerlink" title="ä»dockerfileæ„å»º"></a>ä»<code>dockerfile</code>æ„å»º</h4><p>å¾…è¡¥å……</p>
<h4 id="ä»å®¹å™¨æ„å»º"><a href="#ä»å®¹å™¨æ„å»º" class="headerlink" title="ä»å®¹å™¨æ„å»º"></a>ä»å®¹å™¨æ„å»º</h4><ol>
<li>æŸ¥çœ‹å®¹å™¨ï¼Œåç»­éœ€è¦ç”¨åˆ°å®¹å™¨id</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# docker container ls</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS         PORTS                NAMES</span><br><span class="line">0315f9034090   nginx     &quot;/docker-entrypoint.â€¦&quot;   31 minutes ago   Up 9 minutes   0.0.0.0:80-&gt;80/tcp   webserver</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>docker commit</code>æ„å»ºé•œåƒ</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# docker commit -a &quot;wanshousi&quot; -m &quot;webserver for static file&quot; 0315f webserver:v1</span><br><span class="line">sha256:b333606909730ba0118a4849d89b513318e659d5ff6dfc018413da74620d1877</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ç™»é™†<code>DockerHub</code>ï¼ˆéœ€æå‰æ³¨å†Œè´¦å·ï¼‰</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# docker login</span><br><span class="line">Login with your Docker ID to push and pull images from Docker Hub. If you don&#x27;t have a Docker ID, head over to https://hub.docker.com to create one.</span><br><span class="line">Username: xxxxxx</span><br><span class="line">Password: </span><br><span class="line">WARNING! Your password will be stored unencrypted in /root/.docker/config.json.</span><br><span class="line">Configure a credential helper to remove this warning. See</span><br><span class="line">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span><br><span class="line"></span><br><span class="line">Login Succeeded</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>å°è¯•æ¨é€é•œåƒ</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# docker push wanshousi/webserver</span><br><span class="line">Using default tag: latest</span><br><span class="line">The push refers to repository [docker.io/wanshousi/webserver]</span><br><span class="line">An image does not exist locally with the tag: wanshousi/webserver</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>æŸ¥çœ‹é•œåƒidå¹¶é‡å‘½åé•œåƒ</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# docker images</span><br><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">webserver    v1        b33360690973   5 minutes ago   103MB</span><br><span class="line">nginx        latest    4f718772a0b3   2 days ago      103MB</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# docker tag b333 wanshousi/webserver:v1</span><br><span class="line">â”Œâ”€â”€(rootğŸ’€kali)-[~]</span><br><span class="line">â””â”€# docker images</span><br><span class="line">REPOSITORY            TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">webserver             v1        b33360690973   5 minutes ago   103MB</span><br><span class="line">wanshousi/webserver   v1        b33360690973   5 minutes ago   103MB</span><br><span class="line">nginx                 latest    4f718772a0b3   2 days ago      103MB</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>å†æ¬¡å°è¯•push</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â””â”€# docker push wanshousi/webserver:v1</span><br><span class="line">The push refers to repository [docker.io/wanshousi/webserver]</span><br><span class="line">edfbfcaa59c2: Pushed </span><br><span class="line">68b7ca5ee324: Mounted from library/nginx </span><br><span class="line">5154c456ef9c: Mounted from library/nginx </span><br><span class="line">580b3e8577cb: Mounted from library/nginx </span><br><span class="line">b42bdeeb83fb: Mounted from library/nginx </span><br><span class="line">ff4e67d1931f: Mounted from library/nginx </span><br><span class="line">6997d19cbb50: Mounted from library/nginx </span><br><span class="line">v1: digest: sha256:ef249b10cca6913499ba9b62637a0230c1204273e7956510d68c4c04c85c56ab size: 1778</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/14/%E4%BB%8E%E5%AE%B9%E5%99%A8%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F%E5%B9%B6%E6%8E%A8%E9%80%81%E5%88%B0DockerHub/" data-id="ckm8yhhth0000ht13e8ie5m9o" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/docker/" rel="tag">docker</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-æ ‘è“æ´¾æ·»åŠ æ— çº¿ç½‘ç»œ" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/13/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%B7%BB%E5%8A%A0%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C/" class="article-date">
  <time datetime="2021-03-13T15:29:18.000Z" itemprop="datePublished">2021-03-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/13/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%B7%BB%E5%8A%A0%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C/">æ ‘è“æ´¾æ·»åŠ æ— çº¿ç½‘ç»œ</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="ç°çŠ¶"><a href="#ç°çŠ¶" class="headerlink" title="ç°çŠ¶"></a>ç°çŠ¶</h3><p>ç›®å‰é€šè¿‡ç½‘çº¿è¿æ¥åˆ°æ ‘è“æ´¾ï¼Œåœ¨è·¯ç”±å™¨ç®¡ç†ç•Œé¢è·å–ipåœ°å€åé€šè¿‡sshè¿æ¥ã€‚</p>
<h3 id="æ·»åŠ æ— çº¿è¿æ¥çš„ssidå’Œå¯†ç "><a href="#æ·»åŠ æ— çº¿è¿æ¥çš„ssidå’Œå¯†ç " class="headerlink" title="æ·»åŠ æ— çº¿è¿æ¥çš„ssidå’Œå¯†ç "></a>æ·»åŠ æ— çº¿è¿æ¥çš„ssidå’Œå¯†ç </h3><p>è¿›å…¥<code>/etc/wpa_supplicant</code>ç›®å½•ï¼Œä½¿ç”¨<code>wpa_passphrase</code>å‘½ä»¤åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wpa_passphrase &quot;ssid&quot; &quot;phrase&quot; &gt; wpa_supplicant.conf</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­<code>ssid</code>ä¸ºç½‘ç»œåç§°ï¼Œä¾‹å¦‚<code>TP-LINK_XXXX</code>ï¼Œ<code>phrase</code>ä¸ºç½‘ç»œå¯†ç </p>
</blockquote>
<h3 id="ç¼–è¾‘ç½‘ç»œé…ç½®æ–‡ä»¶"><a href="#ç¼–è¾‘ç½‘ç»œé…ç½®æ–‡ä»¶" class="headerlink" title="ç¼–è¾‘ç½‘ç»œé…ç½®æ–‡ä»¶"></a>ç¼–è¾‘ç½‘ç»œé…ç½®æ–‡ä»¶</h3><p>é…ç½®æ–‡ä»¶ä¸º<code>/etc/network/interfaces</code>ï¼Œåœ¨æœ€ååŠ å…¥<code>wlan0</code>çš„é…ç½®åå…¨æ–‡å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">auto lo</span><br><span class="line">iface lo inet loopback</span><br><span class="line"></span><br><span class="line">auto eth0</span><br><span class="line">allow-hotplug eth0</span><br><span class="line">iface eth0 inet dhcp</span><br><span class="line"></span><br><span class="line">auto wlan0</span><br><span class="line">allow-hotplug wlan0</span><br><span class="line">iface wlan0 inet manual</span><br><span class="line">wpa-roam /etc/wpa_supplicant/wpa_supplicant.conf</span><br><span class="line">iface default inet dhcp</span><br></pre></td></tr></table></figure>

<h3 id="é‡å¯ç½‘ç»œ"><a href="#é‡å¯ç½‘ç»œ" class="headerlink" title="é‡å¯ç½‘ç»œ"></a>é‡å¯ç½‘ç»œ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm /run/wpa_supplicant/wlan0</span><br><span class="line">systemctl restart networking</span><br><span class="line">ifconfig</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.104  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        inet6 fe80::dea6:32ff:fe0f:10fe  prefixlen 64  scopeid 0x20&lt;link&gt;</span><br><span class="line">        ether dc:a6:32:0f:10:fe  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 1708  bytes 148032 (144.5 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 1006  bytes 198602 (193.9 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        inet6 ::1  prefixlen 128  scopeid 0x10&lt;host&gt;</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 4  bytes 200 (200.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 4  bytes 200 (200.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">wlan0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.1.103  netmask 255.255.255.0  broadcast 192.168.1.255</span><br><span class="line">        ether 7a:0b:c0:a9:d7:d4  txqueuelen 1000  (Ethernet)</span><br><span class="line">        RX packets 11  bytes 2790 (2.7 KiB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 6  bytes 2196 (2.1 KiB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/13/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%B7%BB%E5%8A%A0%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C/" data-id="ckm8qk3j30000cy13brqzetus" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-python3-6å­—å…¸çš„å˜åŒ–" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/03/07/python3-6%E5%AD%97%E5%85%B8%E7%9A%84%E5%8F%98%E5%8C%96/" class="article-date">
  <time datetime="2021-03-07T07:35:09.000Z" itemprop="datePublished">2021-03-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/03/07/python3-6%E5%AD%97%E5%85%B8%E7%9A%84%E5%8F%98%E5%8C%96/">python3.6å­—å…¸çš„å˜åŒ–</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç®€å•è¯´æ˜ï¼š<a target="_blank" rel="noopener" href="https://www.cnblogs.com/well-666/p/12097260.html">https://www.cnblogs.com/well-666/p/12097260.html</a></p>
<p>è¯¦ç»†è¯´æ˜ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/zhoulei124/article/details/96132625">https://blog.csdn.net/zhoulei124/article/details/96132625</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/07/python3-6%E5%AD%97%E5%85%B8%E7%9A%84%E5%8F%98%E5%8C%96/" data-id="cklyug98f0000hj136d3a270h" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Gin-Web-Framework" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/28/Gin-Web-Framework/" class="article-date">
  <time datetime="2021-02-28T12:47:42.000Z" itemprop="datePublished">2021-02-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/28/Gin-Web-Framework/">Gin Web Framework</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Gin æ˜¯ä¸€ä¸ªç”¨ Go (Golang) ç¼–å†™çš„ web æ¡†æ¶ã€‚ å®ƒæ˜¯ä¸€ä¸ªç±»ä¼¼äº <a target="_blank" rel="noopener" href="https://github.com/go-martini/martini">martini</a> ä½†æ‹¥æœ‰æ›´å¥½æ€§èƒ½çš„ API æ¡†æ¶, ç”±äº <a target="_blank" rel="noopener" href="https://github.com/julienschmidt/httprouter">httprouter</a>ï¼Œé€Ÿåº¦æé«˜äº†è¿‘ 40 å€ã€‚</p>
<h2 id="AsciiJSON"><a href="#AsciiJSON" class="headerlink" title="AsciiJSON"></a>AsciiJSON</h2><p>ä½¿ç”¨ AsciiJSON ç”Ÿæˆå…·æœ‰è½¬ä¹‰çš„é ASCII å­—ç¬¦çš„ <strong>ASCII-only JSON</strong>ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/someJSON&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		data := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">			<span class="string">&quot;lang&quot;</span>: <span class="string">&quot;GOè¯­è¨€&quot;</span>,</span><br><span class="line">			<span class="string">&quot;tag&quot;</span>:  <span class="string">&quot;&lt;br&gt;&quot;</span>,</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è¾“å‡º : &#123;&quot;lang&quot;:&quot;GO\u8bed\u8a00&quot;,&quot;tag&quot;:&quot;\u003cbr\u003e&quot;&#125;</span></span><br><span class="line">		c.AsciiJSON(http.StatusOK, data)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="PureJSON"><a href="#PureJSON" class="headerlink" title="PureJSON"></a>PureJSON</h2><p>é€šå¸¸ï¼ŒJSON ä½¿ç”¨ unicode æ›¿æ¢ç‰¹æ®Š HTML å­—ç¬¦ï¼Œä¾‹å¦‚ &lt; å˜ä¸º \ u003cã€‚å¦‚æœè¦æŒ‰å­—é¢å¯¹è¿™äº›å­—ç¬¦è¿›è¡Œç¼–ç ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ PureJSONã€‚Go 1.6 åŠæ›´ä½ç‰ˆæœ¬æ— æ³•ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// æä¾› unicode å®ä½“</span></span><br><span class="line">	r.GET(<span class="string">&quot;/json&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;html&quot;</span>: <span class="string">&quot;&lt;b&gt;Hello, world!&lt;/b&gt;&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// æä¾›å­—é¢å­—ç¬¦</span></span><br><span class="line">	r.GET(<span class="string">&quot;/purejson&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.PureJSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;html&quot;</span>: <span class="string">&quot;&lt;b&gt;Hello, world!&lt;/b&gt;&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SecureJSON"><a href="#SecureJSON" class="headerlink" title="SecureJSON"></a>SecureJSON</h2><p>ä½¿ç”¨ SecureJSON é˜²æ­¢ json åŠ«æŒã€‚å¦‚æœç»™å®šçš„ç»“æ„æ˜¯æ•°ç»„å€¼ï¼Œåˆ™é»˜è®¤é¢„ç½® <code>&quot;while(1),&quot;</code> åˆ°å“åº”ä½“ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªå·±çš„ SecureJSON å‰ç¼€</span></span><br><span class="line">	<span class="comment">// r.SecureJsonPrefix(&quot;)]&#125;&#x27;,\n&quot;)</span></span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/someJSON&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		names := []<span class="keyword">string</span>&#123;<span class="string">&quot;lena&quot;</span>, <span class="string">&quot;austin&quot;</span>, <span class="string">&quot;foo&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// å°†è¾“å‡ºï¼šwhile(1);[&quot;lena&quot;,&quot;austin&quot;,&quot;foo&quot;]</span></span><br><span class="line">		c.SecureJSON(http.StatusOK, names)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="HTML-æ¸²æŸ“"><a href="#HTML-æ¸²æŸ“" class="headerlink" title="HTML æ¸²æŸ“"></a>HTML æ¸²æŸ“</h2><p>ä½¿ç”¨ <code>LoadHTMLGlob()</code> æˆ–è€… <code>LoadHTMLFiles()</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.LoadHTMLGlob(<span class="string">&quot;templates/*&quot;</span>)</span><br><span class="line">	<span class="comment">//router.LoadHTMLFiles(&quot;templates/template1.html&quot;, &quot;templates/template2.html&quot;)</span></span><br><span class="line">	router.GET(<span class="string">&quot;/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;Main website&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>templates/index.tmpl</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">		&#123;&#123; .title &#125;&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ä¸åŒç›®å½•ä¸‹åç§°ç›¸åŒçš„æ¨¡æ¿</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.LoadHTMLGlob(<span class="string">&quot;templates/**/*&quot;</span>)</span><br><span class="line">	router.GET(<span class="string">&quot;/posts/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;posts/index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;Posts&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.GET(<span class="string">&quot;/users/index&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;users/index.tmpl&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;Users&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>templates/posts/index.tmpl</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; define &quot;posts/index.tmpl&quot; &#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">	&#123;&#123; .title &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Using posts/index.tmpl<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>templates/users/index.tmpl</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; define &quot;users/index.tmpl&quot; &#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">	&#123;&#123; .title &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Using users/index.tmpl<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰æ¨¡æ¿æ¸²æŸ“å™¨"><a href="#è‡ªå®šä¹‰æ¨¡æ¿æ¸²æŸ“å™¨" class="headerlink" title="è‡ªå®šä¹‰æ¨¡æ¿æ¸²æŸ“å™¨"></a>è‡ªå®šä¹‰æ¨¡æ¿æ¸²æŸ“å™¨</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;html/template&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	html := template.Must(template.ParseFiles(<span class="string">&quot;file1&quot;</span>, <span class="string">&quot;file2&quot;</span>))</span><br><span class="line">	router.SetHTMLTemplate(html)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰åˆ†éš”ç¬¦"><a href="#è‡ªå®šä¹‰åˆ†éš”ç¬¦" class="headerlink" title="è‡ªå®šä¹‰åˆ†éš”ç¬¦"></a>è‡ªå®šä¹‰åˆ†éš”ç¬¦</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r := gin.Default()</span><br><span class="line">r.Delims(<span class="string">&quot;&#123;[&#123;&quot;</span>, <span class="string">&quot;&#125;]&#125;&quot;</span>)</span><br><span class="line">r.LoadHTMLGlob(<span class="string">&quot;/path/to/templates&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="è‡ªå®šä¹‰æ¨¡æ¿åŠŸèƒ½"><a href="#è‡ªå®šä¹‰æ¨¡æ¿åŠŸèƒ½" class="headerlink" title="è‡ªå®šä¹‰æ¨¡æ¿åŠŸèƒ½"></a>è‡ªå®šä¹‰æ¨¡æ¿åŠŸèƒ½</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;html/template&quot;</span></span><br><span class="line">    <span class="string">&quot;net/http&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">formatAsDate</span><span class="params">(t time.Time)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    year, month, day := t.Date()</span><br><span class="line">    <span class="keyword">return</span> fmt.Sprintf(<span class="string">&quot;%d/%02d/%02d&quot;</span>, year, month, day)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    router := gin.Default()</span><br><span class="line">    router.Delims(<span class="string">&quot;&#123;[&#123;&quot;</span>, <span class="string">&quot;&#125;]&#125;&quot;</span>)</span><br><span class="line">    router.SetFuncMap(template.FuncMap&#123;</span><br><span class="line">        <span class="string">&quot;formatAsDate&quot;</span>: formatAsDate,</span><br><span class="line">    &#125;)</span><br><span class="line">    router.LoadHTMLFiles(<span class="string">&quot;./testdata/template/raw.tmpl&quot;</span>)</span><br><span class="line"></span><br><span class="line">    router.GET(<span class="string">&quot;/raw&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.HTML(http.StatusOK, <span class="string">&quot;raw.tmpl&quot;</span>, <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">            <span class="string">&quot;now&quot;</span>: time.Date(<span class="number">2017</span>, <span class="number">07</span>, <span class="number">01</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, time.UTC),</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>raw.tmpl</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Date: &#123;[&#123;.now | formatAsDate&#125;]&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><p>ä½¿ç”¨ JSONP å‘ä¸åŒåŸŸçš„æœåŠ¡å™¨è¯·æ±‚æ•°æ®ã€‚å¦‚æœæŸ¥è¯¢å‚æ•°å­˜åœ¨å›è°ƒï¼Œåˆ™å°†å›è°ƒæ·»åŠ åˆ°å“åº”ä½“ä¸­ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/JSONP&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		data := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;</span><br><span class="line">			<span class="string">&quot;foo&quot;</span>: <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// /JSONP?callback=x</span></span><br><span class="line">		<span class="comment">// å°†è¾“å‡ºï¼šx(&#123;\&quot;foo\&quot;:\&quot;bar\&quot;&#125;)</span></span><br><span class="line">		c.JSONP(http.StatusOK, data)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Multipart-Urlencoded-ç»‘å®š"><a href="#Multipart-Urlencoded-ç»‘å®š" class="headerlink" title="Multipart/Urlencoded ç»‘å®š"></a>Multipart/Urlencoded ç»‘å®š</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LoginForm <span class="keyword">struct</span> &#123;</span><br><span class="line">	User     <span class="keyword">string</span> <span class="string">`form:&quot;user&quot; binding:&quot;required&quot;`</span></span><br><span class="line">	Password <span class="keyword">string</span> <span class="string">`form:&quot;password&quot; binding:&quot;required&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.POST(<span class="string">&quot;/login&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// ä½ å¯ä»¥ä½¿ç”¨æ˜¾å¼ç»‘å®šå£°æ˜ç»‘å®š multipart formï¼š</span></span><br><span class="line">		<span class="comment">// c.ShouldBindWith(&amp;form, binding.Form)</span></span><br><span class="line">		<span class="comment">// æˆ–è€…ç®€å•åœ°ä½¿ç”¨ ShouldBind æ–¹æ³•è‡ªåŠ¨ç»‘å®šï¼š</span></span><br><span class="line">		<span class="keyword">var</span> form LoginForm</span><br><span class="line">		<span class="comment">// åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„ç»‘å®š</span></span><br><span class="line">		<span class="keyword">if</span> c.ShouldBind(&amp;form) == <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> form.User == <span class="string">&quot;user&quot;</span> &amp;&amp; form.Password == <span class="string">&quot;password&quot;</span> &#123;</span><br><span class="line">				c.JSON(<span class="number">200</span>, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;you are logged in&quot;</span>&#125;)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				c.JSON(<span class="number">401</span>, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;unauthorized&quot;</span>&#125;)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> curl -v --form user=user --form password=password http://localhost:8080/login</span></span><br></pre></td></tr></table></figure>

<h2 id="Multipart-Urlencoded-è¡¨å•"><a href="#Multipart-Urlencoded-è¡¨å•" class="headerlink" title="Multipart/Urlencoded è¡¨å•"></a>Multipart/Urlencoded è¡¨å•</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	router.POST(<span class="string">&quot;/form_post&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		message := c.PostForm(<span class="string">&quot;message&quot;</span>)</span><br><span class="line">		nick := c.DefaultPostForm(<span class="string">&quot;nick&quot;</span>, <span class="string">&quot;anonymous&quot;</span>)</span><br><span class="line"></span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;status&quot;</span>:  <span class="string">&quot;posted&quot;</span>,</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: message,</span><br><span class="line">			<span class="string">&quot;nick&quot;</span>:    nick,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Query-å’Œ-post-form"><a href="#Query-å’Œ-post-form" class="headerlink" title="Query å’Œ post form"></a>Query å’Œ post form</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;post?id&#x3D;1234&amp;page&#x3D;1 HTTP&#x2F;1.1</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">name&#x3D;manu&amp;message&#x3D;this_is_great</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	router.POST(<span class="string">&quot;/post&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">		id := c.Query(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">		page := c.DefaultQuery(<span class="string">&quot;page&quot;</span>, <span class="string">&quot;0&quot;</span>)</span><br><span class="line">		name := c.PostForm(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		message := c.PostForm(<span class="string">&quot;message&quot;</span>)</span><br><span class="line"></span><br><span class="line">		fmt.Printf(<span class="string">&quot;id: %s; page: %s; name: %s; message: %s&quot;</span>, id, page, name, message)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id: 1234; page: 1; name: manu; message: this_is_great</span><br></pre></td></tr></table></figure>

<h2 id="XML-JSON-YAML-ProtoBuf-æ¸²æŸ“"><a href="#XML-JSON-YAML-ProtoBuf-æ¸²æŸ“" class="headerlink" title="XML/JSON/YAML/ProtoBuf æ¸²æŸ“"></a>XML/JSON/YAML/ProtoBuf æ¸²æŸ“</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">func main() &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	// gin.H æ˜¯ <span class="built_in">map</span>[string]interface&#123;&#125; çš„ä¸€ç§å¿«æ·æ–¹å¼</span><br><span class="line">	r.GET(<span class="string">&quot;/someJSON&quot;</span>, func(c *gin.Context) &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;hey&quot;</span>, <span class="string">&quot;status&quot;</span>: http.StatusOK&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/moreJSON&quot;</span>, func(c *gin.Context) &#123;</span><br><span class="line">		// ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“</span><br><span class="line">		var msg struct &#123;</span><br><span class="line">			Name    string `json:<span class="string">&quot;user&quot;</span>`</span><br><span class="line">			Message string</span><br><span class="line">			Number  <span class="built_in">int</span></span><br><span class="line">		&#125;</span><br><span class="line">		msg.Name = <span class="string">&quot;Lena&quot;</span></span><br><span class="line">		msg.Message = <span class="string">&quot;hey&quot;</span></span><br><span class="line">		msg.Number = <span class="number">123</span></span><br><span class="line">		// æ³¨æ„ msg.Name åœ¨ JSON ä¸­å˜æˆäº† <span class="string">&quot;user&quot;</span></span><br><span class="line">		// å°†è¾“å‡ºï¼š&#123;<span class="string">&quot;user&quot;</span>: <span class="string">&quot;Lena&quot;</span>, <span class="string">&quot;Message&quot;</span>: <span class="string">&quot;hey&quot;</span>, <span class="string">&quot;Number&quot;</span>: <span class="number">123</span>&#125;</span><br><span class="line">		c.JSON(http.StatusOK, msg)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/someXML&quot;</span>, func(c *gin.Context) &#123;</span><br><span class="line">		c.XML(http.StatusOK, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;hey&quot;</span>, <span class="string">&quot;status&quot;</span>: http.StatusOK&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/someYAML&quot;</span>, func(c *gin.Context) &#123;</span><br><span class="line">		c.YAML(http.StatusOK, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;hey&quot;</span>, <span class="string">&quot;status&quot;</span>: http.StatusOK&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/someProtoBuf&quot;</span>, func(c *gin.Context) &#123;</span><br><span class="line">		reps := []int64&#123;int64(<span class="number">1</span>), int64(<span class="number">2</span>)&#125;</span><br><span class="line">		label := <span class="string">&quot;test&quot;</span></span><br><span class="line">		// protobuf çš„å…·ä½“å®šä¹‰å†™åœ¨ testdata/protoexample æ–‡ä»¶ä¸­ã€‚</span><br><span class="line">		data := &amp;protoexample.Test&#123;</span><br><span class="line">			Label: &amp;label,</span><br><span class="line">			Reps:  reps,</span><br><span class="line">		&#125;</span><br><span class="line">		// è¯·æ³¨æ„ï¼Œæ•°æ®åœ¨å“åº”ä¸­å˜ä¸ºäºŒè¿›åˆ¶æ•°æ®</span><br><span class="line">		// å°†è¾“å‡ºè¢« protoexample.Test protobuf åºåˆ—åŒ–äº†çš„æ•°æ®</span><br><span class="line">		c.ProtoBuf(http.StatusOK, data)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	// ç›‘å¬å¹¶åœ¨ <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>:<span class="number">8080</span> ä¸Šå¯åŠ¨æœåŠ¡</span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h2><h3 id="å•æ–‡ä»¶"><a href="#å•æ–‡ä»¶" class="headerlink" title="å•æ–‡ä»¶"></a>å•æ–‡ä»¶</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	<span class="comment">// ä¸º multipart forms è®¾ç½®è¾ƒä½çš„å†…å­˜é™åˆ¶ (é»˜è®¤æ˜¯ 32 MiB)</span></span><br><span class="line">	router.MaxMultipartMemory = <span class="number">8</span> &lt;&lt; <span class="number">20</span>  <span class="comment">// 8 MiB</span></span><br><span class="line">	router.POST(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// å•æ–‡ä»¶</span></span><br><span class="line">		file, _ := c.FormFile(<span class="string">&quot;file&quot;</span>)</span><br><span class="line">		log.Println(file.Filename)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ä¸Šä¼ æ–‡ä»¶è‡³æŒ‡å®šç›®å½•</span></span><br><span class="line">		c.SaveUploadedFile(file, dst)</span><br><span class="line"></span><br><span class="line">		c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;&#x27;%s&#x27; uploaded!&quot;</span>, file.Filename))</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚ä½•ä½¿ç”¨ <code>curl</code>ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http://localhost:8080/upload \</span><br><span class="line">  -F &quot;file=@/Users/appleboy/test.zip&quot; \</span><br><span class="line">  -H &quot;Content-Type: multipart/form-data&quot;</span><br></pre></td></tr></table></figure>

<h3 id="å¤šæ–‡ä»¶"><a href="#å¤šæ–‡ä»¶" class="headerlink" title="å¤šæ–‡ä»¶"></a>å¤šæ–‡ä»¶</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	<span class="comment">// ä¸º multipart forms è®¾ç½®è¾ƒä½çš„å†…å­˜é™åˆ¶ (é»˜è®¤æ˜¯ 32 MiB)</span></span><br><span class="line">	router.MaxMultipartMemory = <span class="number">8</span> &lt;&lt; <span class="number">20</span>  <span class="comment">// 8 MiB</span></span><br><span class="line">	router.POST(<span class="string">&quot;/upload&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// Multipart form</span></span><br><span class="line">		form, _ := c.MultipartForm()</span><br><span class="line">		files := form.File[<span class="string">&quot;upload[]&quot;</span>]</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> _, file := <span class="keyword">range</span> files &#123;</span><br><span class="line">			log.Println(file.Filename)</span><br><span class="line"></span><br><span class="line">			<span class="comment">// ä¸Šä¼ æ–‡ä»¶è‡³æŒ‡å®šç›®å½•</span></span><br><span class="line">			c.SaveUploadedFile(file, dst)</span><br><span class="line">		&#125;</span><br><span class="line">		c.String(http.StatusOK, fmt.Sprintf(<span class="string">&quot;%d files uploaded!&quot;</span>, <span class="built_in">len</span>(files)))</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚ä½•ä½¿ç”¨ <code>curl</code>:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST http://localhost:8080/upload \</span><br><span class="line">  -F &quot;upload[]=@/Users/appleboy/test1.zip&quot; \</span><br><span class="line">  -F &quot;upload[]=@/Users/appleboy/test2.zip&quot; \</span><br><span class="line">  -H &quot;Content-Type: multipart/form-data&quot;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶"><a href="#ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶" class="headerlink" title="ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶"></a>ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶</h2><p>ä½¿ç”¨</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r := gin.New()</span><br></pre></td></tr></table></figure>

<p>ä»£æ›¿</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Default ä½¿ç”¨ Logger å’Œ Recovery ä¸­é—´ä»¶</span></span><br><span class="line">r := gin.Default()</span><br></pre></td></tr></table></figure>

<h2 id="ä»-reader-è¯»å–æ•°æ®"><a href="#ä»-reader-è¯»å–æ•°æ®" class="headerlink" title="ä» reader è¯»å–æ•°æ®"></a>ä» reader è¯»å–æ•°æ®</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.GET(<span class="string">&quot;/someDataFromReader&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		response, err := http.Get(<span class="string">&quot;https://raw.githubusercontent.com/gin-gonic/logo/master/color.png&quot;</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> || response.StatusCode != http.StatusOK &#123;</span><br><span class="line">			c.Status(http.StatusServiceUnavailable)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		reader := response.Body</span><br><span class="line">		contentLength := response.ContentLength</span><br><span class="line">		contentType := response.Header.Get(<span class="string">&quot;Content-Type&quot;</span>)</span><br><span class="line"></span><br><span class="line">		extraHeaders := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">			<span class="string">&quot;Content-Disposition&quot;</span>: <span class="string">`attachment; filename=&quot;gopher.png&quot;`</span>,</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		c.DataFromReader(http.StatusOK, contentLength, contentType, reader, extraHeaders)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¼˜é›…åœ°é‡å¯æˆ–åœæ­¢"><a href="#ä¼˜é›…åœ°é‡å¯æˆ–åœæ­¢" class="headerlink" title="ä¼˜é›…åœ°é‡å¯æˆ–åœæ­¢"></a>ä¼˜é›…åœ°é‡å¯æˆ–åœæ­¢</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/fvbock/endless">fvbock/endless</a> æ¥æ›¿æ¢é»˜è®¤çš„ <code>ListenAndServe</code>ã€‚æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… issue <a target="_blank" rel="noopener" href="https://github.com/gin-gonic/gin/issues/296">#296</a>ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">router := gin.Default()</span><br><span class="line">router.GET(<span class="string">&quot;/&quot;</span>, handler)</span><br><span class="line"><span class="comment">// [...]</span></span><br><span class="line">endless.ListenAndServe(<span class="string">&quot;:4242&quot;</span>, router)</span><br></pre></td></tr></table></figure>

<p>æ›¿ä»£æ–¹æ¡ˆ:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/braintree/manners">manners</a>ï¼šå¯ä»¥ä¼˜é›…å…³æœºçš„ Go Http æœåŠ¡å™¨ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://github.com/tylerb/graceful">graceful</a>ï¼šGraceful æ˜¯ä¸€ä¸ª Go æ‰©å±•åŒ…ï¼Œå¯ä»¥ä¼˜é›…åœ°å…³é—­ http.Handler æœåŠ¡å™¨ã€‚</li>
<li><a target="_blank" rel="noopener" href="https://github.com/facebookgo/grace">grace</a>ï¼šGo æœåŠ¡å™¨å¹³æ»‘é‡å¯å’Œé›¶åœæœºæ—¶é—´éƒ¨ç½²ã€‚</li>
</ul>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ Go 1.8ï¼Œå¯ä»¥ä¸éœ€è¦è¿™äº›åº“ï¼è€ƒè™‘ä½¿ç”¨ http.Server å†…ç½®çš„ <a target="_blank" rel="noopener" href="https://golang.org/pkg/net/http/#Server.Shutdown">Shutdown()</a> æ–¹æ³•ä¼˜é›…åœ°å…³æœº. è¯·å‚é˜… gin å®Œæ•´çš„ <a target="_blank" rel="noopener" href="https://github.com/gin-gonic/examples/tree/master/graceful-shutdown">graceful-shutdown</a> ç¤ºä¾‹ã€‚</p>
<h2 id="ä½¿ç”¨-BasicAuth-ä¸­é—´ä»¶"><a href="#ä½¿ç”¨-BasicAuth-ä¸­é—´ä»¶" class="headerlink" title="ä½¿ç”¨ BasicAuth ä¸­é—´ä»¶"></a>ä½¿ç”¨ BasicAuth ä¸­é—´ä»¶</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ¨¡æ‹Ÿä¸€äº›ç§äººæ•°æ®</span></span><br><span class="line"><span class="keyword">var</span> secrets = gin.H&#123;</span><br><span class="line">	<span class="string">&quot;foo&quot;</span>:    gin.H&#123;<span class="string">&quot;email&quot;</span>: <span class="string">&quot;foo@bar.com&quot;</span>, <span class="string">&quot;phone&quot;</span>: <span class="string">&quot;123433&quot;</span>&#125;,</span><br><span class="line">	<span class="string">&quot;austin&quot;</span>: gin.H&#123;<span class="string">&quot;email&quot;</span>: <span class="string">&quot;austin@example.com&quot;</span>, <span class="string">&quot;phone&quot;</span>: <span class="string">&quot;666&quot;</span>&#125;,</span><br><span class="line">	<span class="string">&quot;lena&quot;</span>:   gin.H&#123;<span class="string">&quot;email&quot;</span>: <span class="string">&quot;lena@guapa.com&quot;</span>, <span class="string">&quot;phone&quot;</span>: <span class="string">&quot;523443&quot;</span>&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è·¯ç”±ç»„ä½¿ç”¨ gin.BasicAuth() ä¸­é—´ä»¶</span></span><br><span class="line">	<span class="comment">// gin.Accounts æ˜¯ map[string]string çš„ä¸€ç§å¿«æ·æ–¹å¼</span></span><br><span class="line">	authorized := r.Group(<span class="string">&quot;/admin&quot;</span>, gin.BasicAuth(gin.Accounts&#123;</span><br><span class="line">		<span class="string">&quot;foo&quot;</span>:    <span class="string">&quot;bar&quot;</span>,</span><br><span class="line">		<span class="string">&quot;austin&quot;</span>: <span class="string">&quot;1234&quot;</span>,</span><br><span class="line">		<span class="string">&quot;lena&quot;</span>:   <span class="string">&quot;hello2&quot;</span>,</span><br><span class="line">		<span class="string">&quot;manu&quot;</span>:   <span class="string">&quot;4321&quot;</span>,</span><br><span class="line">	&#125;))</span><br><span class="line"></span><br><span class="line">	<span class="comment">// /admin/secrets ç«¯ç‚¹</span></span><br><span class="line">	<span class="comment">// è§¦å‘ &quot;localhost:8080/admin/secrets</span></span><br><span class="line">	authorized.GET(<span class="string">&quot;/secrets&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// è·å–ç”¨æˆ·ï¼Œå®ƒæ˜¯ç”± BasicAuth ä¸­é—´ä»¶è®¾ç½®çš„</span></span><br><span class="line">		user := c.MustGet(gin.AuthUserKey).(<span class="keyword">string</span>)</span><br><span class="line">		<span class="keyword">if</span> secret, ok := secrets[user]; ok &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;user&quot;</span>: user, <span class="string">&quot;secret&quot;</span>: secret&#125;)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;user&quot;</span>: user, <span class="string">&quot;secret&quot;</span>: <span class="string">&quot;NO SECRET :(&quot;</span>&#125;)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GETè¯·æ±‚æ—¶åœ¨<code>AUthorization</code>ä¸­å¡«å…¥ç”¨æˆ·åå’Œå¯†ç ã€‚</p>
<h2 id="ä½¿ç”¨-HTTP-æ–¹æ³•"><a href="#ä½¿ç”¨-HTTP-æ–¹æ³•" class="headerlink" title="ä½¿ç”¨ HTTP æ–¹æ³•"></a>ä½¿ç”¨ HTTP æ–¹æ³•</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// ç¦ç”¨æ§åˆ¶å°é¢œè‰²</span></span><br><span class="line">	<span class="comment">// gin.DisableConsoleColor()</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä½¿ç”¨é»˜è®¤ä¸­é—´ä»¶ï¼ˆlogger å’Œ recovery ä¸­é—´ä»¶ï¼‰åˆ›å»º gin è·¯ç”±</span></span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	router.GET(<span class="string">&quot;/someGet&quot;</span>, getting)</span><br><span class="line">	router.POST(<span class="string">&quot;/somePost&quot;</span>, posting)</span><br><span class="line">	router.PUT(<span class="string">&quot;/somePut&quot;</span>, putting)</span><br><span class="line">	router.DELETE(<span class="string">&quot;/someDelete&quot;</span>, deleting)</span><br><span class="line">	router.PATCH(<span class="string">&quot;/somePatch&quot;</span>, patching)</span><br><span class="line">	router.HEAD(<span class="string">&quot;/someHead&quot;</span>, head)</span><br><span class="line">	router.OPTIONS(<span class="string">&quot;/someOptions&quot;</span>, options)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// é»˜è®¤åœ¨ 8080 ç«¯å£å¯åŠ¨æœåŠ¡ï¼Œé™¤éå®šä¹‰äº†ä¸€ä¸ª PORT çš„ç¯å¢ƒå˜é‡ã€‚</span></span><br><span class="line">	router.Run()</span><br><span class="line">	<span class="comment">// router.Run(&quot;:3000&quot;) hardcode ç«¯å£å·</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä½¿ç”¨ä¸­é—´ä»¶"><a href="#ä½¿ç”¨ä¸­é—´ä»¶" class="headerlink" title="ä½¿ç”¨ä¸­é—´ä»¶"></a>ä½¿ç”¨ä¸­é—´ä»¶</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// æ–°å»ºä¸€ä¸ªæ²¡æœ‰ä»»ä½•é»˜è®¤ä¸­é—´ä»¶çš„è·¯ç”±</span></span><br><span class="line">	r := gin.New()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// å…¨å±€ä¸­é—´ä»¶</span></span><br><span class="line">	<span class="comment">// Logger ä¸­é—´ä»¶å°†æ—¥å¿—å†™å…¥ gin.DefaultWriterï¼Œå³ä½¿ä½ å°† GIN_MODE è®¾ç½®ä¸º releaseã€‚</span></span><br><span class="line">	<span class="comment">// By default gin.DefaultWriter = os.Stdout</span></span><br><span class="line">	r.Use(gin.Logger())</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Recovery ä¸­é—´ä»¶ä¼š recover ä»»ä½• panicã€‚å¦‚æœæœ‰ panic çš„è¯ï¼Œä¼šå†™å…¥ 500ã€‚</span></span><br><span class="line">	r.Use(gin.Recovery())</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä½ å¯ä»¥ä¸ºæ¯ä¸ªè·¯ç”±æ·»åŠ ä»»æ„æ•°é‡çš„ä¸­é—´ä»¶ã€‚</span></span><br><span class="line">	r.GET(<span class="string">&quot;/benchmark&quot;</span>, MyBenchLogger(), benchEndpoint)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// è®¤è¯è·¯ç”±ç»„</span></span><br><span class="line">	<span class="comment">// authorized := r.Group(&quot;/&quot;, AuthRequired())</span></span><br><span class="line">	<span class="comment">// å’Œä½¿ç”¨ä»¥ä¸‹ä¸¤è¡Œä»£ç çš„æ•ˆæœå®Œå…¨ä¸€æ ·:</span></span><br><span class="line">	authorized := r.Group(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">	<span class="comment">// è·¯ç”±ç»„ä¸­é—´ä»¶! åœ¨æ­¤ä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨ &quot;authorized&quot; è·¯ç”±ç»„ä¸­ä½¿ç”¨è‡ªå®šä¹‰åˆ›å»ºçš„ </span></span><br><span class="line">    <span class="comment">// AuthRequired() ä¸­é—´ä»¶</span></span><br><span class="line">	authorized.Use(AuthRequired())</span><br><span class="line">	&#123;</span><br><span class="line">		authorized.POST(<span class="string">&quot;/login&quot;</span>, loginEndpoint)</span><br><span class="line">		authorized.POST(<span class="string">&quot;/submit&quot;</span>, submitEndpoint)</span><br><span class="line">		authorized.POST(<span class="string">&quot;/read&quot;</span>, readEndpoint)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// åµŒå¥—è·¯ç”±ç»„</span></span><br><span class="line">		testing := authorized.Group(<span class="string">&quot;testing&quot;</span>)</span><br><span class="line">		testing.GET(<span class="string">&quot;/analytics&quot;</span>, analyticsEndpoint)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åªç»‘å®š-url-æŸ¥è¯¢å­—ç¬¦ä¸²"><a href="#åªç»‘å®š-url-æŸ¥è¯¢å­—ç¬¦ä¸²" class="headerlink" title="åªç»‘å®š url æŸ¥è¯¢å­—ç¬¦ä¸²"></a>åªç»‘å®š url æŸ¥è¯¢å­—ç¬¦ä¸²</h2><p><code>ShouldBindQuery</code> å‡½æ•°åªç»‘å®š url æŸ¥è¯¢å‚æ•°è€Œå¿½ç•¥ post æ•°æ®ã€‚å‚é˜…<a target="_blank" rel="noopener" href="https://github.com/gin-gonic/gin/issues/742#issuecomment-315953017">è¯¦ç»†ä¿¡æ¯</a>.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name    <span class="keyword">string</span> <span class="string">`form:&quot;name&quot;`</span></span><br><span class="line">	Address <span class="keyword">string</span> <span class="string">`form:&quot;address&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	route := gin.Default()</span><br><span class="line">	route.Any(<span class="string">&quot;/testing&quot;</span>, startPage)</span><br><span class="line">	route.Run(<span class="string">&quot;:8085&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">startPage</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> person Person</span><br><span class="line">	<span class="keyword">if</span> c.ShouldBindQuery(&amp;person) == <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Println(<span class="string">&quot;====== Only Bind By Query String ======&quot;</span>)</span><br><span class="line">		log.Println(person.Name)</span><br><span class="line">		log.Println(person.Address)</span><br><span class="line">	&#125;</span><br><span class="line">	c.String(<span class="number">200</span>, <span class="string">&quot;Success&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åœ¨ä¸­é—´ä»¶ä¸­ä½¿ç”¨-Goroutine"><a href="#åœ¨ä¸­é—´ä»¶ä¸­ä½¿ç”¨-Goroutine" class="headerlink" title="åœ¨ä¸­é—´ä»¶ä¸­ä½¿ç”¨ Goroutine"></a>åœ¨ä¸­é—´ä»¶ä¸­ä½¿ç”¨ Goroutine</h2><p>å½“åœ¨ä¸­é—´ä»¶æˆ– handler ä¸­å¯åŠ¨æ–°çš„ Goroutine æ—¶ï¼Œ<strong>ä¸èƒ½</strong>ä½¿ç”¨åŸå§‹çš„ä¸Šä¸‹æ–‡ï¼Œå¿…é¡»ä½¿ç”¨åªè¯»å‰¯æœ¬ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/long_async&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// åˆ›å»ºåœ¨ goroutine ä¸­ä½¿ç”¨çš„å‰¯æœ¬</span></span><br><span class="line">		cCp := c.Copy()</span><br><span class="line">		<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">			<span class="comment">// ç”¨ time.Sleep() æ¨¡æ‹Ÿä¸€ä¸ªé•¿ä»»åŠ¡ã€‚</span></span><br><span class="line">			time.Sleep(<span class="number">5</span> * time.Second)</span><br><span class="line"></span><br><span class="line">			<span class="comment">// è¯·æ³¨æ„æ‚¨ä½¿ç”¨çš„æ˜¯å¤åˆ¶çš„ä¸Šä¸‹æ–‡ &quot;cCp&quot;ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦</span></span><br><span class="line">			log.Println(<span class="string">&quot;Done! in path &quot;</span> + cCp.Request.URL.Path)</span><br><span class="line">		&#125;()</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/long_sync&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="comment">// ç”¨ time.Sleep() æ¨¡æ‹Ÿä¸€ä¸ªé•¿ä»»åŠ¡ã€‚</span></span><br><span class="line">		time.Sleep(<span class="number">5</span> * time.Second)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// å› ä¸ºæ²¡æœ‰ä½¿ç”¨ goroutineï¼Œä¸éœ€è¦æ‹·è´ä¸Šä¸‹æ–‡</span></span><br><span class="line">		log.Println(<span class="string">&quot;Done! in path &quot;</span> + c.Request.URL.Path)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¤šæ¨¡æ¿"><a href="#å¤šæ¨¡æ¿" class="headerlink" title="å¤šæ¨¡æ¿"></a>å¤šæ¨¡æ¿</h2><p>Gin é»˜è®¤å…è®¸åªä½¿ç”¨ä¸€ä¸ª html æ¨¡æ¿ã€‚ æŸ¥çœ‹<a target="_blank" rel="noopener" href="https://github.com/gin-contrib/multitemplate">å¤šæ¨¡æ¿æ¸²æŸ“</a> ä»¥ä½¿ç”¨ go 1.6 <code>block template</code> ç­‰åŠŸèƒ½ã€‚</p>
<p>INSTALLATION:  <code>go get github.com/gin-contrib/multitemplate</code></p>
<h3 id="ç®€å•ç”¨æ³•"><a href="#ç®€å•ç”¨æ³•" class="headerlink" title="ç®€å•ç”¨æ³•"></a>ç®€å•ç”¨æ³•</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/multitemplate&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createMyRender</span><span class="params">()</span> <span class="title">multitemplate</span>.<span class="title">Renderer</span></span> &#123;</span><br><span class="line">	r := multitemplate.NewRenderer()</span><br><span class="line">	r.AddFromFiles(<span class="string">&quot;index&quot;</span>, <span class="string">&quot;templates/base.html&quot;</span>, <span class="string">&quot;templates/index.html&quot;</span>)</span><br><span class="line">	r.AddFromFiles(<span class="string">&quot;article&quot;</span>, <span class="string">&quot;templates/base.html&quot;</span>, <span class="string">&quot;templates/index.html&quot;</span>, <span class="string">&quot;templates/article.html&quot;</span>)</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.HTMLRender = createMyRender()</span><br><span class="line">	router.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(<span class="number">200</span>, <span class="string">&quot;index&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;Html5 Template Engine&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.GET(<span class="string">&quot;/article&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(<span class="number">200</span>, <span class="string">&quot;article&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;Html5 Article Engine&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é«˜çº§ç”¨æ³•"><a href="#é«˜çº§ç”¨æ³•" class="headerlink" title="é«˜çº§ç”¨æ³•"></a>é«˜çº§ç”¨æ³•</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;path/filepath&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-contrib/multitemplate&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.HTMLRender = loadTemplates(<span class="string">&quot;./templates&quot;</span>)</span><br><span class="line">	router.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(<span class="number">200</span>, <span class="string">&quot;index.html&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;Welcome!&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.GET(<span class="string">&quot;/article&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(<span class="number">200</span>, <span class="string">&quot;article.html&quot;</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;title&quot;</span>: <span class="string">&quot;Html5 Article Engine&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loadTemplates</span><span class="params">(templatesDir <span class="keyword">string</span>)</span> <span class="title">multitemplate</span>.<span class="title">Renderer</span></span> &#123;</span><br><span class="line">	r := multitemplate.NewRenderer()</span><br><span class="line"></span><br><span class="line">	layouts, err := filepath.Glob(templatesDir + <span class="string">&quot;/layouts/*.html&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err.Error())</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	includes, err := filepath.Glob(templatesDir + <span class="string">&quot;/includes/*.html&quot;</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err.Error())</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Generate our templates map from our layouts/ and includes/ directories</span></span><br><span class="line">	<span class="keyword">for</span> _, include := <span class="keyword">range</span> includes &#123;</span><br><span class="line">		layoutCopy := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="built_in">len</span>(layouts))</span><br><span class="line">		<span class="built_in">copy</span>(layoutCopy, layouts)</span><br><span class="line">		files := <span class="built_in">append</span>(layoutCopy, include)</span><br><span class="line">		r.AddFromFiles(filepath.Base(include), files...)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> r</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è®°å½•æ—¥å¿—"><a href="#è®°å½•æ—¥å¿—" class="headerlink" title="è®°å½•æ—¥å¿—"></a>è®°å½•æ—¥å¿—</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// ç¦ç”¨æ§åˆ¶å°é¢œè‰²ï¼Œå°†æ—¥å¿—å†™å…¥æ–‡ä»¶æ—¶ä¸éœ€è¦æ§åˆ¶å°é¢œè‰²ã€‚</span></span><br><span class="line">    gin.DisableConsoleColor()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è®°å½•åˆ°æ–‡ä»¶ã€‚</span></span><br><span class="line">    f, _ := os.Create(<span class="string">&quot;gin.log&quot;</span>)</span><br><span class="line">    gin.DefaultWriter = io.MultiWriter(f)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¦‚æœéœ€è¦åŒæ—¶å°†æ—¥å¿—å†™å…¥æ–‡ä»¶å’Œæ§åˆ¶å°ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ä»£ç ã€‚</span></span><br><span class="line">    <span class="comment">// gin.DefaultWriter = io.MultiWriter(f, os.Stdout)</span></span><br><span class="line"></span><br><span class="line">    router := gin.Default()</span><br><span class="line">    router.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.String(<span class="number">200</span>, <span class="string">&quot;pong&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼"><a href="#å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼" class="headerlink" title="å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼"></a>å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼</h2><p>é»˜è®¤çš„è·¯ç”±æ—¥å¿—æ ¼å¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[GIN-debug] POST   &#x2F;foo                      --&gt; main.main.func1 (3 handlers)</span><br><span class="line">[GIN-debug] GET    &#x2F;bar                      --&gt; main.main.func2 (3 handlers)</span><br><span class="line">[GIN-debug] GET    &#x2F;status                   --&gt; main.main.func3 (3 handlers)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ æƒ³è¦ä»¥æŒ‡å®šçš„æ ¼å¼ï¼ˆä¾‹å¦‚ JSONï¼Œkey values æˆ–å…¶ä»–æ ¼å¼ï¼‰è®°å½•ä¿¡æ¯ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>gin.DebugPrintRouteFunc</code> æŒ‡å®šæ ¼å¼ã€‚ åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ ‡å‡†æ—¥å¿—åŒ…è®°å½•æ‰€æœ‰è·¯ç”±ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨å…¶ä»–æ»¡è¶³ä½ éœ€æ±‚çš„æ—¥å¿—å·¥å…·ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	gin.DebugPrintRouteFunc = <span class="function"><span class="keyword">func</span><span class="params">(httpMethod, absolutePath, handlerName <span class="keyword">string</span>, nuHandlers <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">		log.Printf(<span class="string">&quot;endpoint %v %v %v %v\n&quot;</span>, httpMethod, absolutePath, handlerName, nuHandlers)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	r.POST(<span class="string">&quot;/foo&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, <span class="string">&quot;foo&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/bar&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, <span class="string">&quot;bar&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/status&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, <span class="string">&quot;ok&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å°†-request-body-ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­"><a href="#å°†-request-body-ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­" class="headerlink" title="å°† request body ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­"></a>å°† request body ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­</h2><p>ä¸€èˆ¬é€šè¿‡è°ƒç”¨ <code>c.Request.Body</code> æ–¹æ³•ç»‘å®šæ•°æ®ï¼Œä½†ä¸èƒ½å¤šæ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> formA <span class="keyword">struct</span> &#123;</span><br><span class="line">  Foo <span class="keyword">string</span> <span class="string">`json:&quot;foo&quot; xml:&quot;foo&quot; binding:&quot;required&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> formB <span class="keyword">struct</span> &#123;</span><br><span class="line">  Bar <span class="keyword">string</span> <span class="string">`json:&quot;bar&quot; xml:&quot;bar&quot; binding:&quot;required&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SomeHandler</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">  objA := formA&#123;&#125;</span><br><span class="line">  objB := formB&#123;&#125;</span><br><span class="line">  <span class="comment">// c.ShouldBind ä½¿ç”¨äº† c.Request.Bodyï¼Œä¸å¯é‡ç”¨ã€‚</span></span><br><span class="line">  <span class="keyword">if</span> errA := c.ShouldBind(&amp;objA); errA == <span class="literal">nil</span> &#123;</span><br><span class="line">    c.String(http.StatusOK, <span class="string">`the body should be formA`</span>)</span><br><span class="line">  <span class="comment">// å› ä¸ºç°åœ¨ c.Request.Body æ˜¯ EOFï¼Œæ‰€ä»¥è¿™é‡Œä¼šæŠ¥é”™ã€‚</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> errB := c.ShouldBind(&amp;objB); errB == <span class="literal">nil</span> &#123;</span><br><span class="line">    c.String(http.StatusOK, <span class="string">`the body should be formB`</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦æƒ³å¤šæ¬¡ç»‘å®šï¼Œå¯ä»¥ä½¿ç”¨ <code>c.ShouldBindBodyWith</code>.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SomeHandler</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">  objA := formA&#123;&#125;</span><br><span class="line">  objB := formB&#123;&#125;</span><br><span class="line">  <span class="comment">// è¯»å– c.Request.Body å¹¶å°†ç»“æœå­˜å…¥ä¸Šä¸‹æ–‡ã€‚</span></span><br><span class="line">  <span class="keyword">if</span> errA := c.ShouldBindBodyWith(&amp;objA, binding.JSON); errA == <span class="literal">nil</span> &#123;</span><br><span class="line">    c.String(http.StatusOK, <span class="string">`the body should be formA`</span>)</span><br><span class="line">  <span class="comment">// è¿™æ—¶, å¤ç”¨å­˜å‚¨åœ¨ä¸Šä¸‹æ–‡ä¸­çš„ bodyã€‚</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> errB := c.ShouldBindBodyWith(&amp;objB, binding.JSON); errB == <span class="literal">nil</span> &#123;</span><br><span class="line">    c.String(http.StatusOK, <span class="string">`the body should be formB JSON`</span>)</span><br><span class="line">  <span class="comment">// å¯ä»¥æ¥å—å…¶ä»–æ ¼å¼</span></span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> errB2 := c.ShouldBindBodyWith(&amp;objB, binding.XML); errB2 == <span class="literal">nil</span> &#123;</span><br><span class="line">    c.String(http.StatusOK, <span class="string">`the body should be formB XML`</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>c.ShouldBindBodyWith</code> ä¼šåœ¨ç»‘å®šä¹‹å‰å°† body å­˜å‚¨åˆ°ä¸Šä¸‹æ–‡ä¸­ã€‚ è¿™ä¼šå¯¹æ€§èƒ½é€ æˆè½»å¾®å½±å“ï¼Œå¦‚æœè°ƒç”¨ä¸€æ¬¡å°±èƒ½å®Œæˆç»‘å®šçš„è¯ï¼Œé‚£å°±ä¸è¦ç”¨è¿™ä¸ªæ–¹æ³•ã€‚</li>
<li>åªæœ‰æŸäº›æ ¼å¼éœ€è¦æ­¤åŠŸèƒ½ï¼Œå¦‚ <code>JSON</code>, <code>XML</code>, <code>MsgPack</code>, <code>ProtoBuf</code>ã€‚ å¯¹äºå…¶ä»–æ ¼å¼, å¦‚ <code>Query</code>, <code>Form</code>, <code>FormPost</code>, <code>FormMultipart</code> å¯ä»¥å¤šæ¬¡è°ƒç”¨ <code>c.ShouldBind()</code> è€Œä¸ä¼šé€ æˆä»»ä»»ä½•æ€§èƒ½æŸå¤± (è¯¦è§ <a target="_blank" rel="noopener" href="https://github.com/gin-gonic/gin/pull/1341">#1341</a>)ã€‚</li>
</ul>
<h2 id="æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²"><a href="#æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²" class="headerlink" title="æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²"></a>æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²</h2><p>æ ¹æ®æ£€æµ‹åˆ°çš„ TTYï¼Œæ§åˆ¶å°çš„æ—¥å¿—è¾“å‡ºé»˜è®¤æ˜¯æœ‰é¢œè‰²çš„ã€‚</p>
<p>ç¦æ­¢æ—¥å¿—é¢œè‰²åŒ–:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// ç¦æ­¢æ—¥å¿—çš„é¢œè‰²</span></span><br><span class="line">    gin.DisableConsoleColor()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨é»˜è®¤ä¸­é—´ä»¶åˆ›å»ºä¸€ä¸ª gin è·¯ç”±:</span></span><br><span class="line">    <span class="comment">// æ—¥å¿—å’Œæ¢å¤ï¼ˆæ— å´©æºƒï¼‰ä¸­é—´ä»¶</span></span><br><span class="line">    router := gin.Default()</span><br><span class="line"></span><br><span class="line">    router.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.String(<span class="number">200</span>, <span class="string">&quot;pong&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ—¥å¿—é¢œè‰²åŒ–:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// å¼ºåˆ¶æ—¥å¿—é¢œè‰²åŒ–</span></span><br><span class="line">    gin.ForceConsoleColor()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç”¨é»˜è®¤ä¸­é—´ä»¶åˆ›å»ºä¸€ä¸ª gin è·¯ç”±:</span></span><br><span class="line">    <span class="comment">// æ—¥å¿—å’Œæ¢å¤ï¼ˆæ— å´©æºƒï¼‰ä¸­é—´ä»¶</span></span><br><span class="line">    router := gin.Default()</span><br><span class="line"></span><br><span class="line">    router.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        c.String(<span class="number">200</span>, <span class="string">&quot;pong&quot;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ”¯æŒ-Letâ€™s-Encrypt"><a href="#æ”¯æŒ-Letâ€™s-Encrypt" class="headerlink" title="æ”¯æŒ Letâ€™s Encrypt"></a>æ”¯æŒ Letâ€™s Encrypt</h2><p>ä¸€è¡Œä»£ç æ”¯æŒ LetsEncrypt HTTPS servers ç¤ºä¾‹ã€‚</p>
<p>é¦–å…ˆ <code>go get github.com/gin-gonic/autotls</code> <code>go mod vendor</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/autotls&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Ping handler</span></span><br><span class="line">	r.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.String(<span class="number">200</span>, <span class="string">&quot;pong&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	log.Fatal(autotls.Run(r, <span class="string">&quot;example1.com&quot;</span>, <span class="string">&quot;example2.com&quot;</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è‡ªå®šä¹‰ autocert manager ç¤ºä¾‹ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/autotls&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;golang.org/x/crypto/acme/autocert&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Ping handler</span></span><br><span class="line">	r.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.String(<span class="number">200</span>, <span class="string">&quot;pong&quot;</span>)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	m := autocert.Manager&#123;</span><br><span class="line">		Prompt:     autocert.AcceptTOS,</span><br><span class="line">		HostPolicy: autocert.HostWhitelist(<span class="string">&quot;example1.com&quot;</span>, <span class="string">&quot;example2.com&quot;</span>),</span><br><span class="line">		Cache:      autocert.DirCache(<span class="string">&quot;/var/www/.cache&quot;</span>),</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	log.Fatal(autotls.RunWithManager(r, &amp;m))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°"><a href="#æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°" class="headerlink" title="æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°"></a>æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">POST /post?ids[a]=1234&amp;ids[b]=hello HTTP/1.1</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">names[first]=thinkerou&amp;names[second]=tianou</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	router.POST(<span class="string">&quot;/post&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">		ids := c.QueryMap(<span class="string">&quot;ids&quot;</span>)</span><br><span class="line">		names := c.PostFormMap(<span class="string">&quot;names&quot;</span>)</span><br><span class="line"></span><br><span class="line">		fmt.Printf(<span class="string">&quot;ids: %v; names: %v&quot;</span>, ids, names)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°"><a href="#æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°" class="headerlink" title="æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°"></a>æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ä½¿ç”¨ç°æœ‰çš„åŸºç¡€è¯·æ±‚å¯¹è±¡è§£ææŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ã€‚</span></span><br><span class="line">	<span class="comment">// ç¤ºä¾‹ URLï¼š /welcome?firstname=Jane&amp;lastname=Doe</span></span><br><span class="line">	router.GET(<span class="string">&quot;/welcome&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		firstname := c.DefaultQuery(<span class="string">&quot;firstname&quot;</span>, <span class="string">&quot;Guest&quot;</span>)</span><br><span class="line">		lastname := c.Query(<span class="string">&quot;lastname&quot;</span>) <span class="comment">// c.Request.URL.Query().Get(&quot;lastname&quot;) çš„ä¸€ç§å¿«æ·æ–¹å¼</span></span><br><span class="line"></span><br><span class="line">		c.String(http.StatusOK, <span class="string">&quot;Hello %s %s&quot;</span>, firstname, lastname)</span><br><span class="line">	&#125;)</span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ¨¡å‹ç»‘å®šå’ŒéªŒè¯"><a href="#æ¨¡å‹ç»‘å®šå’ŒéªŒè¯" class="headerlink" title="æ¨¡å‹ç»‘å®šå’ŒéªŒè¯"></a>æ¨¡å‹ç»‘å®šå’ŒéªŒè¯</h2><p>è¦å°†è¯·æ±‚ä½“ç»‘å®šåˆ°ç»“æ„ä½“ä¸­ï¼Œä½¿ç”¨æ¨¡å‹ç»‘å®šã€‚ Ginç›®å‰æ”¯æŒJSONã€XMLã€YAMLå’Œæ ‡å‡†è¡¨å•å€¼çš„ç»‘å®šï¼ˆfoo=barï¼†boo=bazï¼‰ã€‚</p>
<p>Ginä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/go-playground/validator"><strong>go-playground/validator/v10</strong></a> è¿›è¡ŒéªŒè¯ã€‚ æŸ¥çœ‹æ ‡ç­¾ç”¨æ³•çš„å…¨éƒ¨<a target="_blank" rel="noopener" href="https://pkg.go.dev/github.com/go-playground/validator/v10#hdr-Baked_In_Validators_and_Tags">æ–‡æ¡£</a>.</p>
<p>ä½¿ç”¨æ—¶ï¼Œéœ€è¦åœ¨è¦ç»‘å®šçš„æ‰€æœ‰å­—æ®µä¸Šï¼Œè®¾ç½®ç›¸åº”çš„tagã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨ JSON ç»‘å®šæ—¶ï¼Œè®¾ç½®å­—æ®µæ ‡ç­¾ä¸º <code>json:&quot;fieldname&quot;</code>ã€‚</p>
<p>Ginæä¾›äº†ä¸¤ç±»ç»‘å®šæ–¹æ³•ï¼š</p>
<ul>
<li><p>Type</p>
<p>- Must bind</p>
<ul>
<li><strong>Methods</strong> - <code>Bind</code>, <code>BindJSON</code>, <code>BindXML</code>, <code>BindQuery</code>, <code>BindYAML</code></li>
<li><strong>Behavior</strong> - è¿™äº›æ–¹æ³•å±äº <code>MustBindWith</code> çš„å…·ä½“è°ƒç”¨ã€‚ å¦‚æœå‘ç”Ÿç»‘å®šé”™è¯¯ï¼Œåˆ™è¯·æ±‚ç»ˆæ­¢ï¼Œå¹¶è§¦å‘ <code>c.AbortWithError(400, err).SetType(ErrorTypeBind)</code>ã€‚å“åº”çŠ¶æ€ç è¢«è®¾ç½®ä¸º 400 å¹¶ä¸” <code>Content-Type</code> è¢«è®¾ç½®ä¸º <code>text/plain; charset=utf-8</code>ã€‚ å¦‚æœæ‚¨åœ¨æ­¤ä¹‹åå°è¯•è®¾ç½®å“åº”çŠ¶æ€ç ï¼ŒGinä¼šè¾“å‡ºæ—¥å¿— <code>[GIN-debug] [WARNING] Headers were already written. Wanted to override status code 400 with 422</code>ã€‚ å¦‚æœæ‚¨å¸Œæœ›æ›´å¥½åœ°æ§åˆ¶ç»‘å®šï¼Œè€ƒè™‘ä½¿ç”¨ <code>ShouldBind</code> ç­‰æ•ˆæ–¹æ³•ã€‚</li>
</ul>
</li>
<li><p>Type</p>
<p>- Should bind</p>
<ul>
<li><strong>Methods</strong> - <code>ShouldBind</code>, <code>ShouldBindJSON</code>, <code>ShouldBindXML</code>, <code>ShouldBindQuery</code>, <code>ShouldBindYAML</code></li>
<li><strong>Behavior</strong> - è¿™äº›æ–¹æ³•å±äº <code>ShouldBindWith</code> çš„å…·ä½“è°ƒç”¨ã€‚ å¦‚æœå‘ç”Ÿç»‘å®šé”™è¯¯ï¼ŒGin ä¼šè¿”å›é”™è¯¯å¹¶ç”±å¼€å‘è€…å¤„ç†é”™è¯¯å’Œè¯·æ±‚ã€‚</li>
</ul>
</li>
</ul>
<p>ä½¿ç”¨ Bind æ–¹æ³•æ—¶ï¼ŒGin ä¼šå°è¯•æ ¹æ® Content-Type æ¨æ–­å¦‚ä½•ç»‘å®šã€‚ å¦‚æœä½ æ˜ç¡®çŸ¥é“è¦ç»‘å®šä»€ä¹ˆï¼Œå¯ä»¥ä½¿ç”¨ <code>MustBindWith</code> æˆ– <code>ShouldBindWith</code>ã€‚</p>
<p>ä½ ä¹Ÿå¯ä»¥æŒ‡å®šå¿…é¡»ç»‘å®šçš„å­—æ®µã€‚ å¦‚æœä¸€ä¸ªå­—æ®µçš„ tag åŠ ä¸Šäº† <code>binding:&quot;required&quot;</code>ï¼Œä½†ç»‘å®šæ—¶æ˜¯ç©ºå€¼, Gin ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç»‘å®š JSON</span></span><br><span class="line"><span class="keyword">type</span> Login <span class="keyword">struct</span> &#123;</span><br><span class="line">	User     <span class="keyword">string</span> <span class="string">`form:&quot;user&quot; json:&quot;user&quot; xml:&quot;user&quot;  binding:&quot;required&quot;`</span></span><br><span class="line">	Password <span class="keyword">string</span> <span class="string">`form:&quot;password&quot; json:&quot;password&quot; xml:&quot;password&quot; binding:&quot;required&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç»‘å®š JSON (&#123;&quot;user&quot;: &quot;manu&quot;, &quot;password&quot;: &quot;123&quot;&#125;)</span></span><br><span class="line">	router.POST(<span class="string">&quot;/loginJSON&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> json Login</span><br><span class="line">		<span class="keyword">if</span> err := c.ShouldBindJSON(&amp;json); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> json.User != <span class="string">&quot;manu&quot;</span> || json.Password != <span class="string">&quot;123&quot;</span> &#123;</span><br><span class="line">			c.JSON(http.StatusUnauthorized, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;unauthorized&quot;</span>&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125; </span><br><span class="line">		</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;you are logged in&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">  </span><br><span class="line">  	<span class="comment">// ç»‘å®š XML (</span></span><br><span class="line">	<span class="comment">//	&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line">	<span class="comment">//	&lt;root&gt;</span></span><br><span class="line">	<span class="comment">//		&lt;user&gt;user&lt;/user&gt;</span></span><br><span class="line">	<span class="comment">//		&lt;password&gt;123&lt;/password&gt;</span></span><br><span class="line">	<span class="comment">//	&lt;/root&gt;)</span></span><br><span class="line">	router.POST(<span class="string">&quot;/loginXML&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> xml Login</span><br><span class="line">		<span class="keyword">if</span> err := c.ShouldBindXML(&amp;xml); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> xml.User != <span class="string">&quot;manu&quot;</span> || xml.Password != <span class="string">&quot;123&quot;</span> &#123;</span><br><span class="line">			c.JSON(http.StatusUnauthorized, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;unauthorized&quot;</span>&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125; </span><br><span class="line">		</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;you are logged in&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// ç»‘å®š HTML è¡¨å• (user=manu&amp;password=123)</span></span><br><span class="line">	router.POST(<span class="string">&quot;/loginForm&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> form Login</span><br><span class="line">		<span class="comment">// æ ¹æ® Content-Type Header æ¨æ–­ä½¿ç”¨å“ªä¸ªç»‘å®šå™¨ã€‚</span></span><br><span class="line">		<span class="keyword">if</span> err := c.ShouldBind(&amp;form); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(http.StatusBadRequest, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> form.User != <span class="string">&quot;manu&quot;</span> || form.Password != <span class="string">&quot;123&quot;</span> &#123;</span><br><span class="line">			c.JSON(http.StatusUnauthorized, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;unauthorized&quot;</span>&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125; </span><br><span class="line">		</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;status&quot;</span>: <span class="string">&quot;you are logged in&quot;</span>&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç¤ºä¾‹è¯·æ±‚"><a href="#ç¤ºä¾‹è¯·æ±‚" class="headerlink" title="ç¤ºä¾‹è¯·æ±‚"></a>ç¤ºä¾‹è¯·æ±‚</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ curl -v -X POST \</span><br><span class="line">  http://localhost:8080/loginJSON \</span><br><span class="line">  -H <span class="string">&#x27;content-type: application/json&#x27;</span> \</span><br><span class="line">  -d <span class="string">&#x27;&#123; &quot;user&quot;: &quot;manu&quot; &#125;&#x27;</span></span><br><span class="line">&gt; POST /loginJSON HTTP/1.1</span><br><span class="line">&gt; Host: localhost:8080</span><br><span class="line">&gt; User-Agent: curl/7.51.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt; content-type: application/json</span><br><span class="line">&gt; Content-Length: 18</span><br><span class="line">&gt;</span><br><span class="line">* upload completely sent off: 18 out of 18 bytes</span><br><span class="line">&lt; HTTP/1.1 400 Bad Request</span><br><span class="line">&lt; Content-Type: application/json; charset=utf-8</span><br><span class="line">&lt; Date: Fri, 04 Aug 2017 03:51:31 GMT</span><br><span class="line">&lt; Content-Length: 100</span><br><span class="line">&lt;</span><br><span class="line">&#123;<span class="string">&quot;error&quot;</span>:<span class="string">&quot;Key: &#x27;Login.Password&#x27; Error:Field validation for &#x27;Password&#x27; failed on the &#x27;required&#x27; tag&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¿½ç•¥éªŒè¯"><a href="#å¿½ç•¥éªŒè¯" class="headerlink" title="å¿½ç•¥éªŒè¯"></a>å¿½ç•¥éªŒè¯</h3><p>ä½¿ç”¨ä¸Šè¿°çš„ <code>curl</code> å‘½ä»¤è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹æ—¶ä¼šè¿”å›é”™è¯¯ã€‚ å› ä¸ºç¤ºä¾‹ä¸­ <code>Password</code> ä½¿ç”¨äº† <code>binding:&quot;required&quot;</code>ã€‚ å¦‚æœ <code>Password</code> ä½¿ç”¨ <code>binding:&quot;-&quot;</code>ï¼Œ å†æ¬¡è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹å°±ä¸ä¼šè¿”å›é”™è¯¯ã€‚</p>
<h2 id="ç»‘å®š-HTML-å¤é€‰æ¡†"><a href="#ç»‘å®š-HTML-å¤é€‰æ¡†" class="headerlink" title="ç»‘å®š HTML å¤é€‰æ¡†"></a>ç»‘å®š HTML å¤é€‰æ¡†</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> myForm <span class="keyword">struct</span> &#123;</span><br><span class="line">    Colors []<span class="keyword">string</span> <span class="string">`form:&quot;colors[]&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">formHandler</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> fakeForm myForm</span><br><span class="line">    c.ShouldBind(&amp;fakeForm)</span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;<span class="string">&quot;color&quot;</span>: fakeForm.Colors&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>form.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;/&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>Check some colors<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;red&quot;</span>&gt;</span>Red<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;colors[]&quot;</span> <span class="attr">value</span>=<span class="string">&quot;red&quot;</span> <span class="attr">id</span>=<span class="string">&quot;red&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;green&quot;</span>&gt;</span>Green<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;colors[]&quot;</span> <span class="attr">value</span>=<span class="string">&quot;green&quot;</span> <span class="attr">id</span>=<span class="string">&quot;green&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;blue&quot;</span>&gt;</span>Blue<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;colors[]&quot;</span> <span class="attr">value</span>=<span class="string">&quot;blue&quot;</span> <span class="attr">id</span>=<span class="string">&quot;blue&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç»“æœ:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;color&quot;</span>:[<span class="string">&quot;red&quot;</span>,<span class="string">&quot;green&quot;</span>,<span class="string">&quot;blue&quot;</span>]&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç»‘å®š-Uri"><a href="#ç»‘å®š-Uri" class="headerlink" title="ç»‘å®š Uri"></a>ç»‘å®š Uri</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	ID   <span class="keyword">string</span> <span class="string">`uri:&quot;id&quot; binding:&quot;required,uuid&quot;`</span></span><br><span class="line">	Name <span class="keyword">string</span> <span class="string">`uri:&quot;name&quot; binding:&quot;required&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	route := gin.Default()</span><br><span class="line">	route.GET(<span class="string">&quot;/:name/:id&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		<span class="keyword">var</span> person Person</span><br><span class="line">		<span class="keyword">if</span> err := c.ShouldBindUri(&amp;person); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			c.JSON(<span class="number">400</span>, gin.H&#123;<span class="string">&quot;msg&quot;</span>: err&#125;)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;<span class="string">&quot;name&quot;</span>: person.Name, <span class="string">&quot;uuid&quot;</span>: person.ID&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	route.Run(<span class="string">&quot;:8088&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ curl -v localhost:8088/thinkerou/987fbc97-4bed-5078-9f07-9141ba07c9f3</span><br><span class="line">$ curl -v localhost:8088/thinkerou/not-uuid</span><br></pre></td></tr></table></figure>

<h2 id="ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•æ•°æ®"><a href="#ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•æ•°æ®" class="headerlink" title="ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•æ•°æ®"></a>ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•æ•°æ®</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name     <span class="keyword">string</span>    <span class="string">`form:&quot;name&quot;`</span></span><br><span class="line">	Address  <span class="keyword">string</span>    <span class="string">`form:&quot;address&quot;`</span></span><br><span class="line">	Birthday time.Time <span class="string">`form:&quot;birthday&quot; time_format:&quot;2006-01-02&quot; time_utc:&quot;1&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	route := gin.Default()</span><br><span class="line">	route.GET(<span class="string">&quot;/testing&quot;</span>, startPage)</span><br><span class="line">	route.Run(<span class="string">&quot;:8085&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">startPage</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> person Person</span><br><span class="line">	<span class="comment">// å¦‚æœæ˜¯ `GET` è¯·æ±‚ï¼Œåªä½¿ç”¨ `Form` ç»‘å®šå¼•æ“ï¼ˆ`query`ï¼‰ã€‚</span></span><br><span class="line">	<span class="comment">// å¦‚æœæ˜¯ `POST` è¯·æ±‚ï¼Œé¦–å…ˆæ£€æŸ¥ `content-type` æ˜¯å¦ä¸º `JSON` æˆ– `XML`ï¼Œç„¶åå†ä½¿ç”¨ `Form`ï¼ˆ`form-data`ï¼‰ã€‚</span></span><br><span class="line">	<span class="comment">// æŸ¥çœ‹æ›´å¤šï¼šhttps://github.com/gin-gonic/gin/blob/master/binding/binding.go#L48</span></span><br><span class="line">	<span class="keyword">if</span> c.ShouldBind(&amp;person) == <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Println(person.Name)</span><br><span class="line">		log.Println(person.Address)</span><br><span class="line">		log.Println(person.Birthday)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	c.String(<span class="number">200</span>, <span class="string">&quot;Success&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -X GET <span class="string">&quot;localhost:8085/testing?name=appleboy&amp;address=xyz&amp;birthday=1992-03-15&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="ç»‘å®šè¡¨å•æ•°æ®è‡³è‡ªå®šä¹‰ç»“æ„ä½“"><a href="#ç»‘å®šè¡¨å•æ•°æ®è‡³è‡ªå®šä¹‰ç»“æ„ä½“" class="headerlink" title="ç»‘å®šè¡¨å•æ•°æ®è‡³è‡ªå®šä¹‰ç»“æ„ä½“"></a>ç»‘å®šè¡¨å•æ•°æ®è‡³è‡ªå®šä¹‰ç»“æ„ä½“</h2><p>ä»¥ä¸‹ç¤ºä¾‹ä½¿ç”¨è‡ªå®šä¹‰ç»“æ„ä½“ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> StructA <span class="keyword">struct</span> &#123;</span><br><span class="line">    FieldA <span class="keyword">string</span> <span class="string">`form:&quot;field_a&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StructB <span class="keyword">struct</span> &#123;</span><br><span class="line">    NestedStruct StructA</span><br><span class="line">    FieldB <span class="keyword">string</span> <span class="string">`form:&quot;field_b&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StructC <span class="keyword">struct</span> &#123;</span><br><span class="line">    NestedStructPointer *StructA</span><br><span class="line">    FieldC <span class="keyword">string</span> <span class="string">`form:&quot;field_c&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StructD <span class="keyword">struct</span> &#123;</span><br><span class="line">    NestedAnonyStruct <span class="keyword">struct</span> &#123;</span><br><span class="line">        FieldX <span class="keyword">string</span> <span class="string">`form:&quot;field_x&quot;`</span></span><br><span class="line">    &#125;</span><br><span class="line">    FieldD <span class="keyword">string</span> <span class="string">`form:&quot;field_d&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetDataB</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> b StructB</span><br><span class="line">    c.Bind(&amp;b)</span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: b.NestedStruct,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>: b.FieldB,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetDataC</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> b StructC</span><br><span class="line">    c.Bind(&amp;b)</span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: b.NestedStructPointer,</span><br><span class="line">        <span class="string">&quot;c&quot;</span>: b.FieldC,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetDataD</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> b StructD</span><br><span class="line">    c.Bind(&amp;b)</span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">        <span class="string">&quot;x&quot;</span>: b.NestedAnonyStruct,</span><br><span class="line">        <span class="string">&quot;d&quot;</span>: b.FieldD,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    r := gin.Default()</span><br><span class="line">    r.GET(<span class="string">&quot;/getb&quot;</span>, GetDataB)</span><br><span class="line">    r.GET(<span class="string">&quot;/getc&quot;</span>, GetDataC)</span><br><span class="line">    r.GET(<span class="string">&quot;/getd&quot;</span>, GetDataD)</span><br><span class="line"></span><br><span class="line">    r.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ <code>curl</code> å‘½ä»¤ç»“æœï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ curl &quot;http:&#x2F;&#x2F;localhost:8080&#x2F;getb?field_a&#x3D;hello&amp;field_b&#x3D;world&quot;</span><br><span class="line">&#123;&quot;a&quot;:&#123;&quot;FieldA&quot;:&quot;hello&quot;&#125;,&quot;b&quot;:&quot;world&quot;&#125;</span><br><span class="line">$ curl &quot;http:&#x2F;&#x2F;localhost:8080&#x2F;getc?field_a&#x3D;hello&amp;field_c&#x3D;world&quot;</span><br><span class="line">&#123;&quot;a&quot;:&#123;&quot;FieldA&quot;:&quot;hello&quot;&#125;,&quot;c&quot;:&quot;world&quot;&#125;</span><br><span class="line">$ curl &quot;http:&#x2F;&#x2F;localhost:8080&#x2F;getd?field_x&#x3D;hello&amp;field_d&#x3D;world&quot;</span><br><span class="line">&#123;&quot;d&quot;:&quot;world&quot;,&quot;x&quot;:&#123;&quot;FieldX&quot;:&quot;hello&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„</strong>ï¼šä¸æ”¯æŒä»¥ä¸‹æ ¼å¼ç»“æ„ä½“ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> StructX <span class="keyword">struct</span> &#123;</span><br><span class="line">    X <span class="keyword">struct</span> &#123;&#125; <span class="string">`form:&quot;name_x&quot;`</span> <span class="comment">// æœ‰ form</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StructY <span class="keyword">struct</span> &#123;</span><br><span class="line">    Y StructX <span class="string">`form:&quot;name_y&quot;`</span> <span class="comment">// æœ‰ form</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> StructZ <span class="keyword">struct</span> &#123;</span><br><span class="line">    Z *StructZ <span class="string">`form:&quot;name_z&quot;`</span> <span class="comment">// æœ‰ form</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªå®šä¹‰-HTTP-é…ç½®"><a href="#è‡ªå®šä¹‰-HTTP-é…ç½®" class="headerlink" title="è‡ªå®šä¹‰ HTTP é…ç½®"></a>è‡ªå®šä¹‰ HTTP é…ç½®</h2><p>ç›´æ¥ä½¿ç”¨ <code>http.ListenAndServe()</code>ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	http.ListenAndServe(<span class="string">&quot;:8080&quot;</span>, router)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ–</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	s := &amp;http.Server&#123;</span><br><span class="line">		Addr:           <span class="string">&quot;:8080&quot;</span>,</span><br><span class="line">		Handler:        router,</span><br><span class="line">		ReadTimeout:    <span class="number">10</span> * time.Second,</span><br><span class="line">		WriteTimeout:   <span class="number">10</span> * time.Second,</span><br><span class="line">		MaxHeaderBytes: <span class="number">1</span> &lt;&lt; <span class="number">20</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	s.ListenAndServe()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªå®šä¹‰ä¸­é—´ä»¶"><a href="#è‡ªå®šä¹‰ä¸­é—´ä»¶" class="headerlink" title="è‡ªå®šä¹‰ä¸­é—´ä»¶"></a>è‡ªå®šä¹‰ä¸­é—´ä»¶</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Logger</span><span class="params">()</span> <span class="title">gin</span>.<span class="title">HandlerFunc</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		t := time.Now()</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è®¾ç½® example å˜é‡</span></span><br><span class="line">		c.Set(<span class="string">&quot;example&quot;</span>, <span class="string">&quot;12345&quot;</span>)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è¯·æ±‚å‰</span></span><br><span class="line"></span><br><span class="line">		c.Next()</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è¯·æ±‚å</span></span><br><span class="line">		latency := time.Since(t)</span><br><span class="line">		log.Print(latency)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// è·å–å‘é€çš„ status</span></span><br><span class="line">		status := c.Writer.Status()</span><br><span class="line">		log.Println(status)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.New()</span><br><span class="line">	r.Use(Logger())</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/test&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		example := c.MustGet(<span class="string">&quot;example&quot;</span>).(<span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line">		<span class="comment">// æ‰“å°ï¼š&quot;12345&quot;</span></span><br><span class="line">		log.Println(example)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªå®šä¹‰éªŒè¯å™¨"><a href="#è‡ªå®šä¹‰éªŒè¯å™¨" class="headerlink" title="è‡ªå®šä¹‰éªŒè¯å™¨"></a>è‡ªå®šä¹‰éªŒè¯å™¨</h2><p>æ³¨å†Œè‡ªå®šä¹‰éªŒè¯å™¨ï¼ŒæŸ¥çœ‹<a target="_blank" rel="noopener" href="https://github.com/gin-gonic/examples/tree/master/struct-lvl-validations">ç¤ºä¾‹ä»£ç </a>.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;reflect&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin/binding&quot;</span></span><br><span class="line">	<span class="string">&quot;github.com/go-playground/validator/v10&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Booking åŒ…å«ç»‘å®šå’ŒéªŒè¯çš„æ•°æ®ã€‚</span></span><br><span class="line"><span class="keyword">type</span> Booking <span class="keyword">struct</span> &#123;</span><br><span class="line">	CheckIn  time.Time <span class="string">`form:&quot;check_in&quot; binding:&quot;required,bookabledate&quot; time_format:&quot;2006-01-02&quot;`</span></span><br><span class="line">	CheckOut time.Time <span class="string">`form:&quot;check_out&quot; binding:&quot;required,gtfield=CheckIn,bookabledate&quot; time_format:&quot;2006-01-02&quot;`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> bookableDate validator.Func = <span class="function"><span class="keyword">func</span><span class="params">(fl validator.FieldLevel)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	date, ok := fl.Field().Interface().(time.Time)</span><br><span class="line">	<span class="keyword">if</span> ok &#123;</span><br><span class="line">		today := time.Now()</span><br><span class="line">		<span class="keyword">if</span> today.After(date) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	route := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> v, ok := binding.Validator.Engine().(*validator.Validate); ok &#123;</span><br><span class="line">		v.RegisterValidation(<span class="string">&quot;bookabledate&quot;</span>, bookableDate)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	route.GET(<span class="string">&quot;/bookable&quot;</span>, getBookable)</span><br><span class="line">	route.Run(<span class="string">&quot;:8085&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getBookable</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> b Booking</span><br><span class="line">	<span class="keyword">if</span> err := c.ShouldBindWith(&amp;b, binding.Query); err == <span class="literal">nil</span> &#123;</span><br><span class="line">		c.JSON(http.StatusOK, gin.H&#123;<span class="string">&quot;message&quot;</span>: <span class="string">&quot;Booking dates are valid!&quot;</span>&#125;)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		c.JSON(http.StatusBadRequest, gin.H&#123;<span class="string">&quot;error&quot;</span>: err.Error()&#125;)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ curl <span class="string">&quot;localhost:8085/bookable?check_in=2018-04-16&amp;check_out=2018-04-17&quot;</span></span><br><span class="line">&#123;<span class="string">&quot;message&quot;</span>:<span class="string">&quot;Booking dates are valid!&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">$ curl <span class="string">&quot;localhost:8085/bookable?check_in=2018-03-08&amp;check_out=2018-03-09&quot;</span></span><br><span class="line">&#123;<span class="string">&quot;error&quot;</span>:<span class="string">&quot;Key: &#x27;Booking.CheckIn&#x27; Error:Field validation for &#x27;CheckIn&#x27; failed on the &#x27;bookabledate&#x27; tag&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è®¾ç½®å’Œè·å–-Cookie"><a href="#è®¾ç½®å’Œè·å–-Cookie" class="headerlink" title="è®¾ç½®å’Œè·å– Cookie"></a>è®¾ç½®å’Œè·å– Cookie</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    router := gin.Default()</span><br><span class="line">    router.GET(<span class="string">&quot;/cookie&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">        cookie, err := c.Cookie(<span class="string">&quot;gin_cookie&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            cookie = <span class="string">&quot;NotSet&quot;</span></span><br><span class="line">            c.SetCookie(<span class="string">&quot;gin_cookie&quot;</span>, <span class="string">&quot;test&quot;</span>, <span class="number">3600</span>, <span class="string">&quot;/&quot;</span>, <span class="string">&quot;localhost&quot;</span>, <span class="literal">false</span>, <span class="literal">true</span>)</span><br><span class="line">        &#125;</span><br><span class="line">        fmt.Printf(<span class="string">&quot;Cookie value: %s \n&quot;</span>, cookie)</span><br><span class="line">    &#125;)</span><br><span class="line">    router.Run()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è·¯ç”±å‚æ•°"><a href="#è·¯ç”±å‚æ•°" class="headerlink" title="è·¯ç”±å‚æ•°"></a>è·¯ç”±å‚æ•°</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ­¤ handler å°†åŒ¹é… /user/john ä½†ä¸ä¼šåŒ¹é… /user/ æˆ–è€… /user</span></span><br><span class="line">	router.GET(<span class="string">&quot;/user/:name&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		name := c.Param(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		c.String(http.StatusOK, <span class="string">&quot;Hello %s&quot;</span>, name)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// æ­¤ handler å°†åŒ¹é… /user/john/ å’Œ /user/john/send</span></span><br><span class="line">	<span class="comment">// å¦‚æœæ²¡æœ‰å…¶ä»–è·¯ç”±åŒ¹é… /user/johnï¼Œå®ƒå°†é‡å®šå‘åˆ° /user/john/</span></span><br><span class="line">	router.GET(<span class="string">&quot;/user/:name/*action&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		name := c.Param(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">		action := c.Param(<span class="string">&quot;action&quot;</span>)</span><br><span class="line">		message := name + <span class="string">&quot; is &quot;</span> + action</span><br><span class="line">		c.String(http.StatusOK, message)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è·¯ç”±ç»„"><a href="#è·¯ç”±ç»„" class="headerlink" title="è·¯ç”±ç»„"></a>è·¯ç”±ç»„</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç®€å•çš„è·¯ç”±ç»„: v1</span></span><br><span class="line">	v1 := router.Group(<span class="string">&quot;/v1&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		v1.POST(<span class="string">&quot;/login&quot;</span>, loginEndpoint)</span><br><span class="line">		v1.POST(<span class="string">&quot;/submit&quot;</span>, submitEndpoint)</span><br><span class="line">		v1.POST(<span class="string">&quot;/read&quot;</span>, readEndpoint)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç®€å•çš„è·¯ç”±ç»„: v2</span></span><br><span class="line">	v2 := router.Group(<span class="string">&quot;/v2&quot;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		v2.POST(<span class="string">&quot;/login&quot;</span>, loginEndpoint)</span><br><span class="line">		v2.POST(<span class="string">&quot;/submit&quot;</span>, submitEndpoint)</span><br><span class="line">		v2.POST(<span class="string">&quot;/read&quot;</span>, readEndpoint)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è¿è¡Œå¤šä¸ªæœåŠ¡"><a href="#è¿è¡Œå¤šä¸ªæœåŠ¡" class="headerlink" title="è¿è¡Œå¤šä¸ªæœåŠ¡"></a>è¿è¡Œå¤šä¸ªæœåŠ¡</h2><p>è¯·å‚é˜… <a target="_blank" rel="noopener" href="https://github.com/gin-gonic/gin/issues/346">issues</a> å¹¶å°è¯•ä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">&quot;log&quot;</span></span><br><span class="line">	<span class="string">&quot;net/http&quot;</span></span><br><span class="line">	<span class="string">&quot;time&quot;</span></span><br><span class="line"></span><br><span class="line">	<span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line">	<span class="string">&quot;golang.org/x/sync/errgroup&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	g errgroup.Group</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">router01</span><span class="params">()</span> <span class="title">http</span>.<span class="title">Handler</span></span> &#123;</span><br><span class="line">	e := gin.New()</span><br><span class="line">	e.Use(gin.Recovery())</span><br><span class="line">	e.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(</span><br><span class="line">			http.StatusOK,</span><br><span class="line">			gin.H&#123;</span><br><span class="line">				<span class="string">&quot;code&quot;</span>:  http.StatusOK,</span><br><span class="line">				<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Welcome server 01&quot;</span>,</span><br><span class="line">			&#125;,</span><br><span class="line">		)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> e</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">router02</span><span class="params">()</span> <span class="title">http</span>.<span class="title">Handler</span></span> &#123;</span><br><span class="line">	e := gin.New()</span><br><span class="line">	e.Use(gin.Recovery())</span><br><span class="line">	e.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(</span><br><span class="line">			http.StatusOK,</span><br><span class="line">			gin.H&#123;</span><br><span class="line">				<span class="string">&quot;code&quot;</span>:  http.StatusOK,</span><br><span class="line">				<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Welcome server 02&quot;</span>,</span><br><span class="line">			&#125;,</span><br><span class="line">		)</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> e</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	server01 := &amp;http.Server&#123;</span><br><span class="line">		Addr:         <span class="string">&quot;:8080&quot;</span>,</span><br><span class="line">		Handler:      router01(),</span><br><span class="line">		ReadTimeout:  <span class="number">5</span> * time.Second,</span><br><span class="line">		WriteTimeout: <span class="number">10</span> * time.Second,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	server02 := &amp;http.Server&#123;</span><br><span class="line">		Addr:         <span class="string">&quot;:8081&quot;</span>,</span><br><span class="line">		Handler:      router02(),</span><br><span class="line">		ReadTimeout:  <span class="number">5</span> * time.Second,</span><br><span class="line">		WriteTimeout: <span class="number">10</span> * time.Second,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	g.Go(<span class="function"><span class="keyword">func</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line">		<span class="keyword">return</span> server01.ListenAndServe()</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	g.Go(<span class="function"><span class="keyword">func</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line">		<span class="keyword">return</span> server02.ListenAndServe()</span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> err := g.Wait(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">		log.Fatal(err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h2><p>HTTP é‡å®šå‘å¾ˆå®¹æ˜“ã€‚ å†…éƒ¨ã€å¤–éƒ¨é‡å®šå‘å‡æ”¯æŒã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/test&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	c.Redirect(http.StatusMovedPermanently, <span class="string">&quot;http://www.google.com/&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ POST æ–¹æ³•è¿›è¡Œ HTTP é‡å®šå‘ã€‚è¯·å‚è€ƒ issueï¼š<a target="_blank" rel="noopener" href="https://github.com/gin-gonic/gin/issues/444">#444</a></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.POST(<span class="string">&quot;/test&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">	c.Redirect(http.StatusFound, <span class="string">&quot;/foo&quot;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>è·¯ç”±é‡å®šå‘ï¼Œä½¿ç”¨ <code>HandleContext</code>ï¼š</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">r.GET(<span class="string">&quot;/test&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    c.Request.URL.Path = <span class="string">&quot;/test2&quot;</span></span><br><span class="line">    r.HandleContext(c)</span><br><span class="line">&#125;)</span><br><span class="line">r.GET(<span class="string">&quot;/test2&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">    c.JSON(<span class="number">200</span>, gin.H&#123;<span class="string">&quot;hello&quot;</span>: <span class="string">&quot;world&quot;</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="é™æ€æ–‡ä»¶æœåŠ¡"><a href="#é™æ€æ–‡ä»¶æœåŠ¡" class="headerlink" title="é™æ€æ–‡ä»¶æœåŠ¡"></a>é™æ€æ–‡ä»¶æœåŠ¡</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	router := gin.Default()</span><br><span class="line">	router.Static(<span class="string">&quot;/assets&quot;</span>, <span class="string">&quot;./assets&quot;</span>)</span><br><span class="line">	router.StaticFS(<span class="string">&quot;/more_static&quot;</span>, http.Dir(<span class="string">&quot;my_file_system&quot;</span>))</span><br><span class="line">	router.StaticFile(<span class="string">&quot;/favicon.ico&quot;</span>, <span class="string">&quot;./resources/favicon.ico&quot;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ç›‘å¬å¹¶åœ¨ 0.0.0.0:8080 ä¸Šå¯åŠ¨æœåŠ¡</span></span><br><span class="line">	router.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é™æ€èµ„æºåµŒå…¥"><a href="#é™æ€èµ„æºåµŒå…¥" class="headerlink" title="é™æ€èµ„æºåµŒå…¥"></a>é™æ€èµ„æºåµŒå…¥</h2><p>ä½ å¯ä»¥ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://github.com/jessevdk/go-assets">go-assets</a> å°†é™æ€èµ„æºæ‰“åŒ…åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.New()</span><br><span class="line"></span><br><span class="line">	t, err := loadTemplate()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	r.SetHTMLTemplate(t)</span><br><span class="line"></span><br><span class="line">	r.GET(<span class="string">&quot;/&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.HTML(http.StatusOK, <span class="string">&quot;/html/index.tmpl&quot;</span>, <span class="literal">nil</span>)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run(<span class="string">&quot;:8080&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// loadTemplate åŠ è½½ç”± go-assets-builder åµŒå…¥çš„æ¨¡æ¿</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">loadTemplate</span><span class="params">()</span> <span class="params">(*template.Template, error)</span></span> &#123;</span><br><span class="line">	t := template.New(<span class="string">&quot;&quot;</span>)</span><br><span class="line">	<span class="keyword">for</span> name, file := <span class="keyword">range</span> Assets.Files &#123;</span><br><span class="line">		<span class="keyword">if</span> file.IsDir() || !strings.HasSuffix(name, <span class="string">&quot;.tmpl&quot;</span>) &#123;</span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		&#125;</span><br><span class="line">		h, err := ioutil.ReadAll(file)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">		&#125;</span><br><span class="line">		t, err = t.New(name).Parse(<span class="keyword">string</span>(h))</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> t, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¯·å‚é˜… <a target="_blank" rel="noopener" href="https://github.com/gin-gonic/examples/tree/master/assets-in-binary/example01">assets-in-binary/example01</a> ç›®å½•ä¸­çš„å®Œæ•´ç¤ºä¾‹ã€‚</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/28/Gin-Web-Framework/" data-id="cklqrti8w0000q4134vhg9cdn" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/go/" rel="tag">go</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-æ—¥å¿—åˆ†æå·¥å…·splunk" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/22/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7splunk/" class="article-date">
  <time datetime="2021-02-22T14:32:17.000Z" itemprop="datePublished">2021-02-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/22/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7splunk/">æ—¥å¿—åˆ†æå·¥å…·splunk</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://www.edureka.co/blog/what-is-splunk/">https://www.edureka.co/blog/what-is-splunk/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/22/%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7splunk/" data-id="cklgojbve00000e133ctyb2sc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-epollåŸç†è®²è§£" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/21/epoll%E5%8E%9F%E7%90%86%E8%AE%B2%E8%A7%A3/" class="article-date">
  <time datetime="2021-02-21T15:46:28.000Z" itemprop="datePublished">2021-02-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/21/epoll%E5%8E%9F%E7%90%86%E8%AE%B2%E8%A7%A3/">epollåŸç†è®²è§£</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/36764771">åŸç†æ€§è§£é‡Šä»¥åŠä¸selectçš„æ¯”è¾ƒ</a></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/56486633">ç¨å¾®æ·±å…¥çš„è®²è§£</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/21/epoll%E5%8E%9F%E7%90%86%E8%AE%B2%E8%A7%A3/" data-id="cklfbte2r00004b13eil8d2df" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LeetCode-665-éé€’å‡æ•°åˆ—" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/07/LeetCode-665-%E9%9D%9E%E9%80%92%E5%87%8F%E6%95%B0%E5%88%97/" class="article-date">
  <time datetime="2021-02-07T12:50:55.000Z" itemprop="datePublished">2021-02-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/07/LeetCode-665-%E9%9D%9E%E9%80%92%E5%87%8F%E6%95%B0%E5%88%97/">LeetCode-665. éé€’å‡æ•°åˆ—</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„ï¼Œè¯·ä½ åˆ¤æ–­åœ¨ æœ€å¤š æ”¹å˜ 1 ä¸ªå…ƒç´ çš„æƒ…å†µä¸‹ï¼Œè¯¥æ•°ç»„èƒ½å¦å˜æˆä¸€ä¸ªéé€’å‡æ•°åˆ—ã€‚</p>
<p>æˆ‘ä»¬æ˜¯è¿™æ ·å®šä¹‰ä¸€ä¸ªéé€’å‡æ•°åˆ—çš„ï¼š å¯¹äºæ•°ç»„ä¸­æ‰€æœ‰çš„ i (0 &lt;= i &lt;= n-2)ï¼Œæ€»æ»¡è¶³ nums[i] &lt;= nums[i + 1]ã€‚</p>
<p><strong>ç¤ºä¾‹ 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: nums &#x3D; [4,2,3]</span><br><span class="line">è¾“å‡º: true</span><br><span class="line">è§£é‡Š: ä½ å¯ä»¥é€šè¿‡æŠŠç¬¬ä¸€ä¸ª4å˜æˆ1æ¥ä½¿å¾—å®ƒæˆä¸ºä¸€ä¸ªéé€’å‡æ•°åˆ—ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥: nums &#x3D; [4,2,1]</span><br><span class="line">è¾“å‡º: false</span><br><span class="line">è§£é‡Š: ä½ ä¸èƒ½åœ¨åªæ”¹å˜ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µä¸‹å°†å…¶å˜ä¸ºéé€’å‡æ•°åˆ—ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>æœ¬é¢˜ä¸€èˆ¬çš„æ€è·¯å°±æ˜¯æ±‚æ•°åˆ—çš„é€†åºæ•°ã€‚ä»»é€‰ä¸¤ä¸ªæ•°å­—ï¼Œæ’åœ¨æ•°åˆ—ä¸­é å‰ä½ç½®çš„æ¯”åé¢çš„æ•°å­—å¤§ï¼Œç§°ä¸ºä¸€ä¸ªé€†åºã€‚æ•°ç»„ä¸­è¿™æ ·çš„æ•°å­—ç»„åˆçš„ä¸ªæ•°å³ä¸ºæ•°åˆ—çš„é€†åºæ•°ã€‚æ±‚é€†åºæ•°çš„æ—¶é—´å¤æ‚åº¦ä¸º<code>n^2</code>ã€‚</p>
<p>ä½†æ­¤é¢˜ä¸­è¦æ±‚æœ€å¤šæ”¹å˜ä¸€ä¸ªå…ƒç´ ï¼Œå³é€†åºæ•°è¶…è¿‡1æ—¶å³å¯è¿”å›<code>false</code>ï¼Œé‡‡ç”¨ä»¥ä¸Šæ–¹æ³•æœ€å¤§æ—¶é—´å¤æ‚åº¦ä¸º<code>O(n^2)</code>ã€‚</p>
<p>è¯•ç€æ€è€ƒï¼Œåœ¨ç¢°åˆ°ç›¸é‚»æ•°å­—ä¸ºé€†åºæ—¶ï¼Œæœ‰ä¸¤ç§æ–¹æ³•è§£å†³ï¼š1.å°†<code>nums[i-1]</code>çš„å€¼è®¾ä¸º<code>nums[i]</code>ï¼›2.å°†<code>nums[i]</code>çš„å€¼è®¾ä¸º<code>nums[i-1]</code>ã€‚</p>
<p>æ— è®ºé‡‡ç”¨å“ªç§è§£å†³æ–¹æ³•ï¼Œè‹¥å› æ­¤äº§ç”Ÿæ–°çš„é€†åºï¼Œåˆ™æ•°ç»„ä¸­è‚¯å®šå­˜åœ¨å…¶å®ƒé€†åºç»„åˆï¼Œå¯ç›´æ¥è¿”å›<code>false</code>ã€‚ä¸ºé¿å…å›æº¯ï¼Œé‡‡ç”¨æ–¹æ³•2æ›´å¥½ï¼Œä¸€æ¬¡æ•°åˆ—éå†å³å¯ç¡®å®šæœ€ç»ˆç»“æœã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">checkPossibility</span>(<span class="params">self, nums</span>) -&gt; bool:</span></span><br><span class="line">        reverses = <span class="number">0</span></span><br><span class="line">        n = <span class="built_in">len</span>(nums)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> nums[i] &gt; nums[i+<span class="number">1</span>]:</span><br><span class="line">                reverses += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> reverses &gt; <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">if</span> i &gt; <span class="number">0</span> <span class="keyword">and</span> nums[i-<span class="number">1</span>] &gt; nums[i+<span class="number">1</span>]:</span><br><span class="line">                    nums[i+<span class="number">1</span>] = nums[i]</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    nums = [<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>]</span><br><span class="line">    solution = Solution()</span><br><span class="line">    print(solution.checkPossibility(nums))</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/07/LeetCode-665-%E9%9D%9E%E9%80%92%E5%87%8F%E6%95%B0%E5%88%97/" data-id="ckkv5vus10000w31379by7zqc" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LeetCode-1423-å¯è·å¾—çš„æœ€å¤§ç‚¹æ•°" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/06/LeetCode-1423-%E5%8F%AF%E8%8E%B7%E5%BE%97%E7%9A%84%E6%9C%80%E5%A4%A7%E7%82%B9%E6%95%B0/" class="article-date">
  <time datetime="2021-02-06T06:40:17.000Z" itemprop="datePublished">2021-02-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/06/LeetCode-1423-%E5%8F%AF%E8%8E%B7%E5%BE%97%E7%9A%84%E6%9C%80%E5%A4%A7%E7%82%B9%E6%95%B0/">LeetCode-1423. å¯è·å¾—çš„æœ€å¤§ç‚¹æ•°</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>å‡ å¼ å¡ç‰Œ æ’æˆä¸€è¡Œï¼Œæ¯å¼ å¡ç‰Œéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„ç‚¹æ•°ã€‚ç‚¹æ•°ç”±æ•´æ•°æ•°ç»„ cardPoints ç»™å‡ºã€‚</p>
<p>æ¯æ¬¡è¡ŒåŠ¨ï¼Œä½ å¯ä»¥ä»è¡Œçš„å¼€å¤´æˆ–è€…æœ«å°¾æ‹¿ä¸€å¼ å¡ç‰Œï¼Œæœ€ç»ˆä½ å¿…é¡»æ­£å¥½æ‹¿ k å¼ å¡ç‰Œã€‚</p>
<p>ä½ çš„ç‚¹æ•°å°±æ˜¯ä½ æ‹¿åˆ°æ‰‹ä¸­çš„æ‰€æœ‰å¡ç‰Œçš„ç‚¹æ•°ä¹‹å’Œã€‚</p>
<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ cardPoints å’Œæ•´æ•° kï¼Œè¯·ä½ è¿”å›å¯ä»¥è·å¾—çš„æœ€å¤§ç‚¹æ•°ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šcardPoints &#x3D; [1,2,3,4,5,6,1], k &#x3D; 3</span><br><span class="line">è¾“å‡ºï¼š12</span><br><span class="line">è§£é‡Šï¼šç¬¬ä¸€æ¬¡è¡ŒåŠ¨ï¼Œä¸ç®¡æ‹¿å“ªå¼ ç‰Œï¼Œä½ çš„ç‚¹æ•°æ€»æ˜¯ 1 ã€‚ä½†æ˜¯ï¼Œå…ˆæ‹¿æœ€å³è¾¹çš„å¡ç‰Œå°†ä¼šæœ€å¤§åŒ–ä½ çš„å¯è·å¾—ç‚¹æ•°ã€‚æœ€ä¼˜ç­–ç•¥æ˜¯æ‹¿å³è¾¹çš„ä¸‰å¼ ç‰Œï¼Œæœ€ç»ˆç‚¹æ•°ä¸º 1 + 6 + 5 &#x3D; 12 ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šcardPoints &#x3D; [2,2,2], k &#x3D; 2</span><br><span class="line">è¾“å‡ºï¼š4</span><br><span class="line">è§£é‡Šï¼šæ— è®ºä½ æ‹¿èµ·å“ªä¸¤å¼ å¡ç‰Œï¼Œå¯è·å¾—çš„ç‚¹æ•°æ€»æ˜¯ 4 ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>ç»´æŒä¸€ä¸ªé•¿åº¦ä¸ºn-kçš„çª—å£ï¼Œå‘åæ»‘åŠ¨çš„è¿‡ç¨‹ä¸­æ±‚å‡ºçª—å£å†…ç‚¹æ•°æ€»å’Œï¼Œç»´æŒä¸€ä¸ªæœ€å°å€¼ã€‚åˆ™å…¨éƒ¨ç‚¹æ•°ä¹‹å’Œå‡å»æœ€å°å€¼çš„ç»“æœä¸ºå¯ä»¥è·å¾—çš„æœ€å¤§ç‚¹æ•°ã€‚</p>
<p>ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ±‚å‡ºæ»‘åŠ¨çª—å£å†…ï¼ˆé•¿åº¦ä¸ºn-kï¼‰å…ƒç´ å’Œçš„æœ€å°å€¼ï¼Œå‰©ä½™å…ƒç´ çš„æœ€å°å€¼</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">maxScore</span>(<span class="params">self, cardPoints, k: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        n = <span class="built_in">len</span>(cardPoints)</span><br><span class="line">        <span class="comment"># è®¡ç®—å‡ºæ•°ç»„å‰ké¡¹çš„å’Œ</span></span><br><span class="line">        minScore = <span class="built_in">sum</span>(cardPoints[:n - k])</span><br><span class="line">        sumn = sumWindow = minScore</span><br><span class="line">        <span class="comment"># å‘åç§»åŠ¨çª—å£ï¼Œä¸æ–­æ›´æ–°çª—å£å†…å…ƒç´ çš„å’Œï¼Œæ›´æ–°çª—å£å’Œçš„æœ€å°å€¼</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - k, n):</span><br><span class="line">            sumWindow = sumWindow + cardPoints[i] - cardPoints[i + k - n]</span><br><span class="line">            minScore = <span class="built_in">min</span>(minScore, sumWindow)</span><br><span class="line">            sumn += cardPoints[i]</span><br><span class="line">        <span class="keyword">return</span> sumn - minScore</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    cardPoints = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">1</span>]</span><br><span class="line">    k = <span class="number">3</span></span><br><span class="line">    solution = Solution()</span><br><span class="line">    print(solution.maxScore(cardPoints, k))</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/06/LeetCode-1423-%E5%8F%AF%E8%8E%B7%E5%BE%97%E7%9A%84%E6%9C%80%E5%A4%A7%E7%82%B9%E6%95%B0/" data-id="ckktcqrk50000rr13cyli8nll" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LeetCode-1208-å°½å¯èƒ½ä½¿å­—ç¬¦ä¸²ç›¸ç­‰" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/02/05/LeetCode-1208-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E7%AD%89/" class="article-date">
  <time datetime="2021-02-05T10:54:58.000Z" itemprop="datePublished">2021-02-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/02/05/LeetCode-1208-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E7%AD%89/">LeetCode-1208. å°½å¯èƒ½ä½¿å­—ç¬¦ä¸²ç›¸ç­‰</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç»™ä½ ä¸¤ä¸ªé•¿åº¦ç›¸åŒçš„å­—ç¬¦ä¸²ï¼Œs å’Œ tã€‚</p>
<p>å°† s ä¸­çš„ç¬¬ i ä¸ªå­—ç¬¦å˜åˆ° t ä¸­çš„ç¬¬ i ä¸ªå­—ç¬¦éœ€è¦ |s[i] - t[i]| çš„å¼€é”€ï¼ˆå¼€é”€å¯èƒ½ä¸º 0ï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸¤ä¸ªå­—ç¬¦çš„ ASCII ç å€¼çš„å·®çš„ç»å¯¹å€¼ã€‚</p>
<p>ç”¨äºå˜æ›´å­—ç¬¦ä¸²çš„æœ€å¤§é¢„ç®—æ˜¯ maxCostã€‚åœ¨è½¬åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œæ€»å¼€é”€åº”å½“å°äºç­‰äºè¯¥é¢„ç®—ï¼Œè¿™ä¹Ÿæ„å‘³ç€å­—ç¬¦ä¸²çš„è½¬åŒ–å¯èƒ½æ˜¯ä¸å®Œå…¨çš„ã€‚</p>
<p>å¦‚æœä½ å¯ä»¥å°† s çš„å­å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå®ƒåœ¨ t ä¸­å¯¹åº”çš„å­å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›å¯ä»¥è½¬åŒ–çš„æœ€å¤§é•¿åº¦ã€‚</p>
<p>å¦‚æœ s ä¸­æ²¡æœ‰å­å­—ç¬¦ä¸²å¯ä»¥è½¬åŒ–æˆ t ä¸­å¯¹åº”çš„å­å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å› 0ã€‚</p>
<p><strong>ç¤ºä¾‹ 1ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs &#x3D; &quot;abcd&quot;, t &#x3D; &quot;bcdf&quot;, cost &#x3D; 3</span><br><span class="line">è¾“å‡ºï¼š3</span><br><span class="line">è§£é‡Šï¼šs ä¸­çš„ &quot;abc&quot; å¯ä»¥å˜ä¸º &quot;bcd&quot;ã€‚å¼€é”€ä¸º 3ï¼Œæ‰€ä»¥æœ€å¤§é•¿åº¦ä¸º 3ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 2ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs &#x3D; &quot;abcd&quot;, t &#x3D; &quot;cdef&quot;, cost &#x3D; 3</span><br><span class="line">è¾“å‡ºï¼š1</span><br><span class="line">è§£é‡Šï¼šs ä¸­çš„ä»»ä¸€å­—ç¬¦è¦æƒ³å˜æˆ t ä¸­å¯¹åº”çš„å­—ç¬¦ï¼Œå…¶å¼€é”€éƒ½æ˜¯ 2ã€‚å› æ­¤ï¼Œæœ€å¤§é•¿åº¦ä¸º 1ã€‚</span><br></pre></td></tr></table></figure>

<p><strong>ç¤ºä¾‹ 3ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è¾“å…¥ï¼šs &#x3D; &quot;abcd&quot;, t &#x3D; &quot;acde&quot;, cost &#x3D; 0</span><br><span class="line">è¾“å‡ºï¼š1</span><br><span class="line">è§£é‡Šï¼šä½ æ— æ³•ä½œå‡ºä»»ä½•æ”¹åŠ¨ï¼Œæ‰€ä»¥æœ€å¤§é•¿åº¦ä¸º 1ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>è·Ÿæ˜¨å¤©çš„æ¯æ—¥ä¸€é¢˜å¾ˆåƒï¼Œéå†ä¸€éå­—ç¬¦ä¸²å°±èƒ½å¾—å‡ºç»“æœã€‚</p>
<p>åˆ©ç”¨åŒæŒ‡é’ˆæŒ‡ç¤ºå½“å‰çš„çª—å£ï¼Œç¡®ä¿æ¯æ¬¡å‘åç§»åŠ¨å°¾æŒ‡é’ˆå‰ï¼Œå½“å‰çª—å£çš„å­—ç¬¦ä¸²å·®å€¼ä¹‹å’Œä¸è¶…è¿‡<code>maxCost</code>ï¼ˆä¸¤å­—ç¬¦ä¸²ç¬¬ä¸€ä¸ªå­—ç¬¦çš„å·®å€¼å°±å¤§äº<code>maxCost</code>çš„æƒ…å†µé™¤å¤–ï¼‰ï¼Œè‹¥æ»¡è¶³å‰é¢çš„æ¡ä»¶åˆ™æ›´æ–°æœ€å¤§é•¿åº¦ã€‚</p>
<p>ä»Šå¤©æ ¹æ®æ¡ä»¶è®¤çœŸåœ°é‡æ’äº†ä»£ç ï¼Œè¿æ€è·¯éƒ½æ˜¾å¾—æ¸…æ™°äº†ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">equalSubstring</span>(<span class="params">self, s: <span class="built_in">str</span>, t: <span class="built_in">str</span>, maxCost: <span class="built_in">int</span></span>) -&gt; int:</span></span><br><span class="line">        <span class="comment"># èµ·å§‹æ—¶å¤´æŒ‡é’ˆå’Œå°¾æŒ‡é’ˆéƒ½æŒ‡å‘å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå…ƒç´ </span></span><br><span class="line">        differs = [<span class="built_in">abs</span>(<span class="built_in">ord</span>(s[<span class="number">0</span>]) - <span class="built_in">ord</span>(t[<span class="number">0</span>]))]</span><br><span class="line">        sumn, head = differs[<span class="number">0</span>], <span class="number">0</span></span><br><span class="line">        maxl = <span class="number">1</span> <span class="keyword">if</span> sumn &lt;= maxCost <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ä¸æ–­å‘åç§»åŠ¨å°¾æŒ‡é’ˆ</span></span><br><span class="line">        <span class="keyword">for</span> tail <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(s)):</span><br><span class="line">            <span class="comment"># è®°å½•å½“å‰å°¾æŒ‡é’ˆä½ç½®çš„å­—ç¬¦å·®å€¼</span></span><br><span class="line">            differs.append(<span class="built_in">abs</span>(<span class="built_in">ord</span>(s[tail]) - <span class="built_in">ord</span>(t[tail])))</span><br><span class="line">            sumn += differs[tail]</span><br><span class="line"></span><br><span class="line">            <span class="comment"># è‹¥å½“å‰åŒºé—´å†…å­—ç¬¦æ€»å·®å€¼å¤§äºmaxCostï¼Œåˆ™å‘åç§»åŠ¨å¤´æŒ‡é’ˆï¼Œå¹¶æ›´æ–°æ€»å·®å€¼</span></span><br><span class="line">            <span class="keyword">while</span> sumn &gt; maxCost <span class="keyword">and</span> head &lt;= tail:</span><br><span class="line">                sumn -= differs[head]</span><br><span class="line">                head += <span class="number">1</span></span><br><span class="line">            <span class="comment"># è‹¥æ­¤æ—¶å­—ç¬¦å·®å€¼æ€»å’Œå°äºmaxCostï¼Œæ›´æ–°maxl</span></span><br><span class="line">            <span class="keyword">if</span> sumn &lt;= maxCost:</span><br><span class="line">                maxl = <span class="built_in">max</span>(maxl, tail - head + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> maxl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    s = <span class="string">&quot;abcd&quot;</span></span><br><span class="line">    t = <span class="string">&quot;acde&quot;</span></span><br><span class="line">    cost = <span class="number">0</span></span><br><span class="line">    solution = Solution()</span><br><span class="line">    print(solution.equalSubstring(s, t, cost))</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/05/LeetCode-1208-%E5%B0%BD%E5%8F%AF%E8%83%BD%E4%BD%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%B8%E7%AD%89/" data-id="ckks6mjmv0000fx13c6vm3y0j" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/2/">ä¸‹ä¸€é¡µ &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/celery/" rel="tag">celery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/" rel="tag">go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/" rel="tag">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E5%85%A8/" rel="tag">å®‰å…¨</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9D%82%E8%B0%88/" rel="tag">æ‚è°ˆ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">ç®—æ³•</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" rel="tag">ç¼–è¯‘åŸç†</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BD%91%E7%BB%9C/" rel="tag">ç½‘ç»œ</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" rel="tag">èƒŒåŒ…é—®é¢˜</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æ ‡ç­¾äº‘</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 13.33px;">C#</a> <a href="/tags/celery/" style="font-size: 10px;">celery</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/go/" style="font-size: 11.67px;">go</a> <a href="/tags/linux/" style="font-size: 16.67px;">linux</a> <a href="/tags/python/" style="font-size: 13.33px;">python</a> <a href="/tags/sql/" style="font-size: 10px;">sql</a> <a href="/tags/tool/" style="font-size: 11.67px;">tool</a> <a href="/tags/web/" style="font-size: 13.33px;">web</a> <a href="/tags/%E5%AE%89%E5%85%A8/" style="font-size: 10px;">å®‰å…¨</a> <a href="/tags/%E6%9D%82%E8%B0%88/" style="font-size: 10px;">æ‚è°ˆ</a> <a href="/tags/%E7%AE%97%E6%B3%95/" style="font-size: 20px;">ç®—æ³•</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/" style="font-size: 10px;">ç¼–è¯‘åŸç†</a> <a href="/tags/%E7%BD%91%E7%BB%9C/" style="font-size: 13.33px;">ç½‘ç»œ</a> <a href="/tags/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98/" style="font-size: 18.33px;">èƒŒåŒ…é—®é¢˜</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">ä¸‰æœˆ 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">äºŒæœˆ 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">ä¸€æœˆ 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">åäºŒæœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">åä¸€æœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">ä¸‰æœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">ä¸€æœˆ 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">å…«æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">ä¸ƒæœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">äº”æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">ä¸‰æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">äºŒæœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">ä¸€æœˆ 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">åäºŒæœˆ 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/22/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/%E5%AD%A6%E4%B9%A0%E6%95%B4%E7%90%86-Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E6%88%98/">å­¦ä¹ æ•´ç†-Goè¯­è¨€å®æˆ˜</a>
          </li>
        
          <li>
            <a href="/2021/03/14/%E4%BB%8E%E5%AE%B9%E5%99%A8%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F%E5%B9%B6%E6%8E%A8%E9%80%81%E5%88%B0DockerHub/">ä»å®¹å™¨æ„å»ºé•œåƒå¹¶æ¨é€åˆ°DockerHub</a>
          </li>
        
          <li>
            <a href="/2021/03/13/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%B7%BB%E5%8A%A0%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C/">æ ‘è“æ´¾æ·»åŠ æ— çº¿ç½‘ç»œ</a>
          </li>
        
          <li>
            <a href="/2021/03/07/python3-6%E5%AD%97%E5%85%B8%E7%9A%84%E5%8F%98%E5%8C%96/">python3.6å­—å…¸çš„å˜åŒ–</a>
          </li>
        
          <li>
            <a href="/2021/02/28/Gin-Web-Framework/">Gin Web Framework</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 IMTE<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>